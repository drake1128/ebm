<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å›°é›£æ’ç®¡é æ¸¬ | JAMA Rational Clinical Examination</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--pri:#D84315;--pri2:#FF7043;--acc:#FFB300;--suc:#26A69A;--warn:#FFC107;--err:#EF5350;--pur:#7E57C2;--blue:#42A5F5;--pink:#EC407A;--teal:#00897B;--bg:#FFFAF8;--txt:#2D1810;--txt2:#6B7280}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--txt);line-height:1.7}
        .container{max-width:480px;margin:0 auto}
        .card{background:#fff;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 2px 12px rgba(216,67,21,0.1)}
        .btn{padding:14px 24px;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;transition:all 0.3s;width:100%}
        .btn-pri{background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff}
        .btn-acc{background:linear-gradient(135deg,var(--acc),#FFCA28);color:#333}
        .btn-out{background:#fff;border:2px solid var(--pri);color:var(--pri)}
        table{width:100%;border-collapse:collapse;font-size:13px;margin:12px 0}
        th,td{padding:10px;text-align:center;border-bottom:1px solid #eee}
        th{background:#FBE9E7;font-weight:600;color:var(--pri)}
        .formula{background:linear-gradient(135deg,#FBE9E7,#FFCCBC);border:2px solid var(--pri);border-radius:12px;padding:16px;margin:12px 0;text-align:center;font-size:17px;color:#BF360C}
        .tip{background:#FFF8E1;border-left:4px solid var(--acc);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .good{background:#E0F2F1;border-left:4px solid var(--suc);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .info{background:#E3F2FD;border-left:4px solid var(--blue);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .warn{background:#FFF3E0;border-left:4px solid var(--warn);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .purple{background:#EDE7F6;border-left:4px solid var(--pur);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .pink{background:#FCE4EC;border-left:4px solid var(--pink);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .orange{background:#FBE9E7;border-left:4px solid var(--pri);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .key-point{background:linear-gradient(135deg,#D84315,#FF7043);color:#fff;border-radius:12px;padding:16px;margin:16px 0}
        .lr-high{background:#C8E6C9;color:#2E7D32;padding:2px 8px;border-radius:4px;font-weight:600}
        .lr-mod{background:#FFF9C4;color:#F57F17;padding:2px 8px;border-radius:4px;font-weight:600}
        .lr-low{background:#FFCDD2;color:#C62828;padding:2px 8px;border-radius:4px;font-weight:600}
        header{background:#fff;border-bottom:1px solid #eee;padding:12px 16px;position:sticky;top:0;z-index:10}
        .header-inner{max-width:480px;margin:0 auto;display:flex;align-items:center;gap:12px}
        .back-btn{background:#FBE9E7;border:none;border-radius:10px;width:40px;height:40px;cursor:pointer;color:var(--pri);display:flex;align-items:center;justify-content:center}
        .hero{background:linear-gradient(135deg,#D84315,#FF7043);padding:32px 20px;color:#fff}
        .tag{background:rgba(255,255,255,0.2);display:inline-block;padding:6px 14px;border-radius:50px;font-size:12px;font-weight:600;margin-bottom:16px}
        .badge-row{display:flex;gap:10px;flex-wrap:wrap}
        .badge{background:rgba(255,255,255,0.2);padding:6px 12px;border-radius:20px;font-size:11px}
        .content{padding:0 16px;margin-top:-20px}
        .lesson-item{display:flex;align-items:center;gap:12px;padding:14px;margin-bottom:8px;background:#FFF5F2;border-radius:12px;cursor:pointer;border:2px solid transparent;transition:border-color 0.2s}
        .lesson-item:hover{border-color:var(--pri)}
        .lesson-num{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
        .goal-item{display:flex;gap:10px;margin-bottom:8px;font-size:14px}
        .goal-num{background:var(--suc);color:#fff;border-radius:6px;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0}
        footer{background:#FBE9E7;padding:24px 16px;border-radius:16px;text-align:center;margin:20px 0 40px}
        .page{display:none}
        .page.active{display:block}
        .lesson-header{padding:20px;color:#fff}
        .lesson-content{padding:20px 16px}
        .nav-buttons{display:flex;gap:12px;margin-top:24px}
        .nav-buttons .btn{flex:1}
        .progress-bar{height:8px;background:#E5E5E5;border-radius:4px;margin-bottom:20px}
        .progress-fill{height:100%;background:linear-gradient(90deg,var(--pri),var(--pri2));border-radius:4px;transition:width 0.3s}
        .quiz-option{width:100%;padding:12px 14px;margin-bottom:10px;background:#fff;border:2px solid #E5E5E5;border-radius:12px;text-align:left;font-size:14px;cursor:pointer;display:flex;align-items:center;gap:12px}
        .quiz-option:hover{border-color:var(--pri)}
        .quiz-option.selected{background:#FBE9E7;border-color:var(--pri)}
        .quiz-option.correct{background:#E8F5E9;border-color:var(--suc)}
        .quiz-option.wrong{background:#FFEBEE;border-color:var(--err)}
        .quiz-option.disabled{cursor:default}
        .option-label{width:26px;height:26px;border-radius:8px;background:#FBE9E7;color:var(--pri);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;flex-shrink:0}
        .option-label.correct{background:var(--suc);color:#fff}
        .option-label.wrong{background:var(--err);color:#fff}
        .result-circle{width:140px;height:140px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 24px}
        .result-inner{width:120px;height:120px;border-radius:50%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center}
        .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        .stat-box{border-radius:12px;padding:16px;text-align:center}
        .stat-box .label{font-size:11px;color:var(--txt2)}
        .stat-box .value{font-size:20px;font-weight:700}
        .test-demo{background:#FFF;border:2px solid var(--pri);border-radius:16px;padding:20px;margin:16px 0;text-align:center}
        .test-demo img{max-width:100%;border-radius:8px;margin:12px 0}
    </style>
</head>
<body>
    <!-- é¦–é  -->
    <div id="home" class="page active">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="location.href='jama-rational-exam.html'">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#BF360C">å›°é›£æ’ç®¡é æ¸¬</span>
            </div>
        </header>
        <div class="hero">
            <div class="container">
                <div class="tag">ğŸ« JAMA Rational Clinical Examination</div>
                <h1 style="font-size:22px;font-weight:700;margin-bottom:8px">Will This Patient Be Difficult to Intubate?</h1>
                <h2 style="font-size:15px;font-weight:500;margin-bottom:12px;opacity:0.95">å›°é›£æ°£ç®¡å…§æ’ç®¡çš„è‡¨åºŠé æ¸¬</h2>
                <a href="https://jamanetwork.com/journals/jama/article-abstract/2724031" target="_blank" style="display:inline-block;background:rgba(255,255,255,0.25);padding:8px 16px;border-radius:8px;color:#fff;text-decoration:none;font-size:13px;margin-bottom:16px;transition:background 0.2s" onmouseover="this.style.background='rgba(255,255,255,0.4)'" onmouseout="this.style.background='rgba(255,255,255,0.25)'">ğŸ“„ JAMA 2019;321(5):493-503 â†—</a>
                <div class="badge-row">
                    <div class="badge">ğŸ“Š N=33,559</div>
                    <div class="badge">ğŸ“š 62 Studies</div>
                    <div class="badge">ğŸ¯ LR Analysis</div>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="container">
                <div class="card">
                    <h3 style="font-size:16px;font-weight:700;color:var(--pri);margin-bottom:12px">ğŸ¯ å­¸ç¿’ç›®æ¨™</h3>
                    <div class="goal-item"><span class="goal-num">1</span><span style="color:var(--txt2)">äº†è§£å›°é›£æ’ç®¡çš„å®šç¾©èˆ‡ç››è¡Œç‡</span></div>
                    <div class="goal-item"><span class="goal-num">2</span><span style="color:var(--txt2)">æŒæ¡ä¸Šå”‡å’¬åˆè©¦é©— (ULBT) çš„æ“ä½œèˆ‡åˆ¤è®€</span></div>
                    <div class="goal-item"><span class="goal-num">3</span><span style="color:var(--txt2)">å­¸æœƒè§£å‰–å­¸æ¸¬é‡æŒ‡æ¨™çš„è‡¨åºŠæ‡‰ç”¨</span></div>
                    <div class="goal-item"><span class="goal-num">4</span><span style="color:var(--txt2)">ç†è§£ Mallampati åˆ†ç´šçš„è¨ºæ–·åƒ¹å€¼</span></div>
                    <div class="goal-item"><span class="goal-num">5</span><span style="color:var(--txt2)">è‡¨åºŠç¶œåˆè©•ä¼°èˆ‡ Wilson Score</span></div>
                </div>
                <div class="card">
                    <h3 style="font-size:16px;font-weight:700;color:var(--pri);margin-bottom:12px">ğŸ“– èª²ç¨‹å–®å…ƒ</h3>
                    <div class="lesson-item" onclick="showLesson(1)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#D84315,#D8431588)">1</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">å›°é›£æ’ç®¡æ¦‚è«–</div><div style="font-size:12px;color:var(--txt2)">Difficult Intubation Basics</div></div>
                        <svg viewBox="0 0 24 24" fill="#D84315" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(2)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#FF7043,#FF704388)">2</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">ä¸Šå”‡å’¬åˆè©¦é©—</div><div style="font-size:12px;color:var(--txt2)">Upper Lip Bite Test (ULBT)</div></div>
                        <svg viewBox="0 0 24 24" fill="#FF7043" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(3)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#26A69A,#26A69A88)">3</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">è§£å‰–å­¸æ¸¬é‡æŒ‡æ¨™</div><div style="font-size:12px;color:var(--txt2)">Anatomical Measurements</div></div>
                        <svg viewBox="0 0 24 24" fill="#26A69A" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(4)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#7E57C2,#7E57C288)">4</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">Mallampati åˆ†ç´š</div><div style="font-size:12px;color:var(--txt2)">Modified Mallampati Score</div></div>
                        <svg viewBox="0 0 24 24" fill="#7E57C2" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(5)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#FFB300,#FFB30088)">5</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">ç¶œåˆè©•ä¼°èˆ‡è‡¨åºŠæ‡‰ç”¨</div><div style="font-size:12px;color:var(--txt2)">Wilson Score & Clinical Application</div></div>
                        <svg viewBox="0 0 24 24" fill="#FFB300" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                </div>
                <button class="btn btn-acc" onclick="startQuiz()">ğŸ“ é–‹å§‹è‡ªæˆ‘æ¸¬é©—</button>
                <div class="card" style="background:linear-gradient(135deg,#FBE9E7,#FFCCBC);margin-top:16px">
                    <h3 style="font-size:14px;font-weight:700;color:var(--pri);margin-bottom:8px">ğŸ“Œ è‡¨åºŠè¦é»</h3>
                    <p style="font-size:13px;color:var(--txt2);line-height:1.8">ä¸Šå”‡å’¬åˆè©¦é©— (ULBT) ç¬¬3ç´šæ˜¯é æ¸¬å›°é›£æ’ç®¡æœ€ä½³çš„å–®ä¸€æŒ‡æ¨™ (LR+ 14)ï¼Œå¯å°‡å›°é›£æ’ç®¡çš„æ©Ÿç‡å¾ 10% æå‡è‡³è¶…é 60%ã€‚ä½†æ²’æœ‰ä»»ä½•å–®ä¸€æª¢æŸ¥å¯ä»¥å¯é åœ°æ’é™¤å›°é›£æ’ç®¡çš„å¯èƒ½æ€§ã€‚</p>
                </div>
                <footer>
                    <p style="font-size:12px;color:var(--txt2);margin-bottom:8px">æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨</p>
                    <p style="font-size:11px;color:var(--txt2)">è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                    <p style="font-size:10px;color:var(--txt2);margin-top:8px">è³‡æ–™ä¾†æº: JAMA 2019;321(5):493-503</p>
                </footer>
            </div>
        </div>
    </div>

    <!-- èª²ç¨‹é  -->
    <div id="lesson" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span id="lesson-title" style="font-weight:700;color:#BF360C"></span>
            </div>
        </header>
        <div id="lesson-header" class="lesson-header"></div>
        <div class="lesson-content">
            <div class="container">
                <div id="lesson-body"></div>
                <div class="nav-buttons">
                    <button id="prev-btn" class="btn btn-out" onclick="prevLesson()">â† ä¸Šä¸€èª²</button>
                    <button id="next-btn" class="btn btn-pri" onclick="nextLesson()">ä¸‹ä¸€èª² â†’</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¸¬é©—é  -->
    <div id="quiz" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#BF360C">è‡ªæˆ‘æ¸¬é©—</span>
            </div>
        </header>
        <div style="padding:20px 16px">
            <div class="container">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;font-size:14px">
                    <span style="color:var(--txt2)">é€²åº¦</span>
                    <span id="quiz-progress" style="font-weight:600;color:var(--pri)"></span>
                </div>
                <div class="progress-bar">
                    <div id="quiz-progress-bar" class="progress-fill"></div>
                </div>
                <div id="quiz-content" class="card"></div>
                <div id="quiz-feedback"></div>
                <button id="quiz-next" class="btn btn-pri" onclick="nextQuestion()" style="display:none;margin-top:16px">ä¸‹ä¸€é¡Œ â†’</button>
            </div>
        </div>
    </div>

    <!-- çµæœé  -->
    <div id="result" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#BF360C">æ¸¬é©—çµæœ</span>
            </div>
        </header>
        <div style="padding:40px 16px;text-align:center">
            <div class="container">
                <div id="result-circle" class="result-circle">
                    <div class="result-inner">
                        <div id="result-pct" style="font-size:36px;font-weight:700;color:var(--pri)"></div>
                        <div id="result-score" style="font-size:14px;color:var(--txt2)"></div>
                    </div>
                </div>
                <h2 id="result-title" style="font-size:24px;font-weight:700;margin-bottom:8px"></h2>
                <p id="result-msg" style="color:var(--txt2);margin-bottom:32px"></p>
                <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
                    <button class="btn btn-pri" onclick="startQuiz()">é‡æ–°æ¸¬é©—</button>
                    <button class="btn btn-out" onclick="showHome()">è¿”å›èª²ç¨‹</button>
                </div>
            </div>
        </div>
        <footer style="margin-top:40px">
            <p style="font-size:12px;color:var(--txt2)">æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨ | è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
        </footer>
    </div>

<script>
const lessons = [
    {id:1, title:'å›°é›£æ’ç®¡æ¦‚è«–', sub:'Difficult Intubation Basics', color:'#D84315'},
    {id:2, title:'ä¸Šå”‡å’¬åˆè©¦é©—', sub:'Upper Lip Bite Test (ULBT)', color:'#FF7043'},
    {id:3, title:'è§£å‰–å­¸æ¸¬é‡æŒ‡æ¨™', sub:'Anatomical Measurements', color:'#26A69A'},
    {id:4, title:'Mallampati åˆ†ç´š', sub:'Modified Mallampati Score', color:'#7E57C2'},
    {id:5, title:'ç¶œåˆè©•ä¼°èˆ‡è‡¨åºŠæ‡‰ç”¨', sub:'Wilson Score & Clinical Application', color:'#FFB300'}
];

const lessonContent = {
    1: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ</h4><p style="font-size:13px">å›°é›£æ’ç®¡ (Difficult Intubation) çš„æ—©æœŸè­˜åˆ¥å¯å¹«åŠ©è‡¨åºŠé†«å¸«æº–å‚™é€²éšæ°£é“è¨­å‚™ä¸¦å°‹æ±‚å°ˆæ¥­å”åŠ©ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ« ç‚ºä»€éº¼é‡è¦ï¼Ÿ</h4>
    <div class="info"><strong>ğŸ“Š è‡¨åºŠèƒŒæ™¯</strong><p style="font-size:13px;margin-top:6px">æ°£ç®¡å…§æ’ç®¡æ˜¯æ€¥æ•‘ã€éº»é†‰ã€åŠ è­·ç—…æˆ¿çš„åŸºæœ¬æŠ€è¡“ã€‚ç„¡æ³•é æœŸçš„å›°é›£æ’ç®¡å¯èƒ½å°è‡´åš´é‡ä½µç™¼ç—‡ï¼ŒåŒ…æ‹¬ç¼ºæ°§æ€§è…¦æå‚·ç”šè‡³æ­»äº¡ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“– å®šç¾©</h4>
    <div class="formula">å›°é›£æ’ç®¡ = å–‰é¡æª¢æŸ¥å›°é›£ æˆ– éœ€è¦å¤šæ¬¡å˜—è©¦æ‰èƒ½æˆåŠŸ</div>
    <table><thead><tr><th>è¡“èª</th><th>å®šç¾©</th></tr></thead>
    <tbody>
    <tr><td style="text-align:left;font-weight:600">Difficult Laryngoscopy</td><td style="text-align:left">Cormack-Lehane Grade 3-4</td></tr>
    <tr><td style="text-align:left;font-weight:600">Difficult Intubation</td><td style="text-align:left">éœ€è¦ >2 æ¬¡å˜—è©¦æˆ– >10 åˆ†é˜</td></tr>
    <tr><td style="text-align:left;font-weight:600">Failed Intubation</td><td style="text-align:left">ç„¡æ³•æˆåŠŸå»ºç«‹æ°£é“</td></tr>
    </tbody></table>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š ç ”ç©¶æ¦‚æ³</h4>
    <div class="stat-box" style="background:#FBE9E7;margin-bottom:16px">
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr;gap:10px;text-align:center">
            <div><div class="label">ç ”ç©¶æ•¸é‡</div><div class="value" style="color:var(--pri)">62</div></div>
            <div><div class="label">æ‚£è€…ç¸½æ•¸</div><div class="value" style="color:var(--pri)">33,559</div></div>
            <div><div class="label">å›°é›£æ’ç®¡æ¯”ä¾‹</div><div class="value" style="color:var(--err)">10%</div></div>
        </div>
    </div>
    <div class="warn"><strong>âš ï¸ é‡è¦ç™¼ç¾</strong><p style="font-size:13px;margin-top:6px">åœ¨é«˜å“è³ªç ”ç©¶ä¸­ï¼Œç´„ <strong>10%</strong> (95% CI: 8.2%-12%) çš„æ‚£è€…å±¬æ–¼å›°é›£æ’ç®¡ã€‚é€™æ„å‘³è‘—æ¯ 10 ä½éœ€è¦æ’ç®¡çš„æ‚£è€…ä¸­ï¼Œå°±æœ‰ 1 ä½å¯èƒ½é‡åˆ°å›°é›£ã€‚</p></div>
    <div class="good" style="margin-top:16px"><strong>âœ” é—œéµçµè«–</strong><p style="font-size:13px;margin-top:6px">â€¢ å¤šç¨®èº«é«”æª¢æŸ¥å¯ä»¥é æ¸¬å›°é›£æ’ç®¡<br>â€¢ <strong>æ²’æœ‰ä»»ä½•æª¢æŸ¥å¯ä»¥å¯é åœ°æ’é™¤å›°é›£æ’ç®¡</strong><br>â€¢ æœ€ä½³é æ¸¬æŒ‡æ¨™æ˜¯ä¸Šå”‡å’¬åˆè©¦é©— (ULBT)</p></div>`,
    
    2: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ ä¸Šå”‡å’¬åˆè©¦é©— (ULBT)</h4><p style="font-size:13px">ULBT æ˜¯é æ¸¬å›°é›£æ’ç®¡æœ€æº–ç¢ºçš„å–®ä¸€èº«é«”æª¢æŸ¥ï¼Œæ“ä½œç°¡å–®ä¸”è¨ºæ–·åƒ¹å€¼æœ€é«˜ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ¦· æ“ä½œæ–¹æ³•</h4>
    <div class="info"><strong>ğŸ’¡ æ¸¬è©¦æ­¥é©Ÿ</strong><p style="font-size:13px;margin-top:6px">è«‹æ‚£è€…ç”¨<strong>ä¸‹æ’é–€ç‰™</strong>å’¬ä½<strong>ä¸Šå˜´å”‡</strong>ï¼Œè§€å¯Ÿä¸‹é¡å‰çªçš„èƒ½åŠ›å’Œä¸‹é–€ç‰™å¯ä»¥å»¶ä¼¸åˆ°é”çš„ä½ç½®ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š ULBT åˆ†ç´šæ¨™æº–</h4>
    <table><thead><tr><th>åˆ†ç´š</th><th>æè¿°</th><th>é æ¸¬</th></tr></thead>
    <tbody>
    <tr><td style="font-weight:600;color:var(--suc)">Class 1</td><td style="text-align:left">ä¸‹é–€ç‰™å¯å’¬ä½ä¸Šå”‡ç´…å”‡ç·šä»¥ä¸Š</td><td style="color:var(--suc)">å®¹æ˜“æ’ç®¡</td></tr>
    <tr><td style="font-weight:600;color:var(--warn)">Class 2</td><td style="text-align:left">ä¸‹é–€ç‰™å¯å’¬ä½ä¸Šå”‡ç´…å”‡ç·šä»¥ä¸‹</td><td style="color:var(--warn)">ä¸­ç­‰</td></tr>
    <tr><td style="font-weight:600;color:var(--err)">Class 3</td><td style="text-align:left">ä¸‹é–€ç‰™ç„¡æ³•å»¶ä¼¸å’¬åˆ°ä¸Šå”‡</td><td style="color:var(--err)">å›°é›£æ’ç®¡</td></tr>
    </tbody></table>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“ˆ ULBT Class 3 çš„è¨ºæ–·åƒ¹å€¼</h4>
    <div class="stat-box" style="background:#FBE9E7;margin-bottom:16px">
        <div style="font-weight:700;color:var(--pri);margin-bottom:10px">ULBT Class 3ï¼ˆæœ€ä½³é æ¸¬æŒ‡æ¨™ï¼‰</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr 1fr;gap:8px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--pri)">28%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--pri)">96%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">14</div></div>
            <div><div class="label">LR-</div><div class="value" style="color:var(--warn)">0.75</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">LR+ 95% CI: 8.9-22</div>
    </div>
    <div class="good"><strong>âœ” è‡¨åºŠæ„ç¾©</strong><p style="font-size:13px;margin-top:6px"><strong>LR+ = 14</strong> æ˜¯æ‰€æœ‰å–®ä¸€æª¢æŸ¥ä¸­æœ€é«˜çš„ï¼<br>â€¢ å‰æ¸¬æ©Ÿç‡ 10% â†’ å¾Œæ¸¬æ©Ÿç‡ <strong>>60%</strong><br>â€¢ ç•¶ ULBT Class 3 æ™‚ï¼Œæ‡‰é«˜åº¦è­¦è¦ºå›°é›£æ’ç®¡</p></div>
    <div class="warn" style="margin-top:16px"><strong>âš ï¸ é™åˆ¶</strong><p style="font-size:13px;margin-top:6px">â€¢ æ•æ„Ÿåº¦åƒ… 28%ï¼Œå¤§å¤šæ•¸å›°é›£æ’ç®¡æ‚£è€… ULBT æ­£å¸¸<br>â€¢ LR- = 0.75ï¼ŒULBT æ­£å¸¸ä¸èƒ½æ’é™¤å›°é›£æ’ç®¡<br>â€¢ éœ€çµåˆå…¶ä»–è©•ä¼°æ–¹æ³•</p></div>`,
    
    3: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ è§£å‰–å­¸æ¸¬é‡æŒ‡æ¨™</h4><p style="font-size:13px">ä¸‹é ¦èˆŒéª¨è·é›¢ (Hyomental Distance) å’Œå°é œç•¸å½¢ (Retrognathia) æ˜¯é‡è¦çš„è§£å‰–å­¸é æ¸¬æŒ‡æ¨™ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“ ä¸‹é ¦èˆŒéª¨è·é›¢ (Hyomental Distance)</h4>
    <div class="info"><strong>ğŸ’¡ æ¸¬é‡æ–¹æ³•</strong><p style="font-size:13px;margin-top:6px">æ¸¬é‡<strong>èˆŒéª¨</strong>åˆ°<strong>ä¸‹å·´å°–ç«¯</strong>çš„ç›´ç·šè·é›¢ã€‚<br>é–¾å€¼ï¼š< 3-5.5 cm ç‚ºç•°å¸¸ï¼ˆå„ç ”ç©¶å®šç¾©ç•¥æœ‰ä¸åŒï¼‰</p></div>
    <div class="stat-box" style="background:#E0F2F1;margin-bottom:16px">
        <div style="font-weight:700;color:var(--teal);margin-bottom:10px">çŸ­ä¸‹é ¦èˆŒéª¨è·é›¢</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr 1fr;gap:8px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--teal)">20%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--teal)">97%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">6.4</div></div>
            <div><div class="label">LR-</div><div class="value" style="color:var(--warn)">0.83</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">LR+ 95% CI: 4.1-10</div>
    </div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ¦´ å°é œç•¸å½¢ (Retrognathia)</h4>
    <div class="info"><strong>ğŸ’¡ è©•ä¼°æ–¹æ³•</strong><p style="font-size:13px;margin-top:6px">â€¢ å®¢è§€æ¸¬é‡ï¼šä¸‹é¡è§’åˆ°ä¸‹å·´å°–ç«¯ < 9 cm<br>â€¢ ä¸»è§€è©•ä¼°ï¼šä¸‹å·´æ˜é¡¯å¾Œç¸®</p></div>
    <div class="stat-box" style="background:#EDE7F6;margin-bottom:16px">
        <div style="font-weight:700;color:var(--pur);margin-bottom:10px">å°é œç•¸å½¢ (Retrognathia)</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr 1fr;gap:8px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--pur)">11%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--pur)">98%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">6.0</div></div>
            <div><div class="label">LR-</div><div class="value" style="color:var(--warn)">0.91</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">LR+ 95% CI: 3.1-11</div>
    </div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“ å…¶ä»–è§£å‰–å­¸æŒ‡æ¨™</h4>
    <table><thead><tr><th>æŒ‡æ¨™</th><th>ç•°å¸¸å®šç¾©</th><th>LR+</th></tr></thead>
    <tbody>
    <tr><td style="text-align:left;font-weight:600">ç”²é ¦è·é›¢ (TMD)</td><td>< 6-7 cm</td><td><span class="lr-mod">3.4</span></td></tr>
    <tr><td style="text-align:left;font-weight:600">èƒ¸é ¦è·é›¢ (SMD)</td><td>< 12.5 cm</td><td><span class="lr-mod">3.3</span></td></tr>
    <tr><td style="text-align:left;font-weight:600">å¼µå£åº¦</td><td>< 3.5-4 cm</td><td><span class="lr-mod">3.1</span></td></tr>
    </tbody></table>
    <div class="tip" style="margin-top:16px"><strong>ğŸ” è‡¨åºŠè¦é»</strong><p style="font-size:13px;margin-top:6px">è§£å‰–å­¸æ¸¬é‡çš„ç‰¹ç•°åº¦å¾ˆé«˜ (96-98%)ï¼Œä½†æ•æ„Ÿåº¦éƒ½å¾ˆä½ã€‚ç•°å¸¸ç™¼ç¾å¼·çƒˆæç¤ºå›°é›£æ’ç®¡ï¼Œä½†æ­£å¸¸ä¸èƒ½æ’é™¤ã€‚</p></div>`,
    
    4: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ Mallampati åˆ†ç´š</h4><p style="font-size:13px">Modified Mallampati Score (MMS) æ˜¯è‡¨åºŠæœ€å»£æ³›ä½¿ç”¨çš„æ°£é“è©•ä¼°å·¥å…·ï¼Œä½†è¨ºæ–·åƒ¹å€¼ä¸­ç­‰ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ‘„ æ“ä½œæ–¹æ³•</h4>
    <div class="info"><strong>ğŸ’¡ æ¨™æº–æ“ä½œ</strong><p style="font-size:13px;margin-top:6px">1. æ‚£è€…åå§¿ï¼Œé ­éƒ¨ä¸­ç«‹ä½<br>2. å¼µå£åˆ°æœ€å¤§ï¼ŒèˆŒé ­ä¼¸å‡ºä½†ä¸ç™¼è²<br>3. è§€å¯Ÿå¯è¦‹çš„å’½éƒ¨çµæ§‹</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š MMS åˆ†ç´šæ¨™æº–</h4>
    <table><thead><tr><th>åˆ†ç´š</th><th>å¯è¦‹çµæ§‹</th></tr></thead>
    <tbody>
    <tr><td style="font-weight:600;color:var(--suc)">Class 1</td><td style="text-align:left">è»Ÿé¡ã€æ‡¸é›å‚ã€æ‰æ¡ƒé«”æŸ±å…¨éƒ¨å¯è¦‹</td></tr>
    <tr><td style="font-weight:600;color:var(--suc)">Class 2</td><td style="text-align:left">è»Ÿé¡ã€æ‡¸é›å‚å¯è¦‹</td></tr>
    <tr><td style="font-weight:600;color:var(--warn)">Class 3</td><td style="text-align:left">åƒ…è»Ÿé¡å¯è¦‹</td></tr>
    <tr><td style="font-weight:600;color:var(--err)">Class 4</td><td style="text-align:left">åƒ…ç¡¬é¡å¯è¦‹</td></tr>
    </tbody></table>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“ˆ MMS â‰¥ 3 çš„è¨ºæ–·åƒ¹å€¼</h4>
    <div class="stat-box" style="background:#EDE7F6;margin-bottom:16px">
        <div style="font-weight:700;color:var(--pur);margin-bottom:10px">Modified Mallampati Score â‰¥ 3</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr 1fr;gap:8px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--pur)">53%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--pur)">87%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--warn)">4.1</div></div>
            <div><div class="label">LR-</div><div class="value" style="color:var(--warn)">0.54</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">LR+ 95% CI: 3.0-5.6</div>
    </div>
    <div class="warn"><strong>âš ï¸ MMS çš„é™åˆ¶</strong><p style="font-size:13px;margin-top:6px">â€¢ LR+ = 4.1 åƒ…ç‚ºä¸­ç­‰å¼·åº¦<br>â€¢ LR- = 0.54 ç„¡æ³•æœ‰æ•ˆæ’é™¤å›°é›£æ’ç®¡<br>â€¢ è©•ä¼°è€…é–“ä¸€è‡´æ€§è¼ƒå·®<br>â€¢ æ¯” ULBT (LR+ 14) çš„é æ¸¬èƒ½åŠ›ä½</p></div>
    <div class="tip" style="margin-top:16px"><strong>ğŸ” æ¯”è¼ƒ ULBT vs MMS</strong><p style="font-size:13px;margin-top:6px">â€¢ <strong>ULBT Class 3</strong>ï¼šLR+ = 14ï¼Œç‰¹ç•°åº¦ 96%<br>â€¢ <strong>MMS â‰¥ 3</strong>ï¼šLR+ = 4.1ï¼Œç‰¹ç•°åº¦ 87%<br>â€¢ ULBT é æ¸¬å›°é›£æ’ç®¡çš„èƒ½åŠ›å„ªæ–¼ MMS</p></div>`,
    
    5: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ ç¶œåˆè©•ä¼°</h4><p style="font-size:13px">çµåˆå¤šé …æŒ‡æ¨™çš„ Wilson Score å¯æé«˜é æ¸¬æº–ç¢ºåº¦ï¼Œä½†ä»ç„¡æ³•å®Œå…¨æ’é™¤å›°é›£æ’ç®¡ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š Wilson Score è¨ˆåˆ†ç³»çµ±</h4>
    <div class="info"><strong>ğŸ’¡ è©•ä¼°é …ç›®ï¼ˆå„0-2åˆ†ï¼‰</strong><p style="font-size:13px;margin-top:6px">1. é«”é‡<br>2. é ­é ¸æ´»å‹•åº¦<br>3. å¼µå£åº¦<br>4. å°é œç•¸å½¢<br>5. æš´ç‰™</p></div>
    <div class="stat-box" style="background:#FFF8E1;margin-bottom:16px">
        <div style="font-weight:700;color:var(--acc);margin-bottom:10px">Wilson Score ç•°å¸¸</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr 1fr;gap:8px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--acc)">34%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--acc)">95%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">9.1</div></div>
            <div><div class="label">LR-</div><div class="value" style="color:var(--warn)">0.69</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">LR+ 95% CI: 5.1-16</div>
    </div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š æ‰€æœ‰é æ¸¬æŒ‡æ¨™æ¯”è¼ƒ</h4>
    <table><thead><tr><th>æŒ‡æ¨™</th><th>LR+</th><th>ç‰¹ç•°åº¦</th><th>æ’å</th></tr></thead>
    <tbody>
    <tr style="background:#FBE9E7"><td style="text-align:left;font-weight:600">ULBT Class 3</td><td><span class="lr-high">14</span></td><td>96%</td><td>â­ #1</td></tr>
    <tr><td style="text-align:left;font-weight:600">Wilson Score</td><td><span class="lr-high">9.1</span></td><td>95%</td><td>#2</td></tr>
    <tr><td style="text-align:left;font-weight:600">çŸ­ä¸‹é ¦èˆŒéª¨è·é›¢</td><td><span class="lr-high">6.4</span></td><td>97%</td><td>#3</td></tr>
    <tr><td style="text-align:left;font-weight:600">å°é œç•¸å½¢</td><td><span class="lr-high">6.0</span></td><td>98%</td><td>#4</td></tr>
    <tr><td style="text-align:left;font-weight:600">MMS â‰¥ 3</td><td><span class="lr-mod">4.1</span></td><td>87%</td><td>#5</td></tr>
    <tr><td style="text-align:left;font-weight:600">ç”²é ¦è·é›¢çŸ­</td><td><span class="lr-mod">3.4</span></td><td>92%</td><td>#6</td></tr>
    </tbody></table>
    <div class="warn" style="margin-top:16px"><strong>âš ï¸ é‡è¦çµè«–</strong><p style="font-size:13px;margin-top:6px"><strong>æ²’æœ‰ä»»ä½•å–®ä¸€æª¢æŸ¥æˆ–çµ„åˆå¯ä»¥å¯é åœ°æ’é™¤å›°é›£æ’ç®¡ï¼</strong><br>æ‰€æœ‰æŒ‡æ¨™çš„ LR- éƒ½æ¥è¿‘ 1ï¼Œç„¡æ³•æœ‰æ•ˆé™ä½å›°é›£æ’ç®¡çš„å¯èƒ½æ€§ã€‚</p></div>
    <div class="good" style="margin-top:16px"><strong>âœ” è‡¨åºŠå»ºè­°</strong><p style="font-size:13px;margin-top:6px">1. <strong>ULBT Class 3</strong> æ˜¯æœ€ä½³å–®ä¸€é æ¸¬æŒ‡æ¨™<br>2. ç•°å¸¸ç™¼ç¾æ™‚ï¼šæº–å‚™é€²éšæ°£é“è¨­å‚™ã€å°‹æ±‚å°ˆæ¥­å”åŠ©<br>3. æ­£å¸¸ç™¼ç¾æ™‚ï¼šä»éœ€ä¿æŒè­¦è¦ºï¼Œæº–å‚™å¾Œå‚™è¨ˆç•«<br>4. å‰æ¸¬æ©Ÿç‡ 10% + ULBT Class 3 â†’ å¾Œæ¸¬æ©Ÿç‡ >60%</p></div>
    <div class="orange" style="margin-top:16px"><strong>ğŸ“‹ å¯¦å‹™æµç¨‹</strong><p style="font-size:13px;margin-top:6px">â€¢ æ‰€æœ‰éœ€æ’ç®¡æ‚£è€…éƒ½æ‡‰é€²è¡Œæ°£é“è©•ä¼°<br>â€¢ å„ªå…ˆä½¿ç”¨ ULBTï¼ˆæœ€æº–ç¢ºä¸”æ˜“æ“ä½œï¼‰<br>â€¢ çµåˆ Mallampatiã€è§£å‰–å­¸æ¸¬é‡ç¶œåˆåˆ¤æ–·<br>â€¢ æ°¸é æº–å‚™å›°é›£æ°£é“è™•ç†è¨ˆç•«</p></div>`
};

const quiz = [
    {q:'æ ¹æ“š JAMA ç³»çµ±æ€§å›é¡§ï¼Œåœ¨éœ€è¦æ’ç®¡çš„æ‚£è€…ä¸­ï¼Œå›°é›£æ’ç®¡çš„æ¯”ä¾‹ç´„ç‚ºå¤šå°‘ï¼Ÿ',o:['ç´„ 3%','ç´„ 10%','ç´„ 20%','ç´„ 30%'],c:1,e:'åœ¨ 62 é …é«˜å“è³ªç ”ç©¶ä¸­ï¼Œç´„ 10% (95% CI: 8.2%-12%) çš„æ‚£è€…å±¬æ–¼å›°é›£æ’ç®¡ã€‚'},
    {q:'ä¸Šå”‡å’¬åˆè©¦é©— (ULBT) çš„æ“ä½œæ–¹æ³•ç‚ºä½•ï¼Ÿ',o:['ç”¨ä¸Šé–€ç‰™å’¬ä¸‹å˜´å”‡','ç”¨ä¸‹é–€ç‰™å’¬ä¸Šå˜´å”‡','å¼µå˜´ä¼¸èˆŒè§€å¯Ÿå’½éƒ¨','æ¸¬é‡å¼µå£åº¦å¤§å°'],c:1,e:'ULBT æ˜¯è«‹æ‚£è€…ç”¨ä¸‹æ’é–€ç‰™å’¬ä½ä¸Šå˜´å”‡ï¼Œè§€å¯Ÿä¸‹é¡å‰çªçš„èƒ½åŠ›ã€‚'},
    {q:'ULBT Class 3 çš„å®šç¾©æ˜¯ä»€éº¼ï¼Ÿ',o:['ä¸‹é–€ç‰™å¯å’¬ä½ä¸Šå”‡ç´…å”‡ç·šä»¥ä¸Š','ä¸‹é–€ç‰™å¯å’¬ä½ä¸Šå”‡ç´…å”‡ç·šä»¥ä¸‹','ä¸‹é–€ç‰™ç„¡æ³•å»¶ä¼¸å’¬åˆ°ä¸Šå”‡','ä¸‹é–€ç‰™å¯å®Œå…¨è¦†è“‹ä¸Šå”‡'],c:2,e:'ULBT Class 3 è¡¨ç¤ºä¸‹é–€ç‰™ç„¡æ³•å»¶ä¼¸åˆ°é”ä¸Šå”‡ï¼Œæ˜¯é æ¸¬å›°é›£æ’ç®¡çš„æœ€ä½³æŒ‡æ¨™ã€‚'},
    {q:'ULBT Class 3 é æ¸¬å›°é›£æ’ç®¡çš„é™½æ€§ä¼¼ç„¶æ¯” (LR+) ç‚ºå¤šå°‘ï¼Ÿ',o:['4.1','6.4','9.1','14'],c:3,e:'ULBT Class 3 çš„ LR+ = 14 (95% CI: 8.9-22)ï¼Œæ˜¯æ‰€æœ‰å–®ä¸€æª¢æŸ¥ä¸­æœ€é«˜çš„ã€‚'},
    {q:'Modified Mallampati Score â‰¥ 3 çš„ LR+ ç‚ºå¤šå°‘ï¼Ÿ',o:['4.1','6.0','9.1','14'],c:0,e:'MMS â‰¥ 3 çš„ LR+ = 4.1 (95% CI: 3.0-5.6)ï¼Œé æ¸¬èƒ½åŠ›ä¸å¦‚ ULBTã€‚'},
    {q:'ä¸‹åˆ—ä½•è€…çš„ç‰¹ç•°åº¦æœ€é«˜ï¼Ÿ',o:['ULBT Class 3 (96%)','å°é œç•¸å½¢ (98%)','MMS â‰¥ 3 (87%)','Wilson Score (95%)'],c:1,e:'å°é œç•¸å½¢çš„ç‰¹ç•°åº¦æœ€é«˜ (98%)ï¼Œä½†æ•æ„Ÿåº¦åƒ… 11%ã€‚'},
    {q:'é—œæ–¼å›°é›£æ’ç®¡é æ¸¬ï¼Œä»¥ä¸‹ä½•è€…æ­£ç¢ºï¼Ÿ',o:['MMS æ˜¯æœ€æº–ç¢ºçš„å–®ä¸€é æ¸¬æŒ‡æ¨™','ULBT æ­£å¸¸å¯ä»¥æ’é™¤å›°é›£æ’ç®¡','æ²’æœ‰ä»»ä½•æª¢æŸ¥å¯ä»¥å¯é æ’é™¤å›°é›£æ’ç®¡','Wilson Score çš„ LR+ æœ€é«˜'],c:2,e:'ç ”ç©¶çš„é‡è¦çµè«–ï¼šæ²’æœ‰ä»»ä½•å–®ä¸€æª¢æŸ¥æˆ–çµ„åˆå¯ä»¥å¯é åœ°æ’é™¤å›°é›£æ’ç®¡ã€‚'},
    {q:'çŸ­ä¸‹é ¦èˆŒéª¨è·é›¢é æ¸¬å›°é›£æ’ç®¡çš„ LR+ ç´„ç‚ºå¤šå°‘ï¼Ÿ',o:['3.4','4.1','6.4','14'],c:2,e:'çŸ­ä¸‹é ¦èˆŒéª¨è·é›¢çš„ LR+ = 6.4 (95% CI: 4.1-10)ã€‚'},
    {q:'Wilson Score è©•ä¼°å“ªäº›é …ç›®ï¼Ÿ',o:['é«”é‡ã€é ­é ¸æ´»å‹•åº¦ã€å¼µå£åº¦ã€å°é œç•¸å½¢ã€æš´ç‰™','MMSã€ULBTã€TMDã€SMDã€å¼µå£åº¦','å¹´é½¡ã€æ€§åˆ¥ã€BMIã€é ¸åœã€MMS','èº«é«˜ã€é«”é‡ã€å¼µå£åº¦ã€ç”²é ¦è·é›¢ã€MMS'],c:0,e:'Wilson Score è©•ä¼°ï¼šé«”é‡ã€é ­é ¸æ´»å‹•åº¦ã€å¼µå£åº¦ã€å°é œç•¸å½¢ã€æš´ç‰™ï¼Œå„é … 0-2 åˆ†ã€‚'},
    {q:'è‹¥æ‚£è€… ULBT ç‚º Class 3ï¼Œå›°é›£æ’ç®¡çš„å¾Œæ¸¬æ©Ÿç‡ç´„ç‚ºå¤šå°‘ï¼Ÿï¼ˆå‡è¨­å‰æ¸¬æ©Ÿç‡ 10%ï¼‰',o:['ç´„ 20%','ç´„ 40%','ç´„ 60%','ç´„ 80%'],c:2,e:'å‰æ¸¬æ©Ÿç‡ 10% + LR+ 14 = å¾Œæ¸¬æ©Ÿç‡ç´„ 60%ã€‚ULBT Class 3 å¯å°‡å›°é›£æ’ç®¡æ©Ÿç‡å¾ 10% æå‡è‡³ >60%ã€‚'}
];

const MODULE_ID = 'jama-difficult-intubation';

// Badge definitions for notifications
const badgeDefs = {
    'first-quiz': { name: 'åˆè©¦å•¼è²', icon: 'ğŸ¯' },
    'perfect-score': { name: 'æ»¿åˆ†é”äºº', icon: 'ğŸ’¯' },
    'five-complete': { name: 'å°æœ‰æˆå°±', icon: 'â­' },
    'ten-complete': { name: 'å­¸æœ‰å°ˆç²¾', icon: 'ğŸŒŸ' },
    'master': { name: 'EBMå¤§å¸«', icon: 'ğŸ‘‘' },
    'speed-demon': { name: 'ç¥é€Ÿç­”é¡Œ', icon: 'âš¡' },
    'persistent': { name: 'å …æŒä¸æ‡ˆ', icon: 'ğŸ’ª' },
    'three-streak': { name: 'é€£å‹ä¸‰å ´', icon: 'ğŸ”¥' },
    'five-streak': { name: 'äº”é€£å‹', icon: 'ğŸ†' },
    'triple-perfect': { name: 'ä¸‰å† ç‹', icon: 'ğŸ‘‘' },
    'early-bird': { name: 'æ—©èµ·çš„é³¥', icon: 'ğŸ¦' },
    'night-owl': { name: 'å¤œè²“å­', icon: 'ğŸ¦‰' },
    'weekend-warrior': { name: 'å‡æ—¥æˆ°å£«', icon: 'ğŸ“…' },
    'comeback-kid': { name: 'é€†è½‰å‹', icon: 'ğŸš€' },
    'quick-learner': { name: 'ä¸€é»å°±é€š', icon: 'ğŸ’¡' },
    'improvement-king': { name: 'é€²æ­¥ç‹', icon: 'ğŸ“ˆ' },
    'marathon-runner': { name: 'é¦¬æ‹‰æ¾å­¸ç¿’è€…', icon: 'ğŸƒ' },
    'reviewer': { name: 'æº«æ•…çŸ¥æ–°', icon: 'ğŸ“–' },
    'almost-there': { name: 'å·®ä¸€é»é»', icon: 'ğŸ˜…' },
    'generous-guesser': { name: 'ä½›ç³»ç­”é¡Œ', icon: 'ğŸ™' },
    'learning-worm': { name: 'å­¸è¡“èš¯èš“', icon: 'ğŸª±' },
    'eternal-student': { name: 'æ°¸æ†çš„å­¸ç”Ÿ', icon: 'â™¾ï¸' },
    'speed-fail': { name: 'å…‰é€Ÿé™£äº¡', icon: 'ğŸ’«' },
    'slow-and-wrong': { name: 'æƒ³å¾ˆä¹…é‚„æ˜¯éŒ¯', icon: 'ğŸ¤”' },
    'zero-hero': { name: 'é›¶åˆ†è‹±é›„', icon: 'ğŸ’€' },
    'procrastinator': { name: 'æœ€å¾Œä¸€ç§’', icon: 'â°' },
    'deja-vu': { name: 'æ—¢è¦–æ„Ÿ', icon: 'ğŸ‘€' },
    'coffee-needed': { name: 'éœ€è¦å’–å•¡', icon: 'â˜•' },
    'wanderer': { name: 'æ¼«éŠè€…', icon: 'ğŸ§­' },
    'consistent-output': { name: 'ç©©å®šè¼¸å‡º', icon: 'ğŸ¯' },
    'heart-expert': { name: 'å¿ƒè‡Ÿé”äºº', icon: 'â¤ï¸' },
    'critical-master': { name: 'æ€¥é‡ç—‡å°ˆå®¶', icon: 'ğŸš¨' },
    'neuro-ninja': { name: 'ç¥ç¶“å¿è€…', icon: 'ğŸ§ ' },
    'pulm-pro': { name: 'èƒ¸è…”é«˜æ‰‹', icon: 'ğŸ«' },
    'ebm-foundation': { name: 'EBMåŸºçŸ³', icon: 'ğŸ›ï¸' },
    'jama-collector': { name: 'JAMAæ”¶è—å®¶', icon: 'ğŸ“š' },
    'achievement-hunter': { name: 'æˆå°±çµäºº', icon: 'ğŸ…' },
    'lucky-seven': { name: 'å¹¸é‹ä¸ƒ', icon: 'ğŸ€' },
    'completionist': { name: 'å…¨æˆå°±é”æˆ', icon: 'ğŸ–ï¸' }
};

const categoryModules = {
    cardio: ['jama-chest-pain-acs', 'jama-syncope', 'jama-hypertension'],
    critical: ['jama-bacteremia', 'jama-gi-bleed', 'jama-fluid-responsiveness', 'jama-difficult-intubation', 'jama-cirrhosis', 'jama-wound-infection'],
    neuro: ['jama-head-trauma', 'jama-delirium', 'jama-decision-capacity'],
    pulm: ['jama-pleural-effusion', 'jama-osa'],
    core: ['critical-appraisal', 'diagnostic-study', 'prognosis-study', 'rct-appraisal', 'systematic-review', 'literature-search']
};

const ProgressTracker={
    STORAGE_KEY:'ebm-progress',
    newBadges: [],
    getProgress:()=>{try{const d=localStorage.getItem(ProgressTracker.STORAGE_KEY);return d?JSON.parse(d):{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}catch{return{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}},
    saveQuizResult:(moduleId,score,total,timeSpent)=>{
        ProgressTracker.newBadges = [];
        const progress=ProgressTracker.getProgress();
        const mod=progress.modules[moduleId]||{bestScore:0,totalAttempts:0,allAttempts:[],lessonsViewed:[],completed:false,firstCompleted:null};
        const attempt={date:new Date().toISOString(),score,timeSpent};
        mod.allAttempts.push(attempt);mod.totalAttempts++;
        if(score>mod.bestScore)mod.bestScore=score;
        const passingScore=Math.ceil(total*0.7);
        if(score>=passingScore&&!mod.completed){mod.completed=true;mod.firstCompleted=attempt.date}
        progress.modules[moduleId]=mod;progress.totalTimeSpent+=timeSpent;progress.lastUpdated=new Date().toISOString();
        ProgressTracker.checkBadges(progress,moduleId,score,total,timeSpent);
        localStorage.setItem(ProgressTracker.STORAGE_KEY,JSON.stringify(progress));return progress;
    },
    checkBadges:(progress,moduleId,score,total,timeSpent)=>{
        const badges=progress.badges||[];const ids=badges.map(b=>b.id);const now=new Date();const nowStr=now.toISOString();
        const hour=now.getHours();const day=now.getDay();
        const passed=score>=Math.ceil(total*0.7);const perfect=score===total;
        const addBadge=(id)=>{if(!ids.includes(id)){badges.push({id,earnedAt:nowStr});ids.push(id);ProgressTracker.newBadges.push(id);return true}return false};

        addBadge('first-quiz');
        if(perfect)addBadge('perfect-score');
        if(timeSpent<120&&passed)addBadge('speed-demon');
        const completed=Object.values(progress.modules).filter(m=>m.completed).length;
        if(completed>=5)addBadge('five-complete');
        if(completed>=10)addBadge('ten-complete');
        if(completed>=18)addBadge('master');
        const mod=progress.modules[moduleId];
        if(mod&&mod.totalAttempts>=3)addBadge('persistent');

        if(hour<6)addBadge('early-bird');
        if(hour>=0&&hour<5)addBadge('night-owl');
        if(day===0||day===6)addBadge('weekend-warrior');
        if(hour>=2&&hour<5&&!passed)addBadge('coffee-needed');

        const streakData=progress.streakData||{currentPassStreak:0,currentPerfectStreak:0};
        if(passed){streakData.currentPassStreak++;if(perfect)streakData.currentPerfectStreak++;else streakData.currentPerfectStreak=0}
        else{streakData.currentPassStreak=0;streakData.currentPerfectStreak=0}
        if(streakData.currentPassStreak>=3)addBadge('three-streak');
        if(streakData.currentPassStreak>=5)addBadge('five-streak');
        if(streakData.currentPerfectStreak>=3)addBadge('triple-perfect');
        progress.streakData=streakData;

        if(mod){
            if(mod.totalAttempts===1&&perfect)addBadge('quick-learner');
            if(mod.totalAttempts===1&&score===7)addBadge('lucky-seven');
            if(mod.allAttempts&&mod.allAttempts.length>1){
                const firstScore=mod.allAttempts[0].score;
                if(firstScore<7&&perfect)addBadge('comeback-kid');
                if(score-firstScore>=5)addBadge('improvement-king');
                const lastThree=mod.allAttempts.slice(-3);
                if(lastThree.length===3&&lastThree[0].score===lastThree[1].score&&lastThree[1].score===lastThree[2].score)addBadge('deja-vu');
                if(lastThree.length===3&&lastThree.every(a=>a.score===score))addBadge('consistent-output');
            }
            if(mod.totalAttempts>=10)addBadge('learning-worm');
            if(mod.completed&&mod.totalAttempts>1&&passed)addBadge('reviewer');
        }

        if(score===6)addBadge('almost-there');
        if(score===0)addBadge('zero-hero');
        if(score>=2&&score<=3)addBadge('generous-guesser');
        if(timeSpent<30&&!passed)addBadge('speed-fail');
        if(timeSpent>600&&!passed)addBadge('slow-and-wrong');

        const totalAttempts=Object.values(progress.modules).reduce((sum,m)=>sum+(m.totalAttempts||0),0);
        if(totalAttempts>=50&&completed<18)addBadge('eternal-student');
        const startedNotCompleted=Object.values(progress.modules).filter(m=>m.totalAttempts>0&&!m.completed).length;
        if(startedNotCompleted>=5&&completed===0)addBadge('wanderer');

        if(progress.lastActivityDate){
            const lastActivity=new Date(progress.lastActivityDate);
            const daysSince=(now-lastActivity)/(1000*60*60*24);
            if(daysSince>=7)addBadge('procrastinator');
        }
        progress.lastActivityDate=nowStr;

        const checkCat=(cat,badgeId)=>{const mods=categoryModules[cat]||[];if(mods.length>0&&mods.every(id=>progress.modules[id]?.completed))addBadge(badgeId)};
        checkCat('cardio','heart-expert');
        checkCat('critical','critical-master');
        checkCat('neuro','neuro-ninja');
        checkCat('pulm','pulm-pro');
        checkCat('core','ebm-foundation');
        const jamaComplete=Object.keys(progress.modules).filter(k=>k.startsWith('jama-')&&progress.modules[k]?.completed).length;
        if(jamaComplete>=12)addBadge('jama-collector');

        if(badges.length>=10)addBadge('achievement-hunter');
        if(badges.length>=39)addBadge('completionist');

        progress.badges=badges;
    }
};

// Badge notification toast component
function showBadgeToast(badges) {
    if (!badges || badges.length === 0) return;

    // Remove existing toast container if any
    const existingToast = document.getElementById('badge-toast-container');
    if (existingToast) existingToast.remove();

    const container = document.createElement('div');
    container.id = 'badge-toast-container';
    container.style.cssText = 'position:fixed;top:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:10px';

    badges.forEach((badgeId, i) => {
        const badge = badgeDefs[badgeId];
        if (!badge) return;

        const toast = document.createElement('div');
        toast.id = `badge-toast-${badgeId}`;
        toast.style.cssText = 'background:linear-gradient(135deg, #FFD700, #FFA500);padding:16px 20px;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.2);display:flex;align-items:center;gap:12px;animation:slideIn 0.5s ease-out;min-width:240px';
        toast.innerHTML = `
            <span style="font-size:36px">${badge.icon}</span>
            <div style="flex:1">
                <div style="font-size:12px;font-weight:600;color:#5D4037">æ–°æˆå°±è§£é–!</div>
                <div style="font-size:16px;font-weight:700;color:#3E2723">${badge.name}</div>
            </div>
            <button onclick="closeBadgeToast('${badgeId}')" style="background:rgba(0,0,0,0.1);border:none;border-radius:8px;width:28px;height:28px;cursor:pointer;font-size:14px">âœ•</button>
        `;
        container.appendChild(toast);
    });

    // Add animation style if not exists
    if (!document.getElementById('badge-toast-style')) {
        const style = document.createElement('style');
        style.id = 'badge-toast-style';
        style.textContent = '@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}';
        document.head.appendChild(style);
    }

    document.body.appendChild(container);

    // Auto-hide after 5 seconds
    setTimeout(() => {
        const toastContainer = document.getElementById('badge-toast-container');
        if (toastContainer) toastContainer.remove();
    }, 5000);
}

function closeBadgeToast(badgeId) {
    const toast = document.getElementById(`badge-toast-${badgeId}`);
    if (toast) toast.remove();
    const container = document.getElementById('badge-toast-container');
    if (container && container.children.length === 0) container.remove();
}

let currentLesson = 1;
let currentQ = 0;
let score = 0;
let answered = false;
let quizStartTime = null;

function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    window.scrollTo(0, 0);
}

function showHome() { showPage('home'); }

function showLesson(id) {
    currentLesson = id;
    const l = lessons[id-1];
    document.getElementById('lesson-title').textContent = l.title;
    document.getElementById('lesson-header').style.background = `linear-gradient(135deg,${l.color},${l.color}88)`;
    document.getElementById('lesson-header').innerHTML = `<div class="container"><div style="font-size:12px;opacity:0.9">Lesson ${l.id} â€¢ ${l.sub}</div><h1 style="font-size:22px;font-weight:700">${l.title}</h1></div>`;
    document.getElementById('lesson-body').innerHTML = lessonContent[id];
    document.getElementById('prev-btn').style.display = id > 1 ? 'block' : 'none';
    document.getElementById('next-btn').textContent = id < 5 ? 'ä¸‹ä¸€èª² â†’' : 'é–‹å§‹æ¸¬é©— ğŸ“';
    document.getElementById('next-btn').onclick = id < 5 ? nextLesson : startQuiz;
    showPage('lesson');
}

function prevLesson() { if (currentLesson > 1) showLesson(currentLesson - 1); }
function nextLesson() { if (currentLesson < 5) showLesson(currentLesson + 1); }

function startQuiz() {
    currentQ = 0; score = 0; answered = false;
    quizStartTime = Date.now();
    renderQuestion();
    showPage('quiz');
}

function renderQuestion() {
    const q = quiz[currentQ];
    document.getElementById('quiz-progress').textContent = `${currentQ+1}/${quiz.length}`;
    document.getElementById('quiz-progress-bar').style.width = `${((currentQ+1)/quiz.length)*100}%`;
    
    let html = `<h3 style="font-size:15px;font-weight:600;line-height:1.7;margin-bottom:20px">${q.q}</h3>`;
    q.o.forEach((opt, i) => {
        html += `<button class="quiz-option" onclick="selectAnswer(${i})" id="opt${i}">
            <span class="option-label" id="lbl${i}">${String.fromCharCode(65+i)}</span>
            <span style="line-height:1.5">${opt}</span>
        </button>`;
    });
    document.getElementById('quiz-content').innerHTML = html;
    document.getElementById('quiz-feedback').innerHTML = '';
    document.getElementById('quiz-next').style.display = 'none';
    answered = false;
}

function selectAnswer(i) {
    if (answered) return;
    answered = true;
    const q = quiz[currentQ];
    
    document.querySelectorAll('.quiz-option').forEach((btn, idx) => {
        btn.classList.add('disabled');
        if (idx === q.c) {
            btn.classList.add('correct');
            document.getElementById('lbl'+idx).classList.add('correct');
            document.getElementById('lbl'+idx).textContent = 'âœ”';
        } else if (idx === i && i !== q.c) {
            btn.classList.add('wrong');
            document.getElementById('lbl'+idx).classList.add('wrong');
            document.getElementById('lbl'+idx).textContent = 'âœ—';
        }
    });
    
    if (i === q.c) score++;
    
    const feedbackClass = i === q.c ? 'good' : 'tip';
    const feedbackTitle = i === q.c ? 'âœ” æ­£ç¢ºï¼' : 'âœ— ç­”éŒ¯äº†';
    const feedbackColor = i === q.c ? 'var(--suc)' : 'var(--acc)';
    document.getElementById('quiz-feedback').innerHTML = `<div class="${feedbackClass}"><strong style="color:${feedbackColor}">${feedbackTitle}</strong><p style="font-size:13px;color:var(--txt2);margin-top:8px;line-height:1.7">${q.e}</p></div>`;
    
    document.getElementById('quiz-next').style.display = 'block';
    document.getElementById('quiz-next').textContent = currentQ < quiz.length - 1 ? 'ä¸‹ä¸€é¡Œ â†’' : 'æŸ¥çœ‹çµæœ';
}

function nextQuestion() {
    if (currentQ < quiz.length - 1) {
        currentQ++;
        renderQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    const pct = Math.round((score / quiz.length) * 100);
    const color = pct >= 80 ? 'var(--suc)' : pct >= 60 ? 'var(--warn)' : 'var(--err)';
    document.getElementById('result-circle').style.background = `conic-gradient(${color} ${pct*3.6}deg, #E5E5E5 0deg)`;
    document.getElementById('result-pct').textContent = pct + '%';
    document.getElementById('result-score').textContent = `${score}/${quiz.length}`;
    document.getElementById('result-title').textContent = pct >= 80 ? 'ğŸ‰ å¤ªæ£’äº†ï¼' : pct >= 60 ? 'ğŸ‘ ä¸éŒ¯ï¼' : 'ğŸ’ª åŠ æ²¹ï¼';
    document.getElementById('result-msg').textContent = pct >= 80 ? 'ä½ å·²ç¶“æŒæ¡å›°é›£æ’ç®¡é æ¸¬ï¼' : pct >= 60 ? 'å†è¤‡ç¿’å¯ä»¥æ›´é€²æ­¥ï¼' : 'å»ºè­°é‡æ–°é–±è®€èª²ç¨‹';

    // Save progress
    if (quizStartTime) {
        const timeSpent = Math.round((Date.now() - quizStartTime) / 1000);
        ProgressTracker.saveQuizResult(MODULE_ID, score, quiz.length, timeSpent);
        if (ProgressTracker.newBadges.length > 0) {
            showBadgeToast(ProgressTracker.newBadges);
        }
    }

    showPage('result');
}
</script>
</body>
</html>
