<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æšˆå¥çš„è‡¨åºŠè¨ºæ–· | JAMA Rational Clinical Examination</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&family=Crimson+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --pri: #E63946;
            --pri2: #F4A261;
            --sec: #457B9D;
            --sec2: #1D3557;
            --suc: #2A9D8F;
            --warn: #E9C46A;
            --info: #264653;
            --bg: #FEFAF6;
            --txt: #1D3557;
            --txt2: #6B7280;
            --card-shadow: 0 4px 20px rgba(230, 57, 70, 0.08);
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg);
            color: var(--txt);
            line-height: 1.8;
            -webkit-font-smoothing: antialiased;
        }
        .card {
            background: #fff;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(230, 57, 70, 0.08);
        }
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .btn-pri { background: linear-gradient(135deg, var(--pri), var(--pri2)); color: #fff; }
        .btn-pri:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(230, 57, 70, 0.3); }
        .btn-sec { background: linear-gradient(135deg, var(--sec), var(--sec2)); color: #fff; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; margin: 12px 0; }
        th, td { padding: 12px 10px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: linear-gradient(135deg, #FEF3E9, #FDE8E0); font-weight: 600; color: var(--pri); }
        .formula {
            background: linear-gradient(135deg, #FEF3E9, #FDE8E0);
            border: 2px solid var(--pri2);
            border-radius: 16px;
            padding: 18px;
            margin: 14px 0;
            text-align: center;
            font-family: 'Crimson Pro', serif;
            font-size: 18px;
            color: var(--sec2);
            font-weight: 600;
        }
        .tip {
            background: linear-gradient(135deg, #FFF9E6, #FEF3CD);
            border-left: 4px solid var(--warn);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .good {
            background: linear-gradient(135deg, #E8F5F3, #D1F2EB);
            border-left: 4px solid var(--suc);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .danger {
            background: linear-gradient(135deg, #FDECEA, #FBDBD7);
            border-left: 4px solid var(--pri);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .info {
            background: linear-gradient(135deg, #EBF4F8, #D6E8F0);
            border-left: 4px solid var(--sec);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .pulse { animation: pulse 2s infinite; }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect } = React;

const MODULE_ID='jama-syncope';

// Badge definitions for notifications
const badgeDefs = {
    'first-quiz': { name: 'åˆè©¦å•¼è²', icon: 'ğŸ¯' },
    'perfect-score': { name: 'æ»¿åˆ†é”äºº', icon: 'ğŸ’¯' },
    'five-complete': { name: 'å°æœ‰æˆå°±', icon: 'â­' },
    'ten-complete': { name: 'å­¸æœ‰å°ˆç²¾', icon: 'ğŸŒŸ' },
    'master': { name: 'EBMå¤§å¸«', icon: 'ğŸ‘‘' },
    'speed-demon': { name: 'ç¥é€Ÿç­”é¡Œ', icon: 'âš¡' },
    'persistent': { name: 'å …æŒä¸æ‡ˆ', icon: 'ğŸ’ª' },
    'three-streak': { name: 'é€£å‹ä¸‰å ´', icon: 'ğŸ”¥' },
    'five-streak': { name: 'äº”é€£å‹', icon: 'ğŸ†' },
    'triple-perfect': { name: 'ä¸‰å† ç‹', icon: 'ğŸ‘‘' },
    'early-bird': { name: 'æ—©èµ·çš„é³¥', icon: 'ğŸ¦' },
    'night-owl': { name: 'å¤œè²“å­', icon: 'ğŸ¦‰' },
    'weekend-warrior': { name: 'å‡æ—¥æˆ°å£«', icon: 'ğŸ“…' },
    'comeback-kid': { name: 'é€†è½‰å‹', icon: 'ğŸš€' },
    'quick-learner': { name: 'ä¸€é»å°±é€š', icon: 'ğŸ’¡' },
    'improvement-king': { name: 'é€²æ­¥ç‹', icon: 'ğŸ“ˆ' },
    'marathon-runner': { name: 'é¦¬æ‹‰æ¾å­¸ç¿’è€…', icon: 'ğŸƒ' },
    'reviewer': { name: 'æº«æ•…çŸ¥æ–°', icon: 'ğŸ“–' },
    'almost-there': { name: 'å·®ä¸€é»é»', icon: 'ğŸ˜…' },
    'generous-guesser': { name: 'ä½›ç³»ç­”é¡Œ', icon: 'ğŸ™' },
    'learning-worm': { name: 'å­¸è¡“èš¯èš“', icon: 'ğŸª±' },
    'eternal-student': { name: 'æ°¸æ†çš„å­¸ç”Ÿ', icon: 'â™¾ï¸' },
    'speed-fail': { name: 'å…‰é€Ÿé™£äº¡', icon: 'ğŸ’«' },
    'slow-and-wrong': { name: 'æƒ³å¾ˆä¹…é‚„æ˜¯éŒ¯', icon: 'ğŸ¤”' },
    'zero-hero': { name: 'é›¶åˆ†è‹±é›„', icon: 'ğŸ’€' },
    'procrastinator': { name: 'æœ€å¾Œä¸€ç§’', icon: 'â°' },
    'deja-vu': { name: 'æ—¢è¦–æ„Ÿ', icon: 'ğŸ‘€' },
    'coffee-needed': { name: 'éœ€è¦å’–å•¡', icon: 'â˜•' },
    'wanderer': { name: 'æ¼«éŠè€…', icon: 'ğŸ§­' },
    'consistent-output': { name: 'ç©©å®šè¼¸å‡º', icon: 'ğŸ¯' },
    'heart-expert': { name: 'å¿ƒè‡Ÿé”äºº', icon: 'â¤ï¸' },
    'critical-master': { name: 'æ€¥é‡ç—‡å°ˆå®¶', icon: 'ğŸš¨' },
    'neuro-ninja': { name: 'ç¥ç¶“å¿è€…', icon: 'ğŸ§ ' },
    'pulm-pro': { name: 'èƒ¸è…”é«˜æ‰‹', icon: 'ğŸ«' },
    'ebm-foundation': { name: 'EBMåŸºçŸ³', icon: 'ğŸ›ï¸' },
    'jama-collector': { name: 'JAMAæ”¶è—å®¶', icon: 'ğŸ“š' },
    'achievement-hunter': { name: 'æˆå°±çµäºº', icon: 'ğŸ…' },
    'lucky-seven': { name: 'å¹¸é‹ä¸ƒ', icon: 'ğŸ€' },
    'completionist': { name: 'å…¨æˆå°±é”æˆ', icon: 'ğŸ–ï¸' }
};

const categoryModules = {
    cardio: ['jama-chest-pain-acs', 'jama-syncope', 'jama-hypertension'],
    critical: ['jama-bacteremia', 'jama-gi-bleed', 'jama-fluid-responsiveness', 'jama-difficult-intubation', 'jama-cirrhosis', 'jama-wound-infection'],
    neuro: ['jama-head-trauma', 'jama-delirium', 'jama-decision-capacity'],
    pulm: ['jama-pleural-effusion', 'jama-osa'],
    core: ['critical-appraisal', 'diagnostic-study', 'prognosis-study', 'rct-appraisal', 'systematic-review', 'literature-search']
};

const ProgressTracker={
    STORAGE_KEY:'ebm-progress',
    newBadges: [],
    getProgress:()=>{try{const d=localStorage.getItem(ProgressTracker.STORAGE_KEY);return d?JSON.parse(d):{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}catch{return{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}},
    saveQuizResult:(moduleId,score,total,timeSpent)=>{
        ProgressTracker.newBadges = [];
        const progress=ProgressTracker.getProgress();
        const mod=progress.modules[moduleId]||{bestScore:0,totalAttempts:0,allAttempts:[],lessonsViewed:[],completed:false,firstCompleted:null};
        const attempt={date:new Date().toISOString(),score,timeSpent};
        mod.allAttempts.push(attempt);mod.totalAttempts++;
        if(score>mod.bestScore)mod.bestScore=score;
        const passingScore=Math.ceil(total*0.7);
        if(score>=passingScore&&!mod.completed){mod.completed=true;mod.firstCompleted=attempt.date}
        progress.modules[moduleId]=mod;progress.totalTimeSpent+=timeSpent;progress.lastUpdated=new Date().toISOString();
        ProgressTracker.checkBadges(progress,moduleId,score,total,timeSpent);
        localStorage.setItem(ProgressTracker.STORAGE_KEY,JSON.stringify(progress));return progress;
    },
    checkBadges:(progress,moduleId,score,total,timeSpent)=>{
        const badges=progress.badges||[];const ids=badges.map(b=>b.id);const now=new Date();const nowStr=now.toISOString();
        const hour=now.getHours();const day=now.getDay();
        const passed=score>=Math.ceil(total*0.7);const perfect=score===total;
        const addBadge=(id)=>{if(!ids.includes(id)){badges.push({id,earnedAt:nowStr});ids.push(id);ProgressTracker.newBadges.push(id);return true}return false};

        addBadge('first-quiz');
        if(perfect)addBadge('perfect-score');
        if(timeSpent<120&&passed)addBadge('speed-demon');
        const completed=Object.values(progress.modules).filter(m=>m.completed).length;
        if(completed>=5)addBadge('five-complete');
        if(completed>=10)addBadge('ten-complete');
        if(completed>=18)addBadge('master');
        const mod=progress.modules[moduleId];
        if(mod&&mod.totalAttempts>=3)addBadge('persistent');

        if(hour<6)addBadge('early-bird');
        if(hour>=0&&hour<5)addBadge('night-owl');
        if(day===0||day===6)addBadge('weekend-warrior');
        if(hour>=2&&hour<5&&!passed)addBadge('coffee-needed');

        const streakData=progress.streakData||{currentPassStreak:0,currentPerfectStreak:0};
        if(passed){streakData.currentPassStreak++;if(perfect)streakData.currentPerfectStreak++;else streakData.currentPerfectStreak=0}
        else{streakData.currentPassStreak=0;streakData.currentPerfectStreak=0}
        if(streakData.currentPassStreak>=3)addBadge('three-streak');
        if(streakData.currentPassStreak>=5)addBadge('five-streak');
        if(streakData.currentPerfectStreak>=3)addBadge('triple-perfect');
        progress.streakData=streakData;

        if(mod){
            if(mod.totalAttempts===1&&perfect)addBadge('quick-learner');
            if(mod.totalAttempts===1&&score===7)addBadge('lucky-seven');
            if(mod.allAttempts&&mod.allAttempts.length>1){
                const firstScore=mod.allAttempts[0].score;
                if(firstScore<7&&perfect)addBadge('comeback-kid');
                if(score-firstScore>=5)addBadge('improvement-king');
                const lastThree=mod.allAttempts.slice(-3);
                if(lastThree.length===3&&lastThree[0].score===lastThree[1].score&&lastThree[1].score===lastThree[2].score)addBadge('deja-vu');
                if(lastThree.length===3&&lastThree.every(a=>a.score===score))addBadge('consistent-output');
            }
            if(mod.totalAttempts>=10)addBadge('learning-worm');
            if(mod.completed&&mod.totalAttempts>1&&passed)addBadge('reviewer');
        }

        if(score===6)addBadge('almost-there');
        if(score===0)addBadge('zero-hero');
        if(score>=2&&score<=3)addBadge('generous-guesser');
        if(timeSpent<30&&!passed)addBadge('speed-fail');
        if(timeSpent>600&&!passed)addBadge('slow-and-wrong');

        const totalAttempts=Object.values(progress.modules).reduce((sum,m)=>sum+(m.totalAttempts||0),0);
        if(totalAttempts>=50&&completed<18)addBadge('eternal-student');
        const startedNotCompleted=Object.values(progress.modules).filter(m=>m.totalAttempts>0&&!m.completed).length;
        if(startedNotCompleted>=5&&completed===0)addBadge('wanderer');

        if(progress.lastActivityDate){
            const lastActivity=new Date(progress.lastActivityDate);
            const daysSince=(now-lastActivity)/(1000*60*60*24);
            if(daysSince>=7)addBadge('procrastinator');
        }
        progress.lastActivityDate=nowStr;

        const checkCat=(cat,badgeId)=>{const mods=categoryModules[cat]||[];if(mods.length>0&&mods.every(id=>progress.modules[id]?.completed))addBadge(badgeId)};
        checkCat('cardio','heart-expert');
        checkCat('critical','critical-master');
        checkCat('neuro','neuro-ninja');
        checkCat('pulm','pulm-pro');
        checkCat('core','ebm-foundation');
        const jamaComplete=Object.keys(progress.modules).filter(k=>k.startsWith('jama-')&&progress.modules[k]?.completed).length;
        if(jamaComplete>=12)addBadge('jama-collector');

        if(badges.length>=10)addBadge('achievement-hunter');
        if(badges.length>=39)addBadge('completionist');

        progress.badges=badges;
    }
};

const lessons = [
    { id: 1, title: 'æšˆå¥æ¦‚è«–èˆ‡ç—…å› åˆ†é¡', sub: 'Syncope Overview', color: '#E63946' },
    { id: 2, title: 'å¿ƒå› æ€§æšˆå¥çš„è‡¨åºŠç‰¹å¾µ', sub: 'Cardiac Syncope Features', color: '#457B9D' },
    { id: 3, title: 'è‡¨åºŠç—…å²èˆ‡ç†å­¸æª¢æŸ¥', sub: 'History & Physical Exam', color: '#2A9D8F' },
    { id: 4, title: 'EGSYSè©•åˆ†ç³»çµ±', sub: 'EGSYS Score', color: '#F4A261' },
    { id: 5, title: 'æšˆå¥ vs ç™²ç™‡çš„é‘‘åˆ¥', sub: 'Syncope vs Seizure', color: '#E9C46A' }
];

const quiz = [
    {
        q: 'æ ¹æ“šJAMAç³»çµ±æ€§å›é¡§ï¼Œä¸‹åˆ—å“ªå€‹ç—…å²ç‰¹å¾µèˆ‡å¿ƒå› æ€§æšˆå¥æœ€ç›¸é—œï¼Ÿ',
        o: ['ç™¼ä½œå‰æ„Ÿè¦ºæº«æš–', 'ç™¼ä½œå‰é ­ç—›', 'ç™¼ä½œæ™‚ç›®æ“Šè€…è§€å¯Ÿåˆ°ç™¼ç´º', 'ç™¼ä½œå¾Œæƒ…ç·’æ”¹è®Š'],
        c: 2,
        e: 'ç›®æ“Šè€…è§€å¯Ÿåˆ°ç™¼ç´º (cyanosis) èˆ‡å¿ƒå› æ€§æšˆå¥é«˜åº¦ç›¸é—œï¼ŒLR+ = 6.2ã€‚é€™æ˜¯å› ç‚ºå¿ƒå› æ€§æšˆå¥æœƒå°è‡´å¿ƒè¼¸å‡ºé‡æ€¥é½ä¸‹é™ï¼Œé€ æˆçµ„ç¹”çŒæµä¸è¶³è€Œç™¼ç´ºã€‚'
    },
    {
        q: 'ä¸‹åˆ—å“ªå€‹ç‰¹å¾µå¯ä»¥æœ‰æ•ˆã€Œæ’é™¤ã€å¿ƒå› æ€§æšˆå¥ï¼Ÿ',
        o: ['å¹´é½¡ â‰¥ 35æ­²', 'ç™¼ä½œå‰æƒ…ç·’æ”¹è®Šæˆ–å°ˆæ³¨æ–¼ç´°ç¯€', 'ç™¼ä½œå‰å¿ƒæ‚¸', 'æœ‰å¿ƒæˆ¿é¡«å‹•ç—…å²'],
        c: 1,
        e: 'ç™¼ä½œå‰æƒ…ç·’æ”¹è®Šæˆ–å°ˆæ³¨æ–¼ç´°ç¯€ (mood change/prodromal preoccupation) çš„ LR- = 0.09ï¼Œæ˜¯æ’é™¤å¿ƒå› æ€§æšˆå¥çš„å¼·åŠ›æŒ‡æ¨™ï¼Œæç¤ºåå°„æ€§æšˆå¥å¯èƒ½æ€§é«˜ã€‚'
    },
    {
        q: 'é—œæ–¼å¿ƒå› æ€§æšˆå¥çš„äººå£å­¸ç‰¹å¾µï¼Œä½•è€…æ­£ç¢ºï¼Ÿ',
        o: ['å¹´é½¡ < 35æ­²ç™¼ä½œè€…å¿ƒå› æ€§é¢¨éšªé«˜', 'å¹´é½¡ â‰¥ 35æ­²é¦–æ¬¡ç™¼ä½œï¼ŒLR+ = 3.3', 'æ€§åˆ¥å°è¨ºæ–·ç„¡å½±éŸ¿', 'å¹´è¼•äººæ›´å¸¸æœ‰å¿ƒå¾‹ä¸æ•´'],
        c: 1,
        e: 'å¹´é½¡ â‰¥ 35æ­²é¦–æ¬¡ç™¼ä½œæšˆå¥èˆ‡å¿ƒå› æ€§æšˆå¥ç›¸é—œ (LR+ = 3.3)ï¼Œè€Œå¹´é½¡ < 35æ­²å‰‡å¯æ’é™¤ (LR- = 0.13)ã€‚'
    },
    {
        q: 'EGSYSè©•åˆ†ç³»çµ±ä¸­ï¼Œä¸‹åˆ—å“ªå€‹ç‰¹å¾µå¾—åˆ†æœ€é«˜ï¼Ÿ',
        o: ['å¿ƒæ‚¸ (+4åˆ†)', 'é‹å‹•ä¸­ç™¼ä½œ (+3åˆ†)', 'å¹³èººæ™‚ç™¼ä½œ (+2åˆ†)', 'ç¥ç¶“è‡ªä¸»ç—‡ç‹€ (-1åˆ†)'],
        c: 0,
        e: 'EGSYSè©•åˆ†ä¸­ï¼Œå¿ƒæ‚¸ (palpitations) å¾—4åˆ†æ˜¯æœ€é«˜åˆ†é …ç›®ã€‚é‹å‹•ä¸­ç™¼ä½œå’Œç•°å¸¸å¿ƒé›»åœ–/å¿ƒè‡Ÿç–¾ç—…å„å¾—3åˆ†ã€‚'
    },
    {
        q: 'EGSYSè©•åˆ† < 3 åˆ†æ™‚ï¼Œå°æ–¼å¿ƒå› æ€§æšˆå¥çš„è¨ºæ–·æ„ç¾©ç‚ºä½•ï¼Ÿ',
        o: ['å¯ç¢ºèªå¿ƒå› æ€§æšˆå¥', 'LR- ç´„ 0.12-0.17ï¼Œå¯æ’é™¤å¿ƒå› æ€§æšˆå¥', 'éœ€è¦é€²ä¸€æ­¥ä¾µå…¥æ€§æª¢æŸ¥', 'ç„¡è¨ºæ–·åƒ¹å€¼'],
        c: 1,
        e: 'EGSYS < 3 çš„ LR- ç¯„åœç‚º 0.12-0.17ï¼Œè¡¨ç¤ºå¯æœ‰æ•ˆé™ä½å¿ƒå› æ€§æšˆå¥çš„å¯èƒ½æ€§ï¼Œæ˜¯è‰¯å¥½çš„æ’é™¤å·¥å…·ã€‚'
    },
    {
        q: 'ä¸‹åˆ—å“ªå€‹ç™¼ä½œå‰ç—‡ç‹€èˆ‡å¿ƒå› æ€§æšˆå¥ç›¸é—œæ€§æœ€å¼·ï¼Ÿ',
        o: ['å‘¼å¸å›°é›£', 'å†’æ±—', 'å™å¿ƒ', 'é ­æšˆ'],
        c: 0,
        e: 'ç™¼ä½œå‰å‘¼å¸å›°é›£ (dyspnea) çš„ LR+ = 3.5ï¼Œæ˜¯èˆ‡å¿ƒå› æ€§æšˆå¥ç›¸é—œçš„é‡è¦ç—‡ç‹€ã€‚å†’æ±—ã€å™å¿ƒç­‰å‰‡èˆ‡åå°„æ€§æšˆå¥è¼ƒç›¸é—œã€‚'
    },
    {
        q: 'é—œæ–¼é‘‘åˆ¥æšˆå¥èˆ‡ç™²ç™‡ï¼Œä¸‹åˆ—ä½•è€…æœ€æ”¯æŒç™²ç™‡è¨ºæ–·ï¼Ÿ',
        o: ['ç™¼ä½œæ™‚å››è‚¢æŠ½å‹•', 'ç™¼ä½œå‰å¿ƒæ‚¸', 'ä¹…ç«™å¾Œç™¼ä½œ', 'å’¬å‚·èˆŒé ­'],
        c: 3,
        e: 'å’¬å‚·èˆŒé ­ (cut tongue) å°ç™²ç™‡çš„ LR+ = 17ï¼Œæ˜¯æœ€å¼·çš„é‘‘åˆ¥æŒ‡æ¨™ã€‚å››è‚¢æŠ½å‹•é›–ä¹Ÿæ”¯æŒç™²ç™‡(LR+ = 5.6)ï¼Œä½†æšˆå¥ä¹Ÿå¯èƒ½æœ‰çŸ­æš«æŠ½å‹•ã€‚'
    },
    {
        q: 'ä¸‹åˆ—å“ªå€‹è‡¨åºŠç‰¹å¾µæ”¯æŒåå°„æ€§æšˆå¥è€Œéå¿ƒå› æ€§æšˆå¥ï¼Ÿ',
        o: ['é‹å‹•ä¸­ç™¼ä½œ', 'å¹³èººæ™‚ç™¼ä½œ', 'ä¹…ç«™å¾Œç™¼ä½œ', 'ç™¼ä½œæ™‚ç™¼ç´º'],
        c: 2,
        e: 'ä¹…ç«™å¾Œç™¼ä½œ (prolonged sitting/standing) æ˜¯å…¸å‹çš„è¡€ç®¡è¿·èµ°æ€§æšˆå¥ç‰¹å¾µï¼ŒLR for cardiac syncope = 0.54ï¼Œå¯é™ä½å¿ƒå› æ€§æšˆå¥å¯èƒ½æ€§ã€‚'
    },
    {
        q: 'å¿ƒå› æ€§æšˆå¥æ‚£è€…çš„ç”Ÿç‰©æ¨™è¨˜ï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…æ­£ç¢ºï¼Ÿ',
        o: ['Troponinå°æ’é™¤å¿ƒå› æ€§æšˆå¥ç„¡å¹«åŠ©', 'NT-proBNP < 69 pg/mLå¯æ’é™¤å¿ƒå› æ€§æšˆå¥', 'BNP > 100 pg/mLå¯ç¢ºè¨ºå¿ƒå› æ€§æšˆå¥', 'ç”Ÿç‰©æ¨™è¨˜å„ªæ–¼è‡¨åºŠè©•ä¼°'],
        c: 1,
        e: 'NT-proBNP < 69 pg/mL çš„ LR- = 0.16ï¼Œå¯æœ‰æ•ˆæ’é™¤å¿ƒå› æ€§æšˆå¥ã€‚ä½†ç”Ÿç‰©æ¨™è¨˜æ‡‰çµåˆè‡¨åºŠè©•ä¼°ä½¿ç”¨ï¼Œç´„65%æ‚£è€…çµæœåœ¨ä¸­é–“å€¼ã€‚'
    },
    {
        q: 'ä¸‹åˆ—é—œæ–¼æšˆå¥çš„æµè¡Œç—…å­¸ï¼Œä½•è€…æ­£ç¢ºï¼Ÿ',
        o: ['æˆäººæšˆå¥å¹´ç™¼ç”Ÿç‡ç´„ 6%', 'å¿ƒå› æ€§æšˆå¥ä½”æ‰€æœ‰æšˆå¥ç´„ 50%', 'è¡€ç®¡è¿·èµ°æ€§æšˆå¥æ˜¯æœ€å¸¸è¦‹é¡å‹', 'æšˆå¥æ¯”ç™²ç™‡ç½•è¦‹'],
        c: 2,
        e: 'è¡€ç®¡è¿·èµ°æ€§æšˆå¥(vasovagal syncope)ä½”21-48%æ˜¯æœ€å¸¸è¦‹é¡å‹ã€‚å¿ƒå› æ€§æšˆå¥ç´„5-21%ï¼Œæˆäººæšˆå¥å¹´ç™¼ç”Ÿç‡ç´„0.6%ï¼Œæšˆå¥æ¯”ç™²ç™‡æ›´å¸¸è¦‹ã€‚'
    }
];

// Badge notification toast component
const BadgeToast = ({ badges, onClose }) => {
    if (!badges || badges.length === 0) return null;
    return (
        <div style={{position:'fixed',top:20,right:20,zIndex:9999,display:'flex',flexDirection:'column',gap:10}}>
            {badges.map((badgeId, i) => {
                const badge = badgeDefs[badgeId];
                if (!badge) return null;
                return (
                    <div key={badgeId} style={{
                        background:'linear-gradient(135deg, #FFD700, #FFA500)',
                        padding:'16px 20px',borderRadius:16,boxShadow:'0 8px 32px rgba(0,0,0,0.2)',
                        display:'flex',alignItems:'center',gap:12,animation:'slideIn 0.5s ease-out',minWidth:240
                    }}>
                        <span style={{fontSize:36}}>{badge.icon}</span>
                        <div style={{flex:1}}>
                            <div style={{fontSize:12,fontWeight:600,color:'#5D4037'}}>æ–°æˆå°±è§£é–!</div>
                            <div style={{fontSize:16,fontWeight:700,color:'#3E2723'}}>{badge.name}</div>
                        </div>
                        <button onClick={()=>onClose(badgeId)} style={{background:'rgba(0,0,0,0.1)',border:'none',borderRadius:8,width:28,height:28,cursor:'pointer',fontSize:14}}>âœ•</button>
                    </div>
                );
            })}
            <style>{`@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}`}</style>
        </div>
    );
};

const App = () => {
    const [page, setPage] = useState('home');
    const [lessonId, setLessonId] = useState(1);
    const [qIdx, setQIdx] = useState(0);
    const [score, setScore] = useState(0);
    const [sel, setSel] = useState(null);
    const [show, setShow] = useState(false);
    const [done, setDone] = useState(false);
    const [quizStartTime, setQuizStartTime] = useState(null);
    const [newBadges, setNewBadges] = useState([]);

    useEffect(() => { if (page === 'quiz' && !done && !quizStartTime) setQuizStartTime(Date.now()) }, [page, done]);
    useEffect(() => {
        if (done && quizStartTime) {
            const t = Math.round((Date.now() - quizStartTime) / 1000);
            ProgressTracker.saveQuizResult(MODULE_ID, score, quiz.length, t);
            if (ProgressTracker.newBadges.length > 0) {
                setNewBadges(ProgressTracker.newBadges);
                setTimeout(() => setNewBadges([]), 5000);
            }
        }
    }, [done]);

    const Header = ({ title }) => (
        <header style={{ 
            background: '#fff', 
            borderBottom: '1px solid rgba(230, 57, 70, 0.1)', 
            padding: '14px 16px', 
            position: 'sticky', 
            top: 0, 
            zIndex: 10,
            backdropFilter: 'blur(10px)'
        }}>
            <div style={{ maxWidth: 480, margin: '0 auto', display: 'flex', alignItems: 'center', gap: 12 }}>
                <button 
                    onClick={() => page === 'home' ? window.location.href = 'jama-rational-exam.html' : setPage('home')} 
                    style={{ 
                        background: 'linear-gradient(135deg, #FEF3E9, #FDE8E0)', 
                        border: 'none', 
                        borderRadius: 12, 
                        width: 42, 
                        height: 42, 
                        cursor: 'pointer', 
                        color: 'var(--pri)', 
                        display: 'flex', 
                        alignItems: 'center', 
                        justifyContent: 'center',
                        boxShadow: '0 2px 8px rgba(230, 57, 70, 0.1)'
                    }}
                >
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
                <span style={{ fontWeight: 700, color: 'var(--sec2)', fontSize: 16 }}>{title}</span>
            </div>
        </header>
    );

    const Home = () => (
        <div className="fade-in">
            <Header title="æšˆå¥çš„è‡¨åºŠè¨ºæ–·" />
            <div style={{ 
                background: 'linear-gradient(135deg, #E63946 0%, #F4A261 50%, #E9C46A 100%)', 
                padding: '36px 20px 44px', 
                color: '#fff',
                position: 'relative',
                overflow: 'hidden'
            }}>
                <div style={{
                    position: 'absolute',
                    top: -30,
                    right: -30,
                    width: 150,
                    height: 150,
                    borderRadius: '50%',
                    background: 'rgba(255,255,255,0.1)'
                }} />
                <div style={{ maxWidth: 480, margin: '0 auto', position: 'relative', zIndex: 1 }}>
                    <div style={{ 
                        background: 'rgba(255,255,255,0.2)', 
                        display: 'inline-block', 
                        padding: '8px 16px', 
                        borderRadius: 50, 
                        fontSize: 12, 
                        fontWeight: 600, 
                        marginBottom: 16,
                        backdropFilter: 'blur(10px)'
                    }}>
                        ğŸ«€ JAMA Rational Clinical Examination
                    </div>
                    <h1 style={{ fontSize: 28, fontWeight: 700, marginBottom: 12, lineHeight: 1.3 }}>
                        Did This Patient Have<br/>Cardiac Syncope?
                    </h1>
                    <p style={{ opacity: 0.95, fontSize: 14, lineHeight: 1.7 }}>
                        æšˆå¥çš„è‡¨åºŠè¨ºæ–· - å€åˆ†å¿ƒå› æ€§æšˆå¥èˆ‡å…¶ä»–åŸå› 
                    </p>
                    <p style={{ opacity: 0.8, fontSize: 12, marginTop: 8 }}>
                        Puppala VK, et al. JAMA. 2019;321(24):2448-2457
                    </p>
                    <a 
                        href="https://jamanetwork.com/journals/jama/fullarticle/2736568" 
                        target="_blank" 
                        rel="noopener noreferrer"
                        style={{
                            display:'inline-flex',
                            alignItems:'center',
                            gap:6,
                            background:'rgba(255,255,255,0.25)',
                            color:'#fff',
                            padding:'8px 16px',
                            borderRadius:25,
                            fontSize:13,
                            fontWeight:600,
                            textDecoration:'none',
                            backdropFilter:'blur(10px)',
                            marginTop: 12,
                            transition:'all 0.3s'
                        }}
                    >
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></svg>
                        é–±è®€åŸæ–‡ Read Full Article
                    </a>
                </div>
            </div>
            
            <div style={{ padding: '0 16px', marginTop: -24 }}>
                <div style={{ maxWidth: 480, margin: '0 auto' }}>
                    <div className="card">
                        <h3 style={{ fontSize: 17, fontWeight: 700, color: 'var(--pri)', marginBottom: 14, display: 'flex', alignItems: 'center', gap: 8 }}>
                            <span style={{ fontSize: 22 }}>ğŸ¯</span> å­¸ç¿’ç›®æ¨™
                        </h3>
                        {[
                            'äº†è§£æšˆå¥çš„ç—…å› åˆ†é¡èˆ‡ç”Ÿç†æ©Ÿè½‰',
                            'è­˜åˆ¥å¿ƒå› æ€§æšˆå¥çš„é«˜å±éšªç‰¹å¾µ',
                            'æ‡‰ç”¨EGSYSè©•åˆ†ç³»çµ±è©•ä¼°å¿ƒå› æ€§æšˆå¥é¢¨éšª',
                            'æŒæ¡æšˆå¥èˆ‡ç™²ç™‡çš„è‡¨åºŠé‘‘åˆ¥è¦é»'
                        ].map((t, i) => (
                            <div key={i} style={{ display: 'flex', gap: 12, marginBottom: 10, fontSize: 14 }}>
                                <span style={{ 
                                    background: 'linear-gradient(135deg, var(--suc), #20C997)', 
                                    color: '#fff', 
                                    borderRadius: 8, 
                                    width: 26, 
                                    height: 26, 
                                    display: 'flex', 
                                    alignItems: 'center', 
                                    justifyContent: 'center', 
                                    fontSize: 13, 
                                    flexShrink: 0,
                                    fontWeight: 600
                                }}>{i + 1}</span>
                                <span style={{ color: 'var(--txt2)', lineHeight: 1.6 }}>{t}</span>
                            </div>
                        ))}
                    </div>

                    <div className="danger" style={{ marginBottom: 20 }}>
                        <strong style={{ color: 'var(--pri)', display: 'flex', alignItems: 'center', gap: 6 }}>
                            âš ï¸ è‡¨åºŠé‡è¦æ€§
                        </strong>
                        <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                            å¿ƒå› æ€§æšˆå¥å¯èƒ½æºè‡ªå¿ƒå¾‹ä¸æ•´æˆ–çµæ§‹æ€§å¿ƒè‡Ÿç—…ï¼Œå…·æœ‰è¼ƒé«˜çš„æ­»äº¡é¢¨éšªã€‚æº–ç¢ºå€åˆ†å¿ƒå› æ€§èˆ‡éå¿ƒå› æ€§æšˆå¥å°æ–¼æ±ºå®šå¾ŒçºŒè™•ç½®è‡³é—œé‡è¦ã€‚
                        </p>
                    </div>

                    <h3 style={{ fontSize: 18, fontWeight: 700, marginBottom: 16, color: 'var(--sec2)' }}>ğŸ“š èª²ç¨‹å…§å®¹</h3>
                    {lessons.map(l => (
                        <div 
                            key={l.id} 
                            className="card" 
                            onClick={() => { setLessonId(l.id); setPage('lesson'); }} 
                            style={{ cursor: 'pointer', transition: 'all 0.3s ease' }}
                        >
                            <div style={{ display: 'flex', alignItems: 'center', gap: 16 }}>
                                <div style={{ 
                                    width: 52, 
                                    height: 52, 
                                    borderRadius: 14, 
                                    background: `linear-gradient(135deg, ${l.color}, ${l.color}99)`, 
                                    display: 'flex', 
                                    alignItems: 'center', 
                                    justifyContent: 'center', 
                                    color: '#fff', 
                                    fontWeight: 700,
                                    fontSize: 18,
                                    boxShadow: `0 4px 12px ${l.color}33`
                                }}>{l.id}</div>
                                <div style={{ flex: 1 }}>
                                    <div style={{ fontSize: 11, color: l.color, fontWeight: 600, marginBottom: 2 }}>Lesson {l.id}</div>
                                    <div style={{ fontSize: 16, fontWeight: 700, color: 'var(--txt)' }}>{l.title}</div>
                                    <div style={{ fontSize: 13, color: 'var(--txt2)' }}>{l.sub}</div>
                                </div>
                                <svg viewBox="0 0 24 24" fill={l.color} width="22" height="22">
                                    <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/>
                                </svg>
                            </div>
                        </div>
                    ))}
                    
                    <button 
                        className="btn btn-pri" 
                        onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); setPage('quiz'); }} 
                        style={{ width: '100%', justifyContent: 'center', marginTop: 24, marginBottom: 16, padding: '16px 24px' }}
                    >
                        ğŸ“ é–‹å§‹æ¸¬é©— (10é¡Œ)
                    </button>

                    <a 
                        href="https://jamanetwork.com/journals/jama/fullarticle/2736568"
                        target="_blank"
                        rel="noopener noreferrer"
                        style={{
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            gap: 8,
                            padding: '14px 20px',
                            background: 'linear-gradient(135deg, #F8F9FA, #E9ECEF)',
                            borderRadius: 14,
                            textDecoration: 'none',
                            color: 'var(--sec)',
                            fontSize: 14,
                            fontWeight: 600,
                            marginBottom: 32,
                            border: '1px solid rgba(69, 123, 157, 0.2)'
                        }}
                    >
                        ğŸ“„ é–±è®€åŸæ–‡ (JAMA 2019)
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                        </svg>
                    </a>
                </div>
            </div>
            
            <footer style={{ background: 'linear-gradient(135deg, #FEF3E9, #FDE8E0)', padding: '28px 16px', textAlign: 'center' }}>
                <p style={{ fontSize: 13, color: 'var(--txt2)', fontWeight: 600 }}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨</p>
                <p style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 4 }}>è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
            </footer>
        </div>
    );

    // Lesson 1: Overview
    const L1 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ«€ ä»€éº¼æ˜¯æšˆå¥ï¼Ÿ</h3>
                <div className="formula">
                    æšˆå¥ (Syncope) = è…¦éƒ¨çŒæµä¸è¶³ â†’ çŸ­æš«æ„è­˜å–ªå¤± + è‡ªç™¼æ€§æ¢å¾©
                </div>
                <p style={{ fontSize: 14, color: 'var(--txt2)', lineHeight: 1.8 }}>
                    æšˆå¥æ˜¯ç”±æ–¼å…¨è…¦è¡€æµçŒæ³¨æ¸›å°‘æ‰€å°è‡´çš„çŸ­æš«æ„è­˜å–ªå¤±ï¼Œç‰¹é»æ˜¯ç™¼ä½œçªç„¶ã€æŒçºŒæ™‚é–“çŸ­ã€ä¸”èƒ½è‡ªç™¼æ€§å®Œå…¨æ¢å¾©ã€‚
                </p>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ“Š æšˆå¥çš„ç—…å› åˆ†é¡</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é¡å‹</th>
                            <th>ç››è¡Œç‡</th>
                            <th>æ©Ÿè½‰</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--pri)' }}>å¿ƒå› æ€§æšˆå¥</td>
                            <td>5-21%</td>
                            <td>å¿ƒè¼¸å‡ºé‡æ€¥é½ä¸‹é™</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--suc)' }}>è¡€ç®¡è¿·èµ°æ€§æšˆå¥</td>
                            <td>21-48%</td>
                            <td>ä¸­æ¨ä»‹å°çš„åå°„</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--sec)' }}>å§¿æ…‹æ€§ä½è¡€å£“</td>
                            <td>4-24%</td>
                            <td>è‡ªä¸»ç¥ç¶“åŠŸèƒ½ç•°å¸¸</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600, color: '#6B7280' }}>åŸå› ä¸æ˜</td>
                            <td>17-37%</td>
                            <td>â€”</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="danger">
                <strong style={{ color: 'var(--pri)' }}>âš ï¸ å¿ƒå› æ€§æšˆå¥çš„å±éšªæ€§</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                    å¿ƒå› æ€§æšˆå¥å¯èƒ½ç”±ä»¥ä¸‹åŸå› å¼•èµ·ï¼š<br/>
                    â€¢ <strong>å¿ƒå¾‹ä¸æ•´</strong>ï¼šå¿ƒå®¤é »è„ˆã€å¿ƒæˆ¿é¡«å‹•ã€å‚³å°é˜»æ»¯<br/>
                    â€¢ <strong>çµæ§‹æ€§å¿ƒè‡Ÿç—…</strong>ï¼šä¸»å‹•è„ˆç‹¹çª„ã€è‚¥åšæ€§å¿ƒè‚Œç—…è®Š<br/>
                    â€¢ <strong>è‚ºæ “å¡</strong>ï¼šæ€¥æ€§å³å¿ƒè¡°ç«­
                </p>
            </div>

            <div className="good">
                <strong style={{ color: 'var(--suc)' }}>ğŸ’š åå°„æ€§æšˆå¥çš„æ©Ÿè½‰</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                    <strong>è§¸ç™¼å› ç´ ï¼š</strong>ä¹…ç«™ã€ç–¼ç—›ã€æƒ…ç·’åˆºæ¿€ã€é ¸å‹•è„ˆç«‡å£“è¿«<br/>
                    <strong>åå°„å¼§ï¼š</strong>è¿·èµ°ç¥ç¶“å¼µåŠ›â†‘ + äº¤æ„Ÿç¥ç¶“å¼µåŠ›â†“<br/>
                    <strong>çµæœï¼š</strong>å¿ƒç‡â†“ + è¡€ç®¡æ“´å¼µ â†’ è¡€å£“â†“ â†’ è…¦çŒæµä¸è¶³
                </p>
            </div>

            <div className="info">
                <strong style={{ color: 'var(--sec)' }}>ğŸ“ˆ æµè¡Œç—…å­¸</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                    â€¢ æˆäººæšˆå¥å¹´ç™¼ç”Ÿç‡ï¼šç´„ 0.6%<br/>
                    â€¢ è€å¹´äººå¹´ç™¼ç”Ÿç‡ï¼š2-6%<br/>
                    â€¢ æšˆå¥çµ‚ç”Ÿç››è¡Œç‡ï¼š18-47%<br/>
                    â€¢ æšˆå¥æ¯”ç™²ç™‡æ›´å¸¸è¦‹ï¼ˆç™²ç™‡å¹´ç™¼ç”Ÿç‡åƒ… 0.05%ï¼‰
                </p>
            </div>
        </div>
    );

    // Lesson 2: Cardiac Syncope Features
    const L2 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ” æé«˜å¿ƒå› æ€§æšˆå¥å¯èƒ½æ€§çš„ç‰¹å¾µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>è‡¨åºŠç‰¹å¾µ</th>
                            <th>LR+</th>
                            <th>è§£è®€</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FDECEA' }}>
                            <td>å¿ƒæˆ¿é¡«å‹•/æ’²å‹•ç—…å²</td>
                            <td style={{ color: 'var(--pri)', fontWeight: 700 }}>7.3</td>
                            <td>å¼·åŠ›æç¤º</td>
                        </tr>
                        <tr style={{ background: '#FDECEA' }}>
                            <td>ç™¼ä½œæ™‚ç™¼ç´º (cyanosis)</td>
                            <td style={{ color: 'var(--pri)', fontWeight: 700 }}>6.2</td>
                            <td>å¼·åŠ›æç¤º</td>
                        </tr>
                        <tr>
                            <td>åš´é‡çµæ§‹æ€§å¿ƒè‡Ÿç—…</td>
                            <td style={{ fontWeight: 600 }}>3.3-4.8</td>
                            <td>ä¸­åº¦æç¤º</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰å‘¼å¸å›°é›£</td>
                            <td style={{ fontWeight: 600 }}>3.5</td>
                            <td>ä¸­åº¦æç¤º</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰èƒ¸ç—›</td>
                            <td style={{ fontWeight: 600 }}>3.4-3.8</td>
                            <td>ä¸­åº¦æç¤º</td>
                        </tr>
                        <tr>
                            <td>â‰¥35æ­²é¦–æ¬¡ç™¼ä½œ</td>
                            <td style={{ fontWeight: 600 }}>3.3</td>
                            <td>ä¸­åº¦æç¤º</td>
                        </tr>
                        <tr>
                            <td>å¿ƒè¡°ç«­ç—…å²</td>
                            <td style={{ fontWeight: 600 }}>2.7-3.4</td>
                            <td>å¼±è‡³ä¸­åº¦</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--suc)', marginBottom: 14 }}>âœ… é™ä½å¿ƒå› æ€§æšˆå¥å¯èƒ½æ€§çš„ç‰¹å¾µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>è‡¨åºŠç‰¹å¾µ</th>
                            <th>LR-</th>
                            <th>æ’é™¤æ•ˆåŠ›</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td>ç™¼ä½œå‰æƒ…ç·’æ”¹è®Š/å°ˆæ³¨ç´°ç¯€</td>
                            <td style={{ color: 'var(--suc)', fontWeight: 700 }}>0.09</td>
                            <td>å¼·åŠ›æ’é™¤</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td>&lt;35æ­²é¦–æ¬¡ç™¼ä½œ</td>
                            <td style={{ color: 'var(--suc)', fontWeight: 700 }}>0.13</td>
                            <td>å¼·åŠ›æ’é™¤</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰æ„Ÿè¦ºå†·</td>
                            <td style={{ fontWeight: 600 }}>0.16</td>
                            <td>ä¸­åº¦æ’é™¤</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰é ­ç—›</td>
                            <td style={{ fontWeight: 600 }}>0.17</td>
                            <td>ä¸­åº¦æ’é™¤</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå¾Œæƒ…ç·’æ”¹è®Š</td>
                            <td style={{ fontWeight: 600 }}>0.21</td>
                            <td>ä¸­åº¦æ’é™¤</td>
                        </tr>
                        <tr>
                            <td>ç„¡æ³•å›æ†¶ç™¼ä½œå‰è¡Œç‚º</td>
                            <td style={{ fontWeight: 600 }}>0.25</td>
                            <td>å¼±è‡³ä¸­åº¦</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="tip">
                <strong style={{ color: '#B8860B' }}>ğŸ’¡ LRè§£è®€å£è¨£</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.8 }}>
                    â€¢ LR+ &gt; 10 æˆ– LR- &lt; 0.1ï¼š<strong>å¼·åŠ›</strong>æ”¹è®Šè¨ºæ–·æ©Ÿç‡<br/>
                    â€¢ LR+ 5-10 æˆ– LR- 0.1-0.2ï¼š<strong>ä¸­åº¦</strong>æ”¹è®Šè¨ºæ–·æ©Ÿç‡<br/>
                    â€¢ LR+ 2-5 æˆ– LR- 0.2-0.5ï¼š<strong>è¼•å¾®</strong>æ”¹è®Šè¨ºæ–·æ©Ÿç‡<br/>
                    â€¢ LR+ 1-2 æˆ– LR- 0.5-1ï¼šå¹¾ä¹ä¸æ”¹è®Šè¨ºæ–·æ©Ÿç‡
                </p>
            </div>
        </div>
    );

    // Lesson 3: History & Physical
    const L3 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--suc)', marginBottom: 14 }}>ğŸ“‹ ç—…å²è©¢å•é‡é»</h3>
                
                <div style={{ marginBottom: 16 }}>
                    <h4 style={{ fontSize: 15, fontWeight: 600, color: 'var(--pri)', marginBottom: 8 }}>ğŸ”´ ç™¼ä½œå‰ (Before)</h4>
                    <div style={{ background: '#F8F9FA', padding: 12, borderRadius: 10, fontSize: 14, lineHeight: 1.8 }}>
                        <strong>æƒ…å¢ƒå› ç´ ï¼š</strong><br/>
                        â€¢ å§¿å‹¢ï¼ˆç«™ç«‹ã€åè‘—ã€èººè‘—ï¼‰<br/>
                        â€¢ æ´»å‹•ï¼ˆä¼‘æ¯ã€é‹å‹•ä¸­ã€æ’å°¿å¾Œï¼‰<br/>
                        â€¢ èª˜ç™¼å› ç´ ï¼ˆæº«æš–ç’°å¢ƒã€ç–¼ç—›ã€æƒ…ç·’å£“åŠ›ï¼‰<br/><br/>
                        <strong>å‰é©…ç—‡ç‹€ï¼š</strong><br/>
                        â€¢ å¿ƒæ‚¸ã€èƒ¸ç—›ã€å‘¼å¸å›°é›£ â†’ å¿ƒå› æ€§<br/>
                        â€¢ å™å¿ƒã€å†’æ±—ã€æº«æš–æ„Ÿ â†’ åå°„æ€§
                    </div>
                </div>

                <div style={{ marginBottom: 16 }}>
                    <h4 style={{ fontSize: 15, fontWeight: 600, color: 'var(--sec)', marginBottom: 8 }}>ğŸ”µ ç™¼ä½œä¸­ (During)</h4>
                    <div style={{ background: '#F8F9FA', padding: 12, borderRadius: 10, fontSize: 14, lineHeight: 1.8 }}>
                        <strong>ç›®æ“Šè€…æè¿°éå¸¸é‡è¦ï¼š</strong><br/>
                        â€¢ ç™¼ç´º (cyanosis) â†’ å¿ƒå› æ€§<br/>
                        â€¢ æŠ½æå‹•ä½œï¼ˆçŸ­æš« &lt;15ç§’ï¼‰â†’ æšˆå¥ä¹Ÿå¯æœ‰<br/>
                        â€¢ æŒçºŒæ€§è‚¢é«”åƒµç›´æŠ½æ â†’ ç™²ç™‡
                    </div>
                </div>

                <div>
                    <h4 style={{ fontSize: 15, fontWeight: 600, color: 'var(--suc)', marginBottom: 8 }}>ğŸŸ¢ ç™¼ä½œå¾Œ (After)</h4>
                    <div style={{ background: '#F8F9FA', padding: 12, borderRadius: 10, fontSize: 14, lineHeight: 1.8 }}>
                        â€¢ å¿«é€Ÿæ¢å¾©æ¸…é†’ â†’ æšˆå¥<br/>
                        â€¢ æŒçºŒæ„è­˜æ··äº‚ï¼ˆpostictalï¼‰â†’ ç™²ç™‡<br/>
                        â€¢ æƒ…ç·’æ”¹è®Š â†’ åå°„æ€§æšˆå¥
                    </div>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ©º ç†å­¸æª¢æŸ¥é‡é»</h3>
                <table>
                    <thead>
                        <tr>
                            <th>æª¢æŸ¥é …ç›®</th>
                            <th>ç•°å¸¸ç™¼ç¾</th>
                            <th>å¯èƒ½è¨ºæ–·</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>å§¿æ…‹æ€§è¡€å£“</td>
                            <td>ç«™ç«‹å¾ŒSBPâ†“â‰¥20mmHg</td>
                            <td>å§¿æ…‹æ€§ä½è¡€å£“</td>
                        </tr>
                        <tr>
                            <td>å¿ƒè‡Ÿè½è¨º</td>
                            <td>æ”¶ç¸®æœŸé›œéŸ³</td>
                            <td>ä¸»å‹•è„ˆç‹¹çª„ã€HOCM</td>
                        </tr>
                        <tr>
                            <td>å¿ƒå¾‹</td>
                            <td>ä¸è¦å‰‡è„ˆæ</td>
                            <td>å¿ƒæˆ¿é¡«å‹•</td>
                        </tr>
                        <tr>
                            <td>èˆŒé ­æª¢æŸ¥</td>
                            <td>å’¬å‚·</td>
                            <td>ç™²ç™‡ï¼ˆLR+=17ï¼‰</td>
                        </tr>
                        <tr>
                            <td>é ¸å‹•è„ˆè½è¨º</td>
                            <td>é›œéŸ³</td>
                            <td>é ¸å‹•è„ˆç‹¹çª„</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="good">
                <strong style={{ color: 'var(--suc)' }}>ğŸ’¡ è‡¨åºŠè¦é»</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.8 }}>
                    <strong>ã€Œç„¡å¿ƒè‡Ÿç—…å² + æ­£å¸¸å¿ƒé›»åœ–ã€</strong> æ™‚å¿ƒå› æ€§æšˆå¥å¯èƒ½æ€§ä½<br/>
                    LR- = 0.20ï¼ˆå¯æœ‰æ•ˆé™ä½å¿ƒå› æ€§æšˆå¥æ©Ÿç‡ï¼‰
                </p>
            </div>

            <div className="info">
                <strong style={{ color: 'var(--sec)' }}>ğŸ“Š å¿ƒé›»åœ–ç•°å¸¸å®šç¾©</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                    â€¢ å¿ƒè·³ &lt; 40æ¬¡/åˆ†<br/>
                    â€¢ ç«‡æ€§åœæ­¢ &gt; 3ç§’<br/>
                    â€¢ QTé–“æœŸå»¶é•· â‰¥ 440ms<br/>
                    â€¢ äºŒåº¦æˆ–ä¸‰åº¦æˆ¿å®¤å‚³å°é˜»æ»¯<br/>
                    â€¢ æŸæ”¯å‚³å°é˜»æ»¯æˆ–STè®ŠåŒ–
                </p>
            </div>
        </div>
    );

    // Lesson 4: EGSYS Score
    const L4 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ“Š EGSYS è©•åˆ†ç³»çµ±</h3>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginBottom: 16, lineHeight: 1.7 }}>
                    EGSYS (Evaluation of Guidelines in Syncope Study) æ˜¯ä¸€å€‹ç¶“éé©—è­‰çš„å¤šè®Šé …è©•åˆ†å·¥å…·ï¼Œç”¨æ–¼è©•ä¼°å¿ƒå› æ€§æšˆå¥çš„å¯èƒ½æ€§ã€‚
                </p>
                
                <table>
                    <thead>
                        <tr>
                            <th style={{ width: '70%' }}>è‡¨åºŠè®Šé …</th>
                            <th style={{ textAlign: 'center' }}>åˆ†æ•¸</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>å¿ƒæ‚¸ (Palpitations)</td>
                            <td style={{ textAlign: 'center', color: 'var(--pri)', fontWeight: 700, fontSize: 16 }}>+4</td>
                        </tr>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>ç•°å¸¸å¿ƒé›»åœ– / å¿ƒè‡Ÿç–¾ç—…</td>
                            <td style={{ textAlign: 'center', color: 'var(--pri)', fontWeight: 700, fontSize: 16 }}>+3</td>
                        </tr>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>é‹å‹•ä¸­ç™¼ä½œ (Effort syncope)</td>
                            <td style={{ textAlign: 'center', color: 'var(--pri)', fontWeight: 700, fontSize: 16 }}>+3</td>
                        </tr>
                        <tr style={{ background: '#FEF3E9' }}>
                            <td style={{ fontWeight: 600 }}>å¹³èººæ™‚ç™¼ä½œ (Supine position)</td>
                            <td style={{ textAlign: 'center', color: '#F4A261', fontWeight: 700, fontSize: 16 }}>+2</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td style={{ fontWeight: 600 }}>ç¥ç¶“è‡ªä¸»å‰é©…ç—‡ç‹€*</td>
                            <td style={{ textAlign: 'center', color: 'var(--suc)', fontWeight: 700, fontSize: 16 }}>-1</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td style={{ fontWeight: 600 }}>èª˜ç™¼/ä¿ƒç™¼å› ç´ **</td>
                            <td style={{ textAlign: 'center', color: 'var(--suc)', fontWeight: 700, fontSize: 16 }}>-1</td>
                        </tr>
                    </tbody>
                </table>
                
                <div style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 12, lineHeight: 1.7 }}>
                    * å™å¿ƒã€å˜”åã€è…¹éƒ¨ä¸é©ã€å†·æ„Ÿã€å†’æ±—ã€é ­æšˆã€è¦–åŠ›æ¨¡ç³Š<br/>
                    ** æº«æš–ç’°å¢ƒã€ä¹…ç«™ã€é¤å¾Œã€ç–¼ç—›ã€é ¸éƒ¨è½‰å‹•ç­‰
                </div>
            </div>

            <div className="card" style={{ background: 'linear-gradient(135deg, #FEF3E9, #FDE8E0)' }}>
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ¯ EGSYS åˆ†æ•¸è§£è®€</h3>
                <div style={{ display: 'flex', gap: 12, marginBottom: 16 }}>
                    <div style={{ 
                        flex: 1, 
                        background: '#fff', 
                        padding: 16, 
                        borderRadius: 12, 
                        textAlign: 'center',
                        border: '2px solid var(--suc)'
                    }}>
                        <div style={{ fontSize: 28, fontWeight: 700, color: 'var(--suc)' }}>&lt; 3</div>
                        <div style={{ fontSize: 13, color: 'var(--txt2)', marginTop: 4 }}>å¿ƒå› æ€§å¯èƒ½ä½</div>
                        <div style={{ fontSize: 12, color: 'var(--suc)', fontWeight: 600, marginTop: 4 }}>LR- = 0.12-0.17</div>
                    </div>
                    <div style={{ 
                        flex: 1, 
                        background: '#fff', 
                        padding: 16, 
                        borderRadius: 12, 
                        textAlign: 'center',
                        border: '2px solid var(--pri)'
                    }}>
                        <div style={{ fontSize: 28, fontWeight: 700, color: 'var(--pri)' }}>â‰¥ 3</div>
                        <div style={{ fontSize: 13, color: 'var(--txt2)', marginTop: 4 }}>å¿ƒå› æ€§å¯èƒ½é«˜</div>
                        <div style={{ fontSize: 12, color: 'var(--pri)', fontWeight: 600, marginTop: 4 }}>LR+ = 2.8-3.3</div>
                    </div>
                </div>
                
                <div className="formula" style={{ background: '#fff' }}>
                    EGSYS â‰¥ 3 â†’ æ•æ„Ÿåº¦ 89-91% | ç‰¹ç•°åº¦ 69-73%
                </div>
            </div>

            <div className="tip">
                <strong style={{ color: '#B8860B' }}>ğŸ’¡ è‡¨åºŠæ‡‰ç”¨æç¤º</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.8 }}>
                    â€¢ EGSYS &lt; 3 å¯ä»¥å¹«åŠ©<strong>æ’é™¤</strong>å¿ƒå› æ€§æšˆå¥<br/>
                    â€¢ EGSYS â‰¥ 3 éœ€è¦é€²ä¸€æ­¥å¿ƒè‡Ÿè©•ä¼°<br/>
                    â€¢ è©•åˆ†ç³»çµ±æ‡‰èˆ‡è‡¨åºŠåˆ¤æ–·çµåˆä½¿ç”¨<br/>
                    â€¢ ç„¡æ³•å–ä»£å¿…è¦çš„å¿ƒé›»åœ–å’Œå¿ƒè‡Ÿç›£æ¸¬
                </p>
            </div>

            <div className="good">
                <strong style={{ color: 'var(--suc)' }}>âœ… æ¡ˆä¾‹æ‡‰ç”¨</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.8 }}>
                    70æ­²å¥³æ€§ï¼Œåè‘—åƒæ—©é¤æ™‚æ„Ÿåˆ°å™å¿ƒã€æº«æš–å¾Œæšˆå¥...<br/><br/>
                    <strong>EGSYSè¨ˆç®—ï¼š</strong><br/>
                    â€¢ ç„¡å¿ƒæ‚¸ (0åˆ†)<br/>
                    â€¢ å¿ƒé›»åœ–æ­£å¸¸ (0åˆ†)<br/>
                    â€¢ éé‹å‹•ä¸­ç™¼ä½œ (0åˆ†)<br/>
                    â€¢ éå¹³èººæ™‚ç™¼ä½œ (0åˆ†)<br/>
                    â€¢ æœ‰ç¥ç¶“è‡ªä¸»å‰é©…ç—‡ç‹€ (-1åˆ†)<br/><br/>
                    <strong>ç¸½åˆ† = -1 åˆ† â†’ å¿ƒå› æ€§æšˆå¥å¯èƒ½æ€§ä½</strong>
                </p>
            </div>
        </div>
    );

    // Lesson 5: Syncope vs Seizure
    const L5 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--warn)', marginBottom: 14 }}>âš¡ æšˆå¥ vs ç™²ç™‡ï¼šé‘‘åˆ¥è¦é»</h3>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginBottom: 16, lineHeight: 1.7 }}>
                    æšˆå¥å’Œç™²ç™‡éƒ½å¯èƒ½è¡¨ç¾ç‚ºçªç„¶æ„è­˜å–ªå¤±ï¼Œä½†æ²»ç™‚å’Œé å¾Œæˆªç„¶ä¸åŒã€‚ä»¥ä¸‹æ˜¯é—œéµé‘‘åˆ¥ç‰¹å¾µã€‚
                </p>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 16, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ”´ æ”¯æŒã€Œç™²ç™‡ã€çš„ç‰¹å¾µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>è‡¨åºŠç‰¹å¾µ</th>
                            <th>LR+ (ç™²ç™‡)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>å’¬å‚·èˆŒé ­ (Cut tongue)</td>
                            <td style={{ color: 'var(--pri)', fontWeight: 700 }}>17</td>
                        </tr>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>é ­éƒ¨è½‰å‘ä¸€å´</td>
                            <td style={{ color: 'var(--pri)', fontWeight: 700 }}>14</td>
                        </tr>
                        <tr style={{ background: '#FDECEA' }}>
                            <td style={{ fontWeight: 600 }}>ç•°å¸¸å§¿å‹¢</td>
                            <td style={{ color: 'var(--pri)', fontWeight: 700 }}>13</td>
                        </tr>
                        <tr>
                            <td>å°¿å¤±ç¦</td>
                            <td style={{ fontWeight: 600 }}>6.7</td>
                        </tr>
                        <tr>
                            <td>ç›®æ“Šè€…è¦‹ç™¼ç´º</td>
                            <td style={{ fontWeight: 600 }}>5.8</td>
                        </tr>
                        <tr>
                            <td>è‚¢é«”æŠ½å‹•</td>
                            <td style={{ fontWeight: 600 }}>5.6</td>
                        </tr>
                        <tr>
                            <td>ç„¡æ³•å›æ†¶ç™¼ä½œå‰è¡Œç‚º</td>
                            <td style={{ fontWeight: 600 }}>4.0</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 16, fontWeight: 700, color: 'var(--suc)', marginBottom: 14 }}>ğŸŸ¢ æ”¯æŒã€Œæšˆå¥ã€çš„ç‰¹å¾µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>è‡¨åºŠç‰¹å¾µ</th>
                            <th>LR+ (æšˆå¥)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td style={{ fontWeight: 600 }}>ä¹…ç«™æˆ–ä¹…åå¾Œç™¼ä½œ</td>
                            <td style={{ color: 'var(--suc)', fontWeight: 700 }}>20</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td style={{ fontWeight: 600 }}>ç™¼ä½œå‰å‘¼å¸å›°é›£</td>
                            <td style={{ color: 'var(--suc)', fontWeight: 700 }}>13</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td style={{ fontWeight: 600 }}>æœ‰å† ç‹€å‹•è„ˆç–¾ç—…</td>
                            <td style={{ color: 'var(--suc)', fontWeight: 700 }}>13</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰å¿ƒæ‚¸</td>
                            <td style={{ fontWeight: 600 }}>8.3</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰èƒ¸ç—›</td>
                            <td style={{ fontWeight: 600 }}>6.7</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå‰å†’æ±—</td>
                            <td style={{ fontWeight: 600 }}>5.9</td>
                        </tr>
                        <tr>
                            <td>æœ‰ä»»ä½•å‰é©…ç—‡ç‹€</td>
                            <td style={{ fontWeight: 600 }}>3.7</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="card" style={{ background: 'linear-gradient(135deg, #FFF9E6, #FEF3CD)' }}>
                <h3 style={{ fontSize: 16, fontWeight: 700, color: '#B8860B', marginBottom: 14 }}>ğŸ“Š ç™²ç™‡ vs æšˆå¥ è‡¨åºŠé æ¸¬è©•åˆ†</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ç—‡ç‹€</th>
                            <th style={{ textAlign: 'center' }}>åˆ†æ•¸</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>é†’ä¾†æ™‚ç™¼ç¾å’¬å‚·èˆŒé ­</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+2</td>
                        </tr>
                        <tr>
                            <td>ç•°å¸¸è¡Œç‚º (å¤±æ†¶ã€ç„¡åæ‡‰ã€å§¿å‹¢ç•°å¸¸ã€æŠ½å‹•)</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+1</td>
                        </tr>
                        <tr>
                            <td>æƒ…ç·’å£“åŠ›ä¸‹æ„è­˜å–ªå¤±</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+1</td>
                        </tr>
                        <tr>
                            <td>ç™¼ä½œå¾Œæ„è­˜æ··äº‚</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+1</td>
                        </tr>
                        <tr>
                            <td>é ­éƒ¨è½‰å‘ä¸€å´</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+1</td>
                        </tr>
                        <tr>
                            <td>å‰é©…ç—‡ç‹€ï¼šä¼¼æ›¾ç›¸è­˜ (dÃ©jÃ  vu) æˆ–é™Œç”Ÿæ„Ÿ</td>
                            <td style={{ textAlign: 'center', fontWeight: 600 }}>+1</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td>æœ‰ä»»ä½•å‰é©…ç—‡ç‹€</td>
                            <td style={{ textAlign: 'center', color: 'var(--suc)', fontWeight: 600 }}>-2</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td>ä¹…ç«™æˆ–ä¹…åå¾Œæ„è­˜å–ªå¤±</td>
                            <td style={{ textAlign: 'center', color: 'var(--suc)', fontWeight: 600 }}>-2</td>
                        </tr>
                        <tr style={{ background: '#E8F5F3' }}>
                            <td>ç™¼ä½œå‰å†’æ±—</td>
                            <td style={{ textAlign: 'center', color: 'var(--suc)', fontWeight: 600 }}>-2</td>
                        </tr>
                    </tbody>
                </table>
                
                <div className="formula" style={{ marginTop: 16 }}>
                    åˆ†æ•¸ â‰¥ 1ï¼šå‚¾å‘ç™²ç™‡ | åˆ†æ•¸ &lt; 1ï¼šå‚¾å‘æšˆå¥
                </div>
            </div>

            <div className="info">
                <strong style={{ color: 'var(--sec)' }}>ğŸ“Œ é‡è¦æé†’</strong>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.8 }}>
                    <strong>æšˆå¥ä¹Ÿå¯èƒ½æœ‰çŸ­æš«æŠ½å‹•ï¼</strong><br/>
                    â€¢ é€šå¸¸ç™¼ç”Ÿåœ¨æ„è­˜å–ªå¤±æ™‚æˆ–ä¹‹å¾Œ10ç§’å…§<br/>
                    â€¢ æŒçºŒæ™‚é–“é€šå¸¸å°‘æ–¼15ç§’<br/>
                    â€¢ ä¸å°ç¨±çš„è‚Œé™£æ”£æˆ–å¼·ç›´-é™£æ”£å‹•ä½œ<br/>
                    â€¢ èˆ‡ç™²ç™‡ä¸åŒï¼Œä¸æœƒç™¼ç”Ÿåœ¨æ„è­˜å–ªå¤±ä¹‹å‰
                </p>
            </div>
        </div>
    );

    const Lesson = () => {
        const l = lessons.find(x => x.id === lessonId);
        return (
            <div className="fade-in">
                <Header title={l.title} />
                <div style={{ 
                    background: `linear-gradient(135deg, ${l.color}, ${l.color}99)`, 
                    padding: '24px 20px', 
                    color: '#fff' 
                }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        <div style={{ fontSize: 12, opacity: 0.9, marginBottom: 4 }}>Lesson {l.id} â€¢ {l.sub}</div>
                        <h1 style={{ fontSize: 22, fontWeight: 700 }}>{l.title}</h1>
                    </div>
                </div>
                <div style={{ padding: '20px 16px' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        {lessonId === 1 && <L1 />}
                        {lessonId === 2 && <L2 />}
                        {lessonId === 3 && <L3 />}
                        {lessonId === 4 && <L4 />}
                        {lessonId === 5 && <L5 />}
                        <div style={{ display: 'flex', gap: 12, marginTop: 28 }}>
                            {lessonId > 1 && (
                                <button 
                                    className="btn" 
                                    style={{ flex: 1, background: '#fff', border: '2px solid var(--pri)', color: 'var(--pri)' }} 
                                    onClick={() => setLessonId(lessonId - 1)}
                                >
                                    â† ä¸Šä¸€èª²
                                </button>
                            )}
                            {lessonId < 5 ? (
                                <button className="btn btn-pri" style={{ flex: 1 }} onClick={() => setLessonId(lessonId + 1)}>
                                    ä¸‹ä¸€èª² â†’
                                </button>
                            ) : (
                                <button 
                                    className="btn btn-sec" 
                                    style={{ flex: 1 }} 
                                    onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); setPage('quiz'); }}
                                >
                                    é–‹å§‹æ¸¬é©— ğŸ“
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            </div>
        );
    };

    const Quiz = () => {
        const pick = (i) => {
            if (show) return;
            setSel(i);
            setShow(true);
            if (i === quiz[qIdx].c) setScore(score + 1);
        };
        
        const next = () => {
            if (qIdx < quiz.length - 1) {
                setQIdx(qIdx + 1);
                setSel(null);
                setShow(false);
            } else {
                setDone(true);
            }
        };

        if (done) {
            const pct = Math.round((score / quiz.length) * 100);
            return (
                <div className="fade-in">
                    <Header title="æ¸¬é©—çµæœ" />
                    <div style={{ padding: '48px 16px', textAlign: 'center' }}>
                        <div style={{ 
                            width: 150, 
                            height: 150, 
                            borderRadius: '50%', 
                            background: `conic-gradient(${pct >= 80 ? 'var(--suc)' : pct >= 60 ? 'var(--warn)' : 'var(--pri)'} ${pct * 3.6}deg, #E5E5E5 0deg)`, 
                            display: 'flex', 
                            alignItems: 'center', 
                            justifyContent: 'center', 
                            margin: '0 auto 28px',
                            boxShadow: '0 8px 32px rgba(0,0,0,0.1)'
                        }}>
                            <div style={{ 
                                width: 126, 
                                height: 126, 
                                borderRadius: '50%', 
                                background: '#fff', 
                                display: 'flex', 
                                flexDirection: 'column', 
                                alignItems: 'center', 
                                justifyContent: 'center' 
                            }}>
                                <div style={{ fontSize: 40, fontWeight: 700, color: 'var(--txt)' }}>{pct}%</div>
                                <div style={{ fontSize: 15, color: 'var(--txt2)' }}>{score}/{quiz.length}</div>
                            </div>
                        </div>
                        <h2 style={{ fontSize: 26, fontWeight: 700, marginBottom: 10 }}>
                            {pct >= 80 ? 'ğŸ‰ å„ªç§€ï¼' : pct >= 60 ? 'ğŸ‘ ä¸éŒ¯ï¼' : 'ğŸ’ª åŠ æ²¹ï¼'}
                        </h2>
                        <p style={{ color: 'var(--txt2)', marginBottom: 36, fontSize: 15 }}>
                            {pct >= 80 ? 'ä½ å°æšˆå¥çš„è‡¨åºŠè¨ºæ–·æŒæ¡è‰¯å¥½ï¼' : pct >= 60 ? 'å†è¤‡ç¿’å¯ä»¥æ›´é€²æ­¥ï¼' : 'å»ºè­°é‡æ–°é–±è®€èª²ç¨‹å…§å®¹'}
                        </p>
                        <div style={{ display: 'flex', gap: 14, justifyContent: 'center', flexWrap: 'wrap' }}>
                            <button className="btn btn-pri" onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); }}>
                                é‡æ–°æ¸¬é©—
                            </button>
                            <button className="btn" style={{ background: '#fff', border: '2px solid var(--pri)', color: 'var(--pri)' }} onClick={() => setPage('home')}>
                                è¿”å›èª²ç¨‹
                            </button>
                        </div>
                    </div>
                    <footer style={{ background: 'linear-gradient(135deg, #FEF3E9, #FDE8E0)', padding: '28px 16px', textAlign: 'center', marginTop: 48 }}>
                        <p style={{ fontSize: 12, color: 'var(--txt2)' }}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨ | è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                    </footer>
                </div>
            );
        }

        const q = quiz[qIdx];
        return (
            <div className="fade-in">
                <Header title="è‡ªæˆ‘æ¸¬é©—" />
                <div style={{ padding: '20px 16px' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 10, fontSize: 14 }}>
                            <span style={{ color: 'var(--txt2)' }}>é€²åº¦</span>
                            <span style={{ fontWeight: 600, color: 'var(--pri)' }}>{qIdx + 1}/{quiz.length}</span>
                        </div>
                        <div style={{ height: 10, background: '#E5E5E5', borderRadius: 5, marginBottom: 24, overflow: 'hidden' }}>
                            <div style={{ 
                                height: '100%', 
                                width: `${((qIdx + 1) / quiz.length) * 100}%`, 
                                background: 'linear-gradient(90deg, var(--pri), var(--pri2))', 
                                borderRadius: 5, 
                                transition: 'width 0.4s ease' 
                            }} />
                        </div>
                        <div className="card">
                            <h3 style={{ fontSize: 16, fontWeight: 600, lineHeight: 1.7, marginBottom: 22, color: 'var(--txt)' }}>{q.q}</h3>
                            {q.o.map((opt, i) => {
                                let bg = '#fff', bd = '#E5E5E5';
                                if (show) {
                                    if (i === q.c) { bg = '#E8F5F3'; bd = 'var(--suc)'; }
                                    else if (i === sel) { bg = '#FDECEA'; bd = 'var(--pri)'; }
                                } else if (i === sel) { bg = '#FEF3E9'; bd = 'var(--pri)'; }
                                return (
                                    <button 
                                        key={i} 
                                        onClick={() => pick(i)} 
                                        disabled={show} 
                                        style={{ 
                                            width: '100%', 
                                            padding: '14px 16px', 
                                            marginBottom: 12, 
                                            background: bg, 
                                            border: `2px solid ${bd}`, 
                                            borderRadius: 14, 
                                            textAlign: 'left', 
                                            fontSize: 14, 
                                            cursor: show ? 'default' : 'pointer', 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            gap: 14,
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        <span style={{ 
                                            width: 30, 
                                            height: 30, 
                                            borderRadius: 10, 
                                            background: show && i === q.c ? 'var(--suc)' : show && i === sel ? 'var(--pri)' : 'linear-gradient(135deg, #FEF3E9, #FDE8E0)', 
                                            color: show && (i === q.c || i === sel) ? '#fff' : 'var(--pri)', 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            justifyContent: 'center', 
                                            fontWeight: 700, 
                                            fontSize: 14, 
                                            flexShrink: 0 
                                        }}>
                                            {show && i === q.c ? 'âœ“' : show && i === sel && i !== q.c ? 'âœ—' : String.fromCharCode(65 + i)}
                                        </span>
                                        <span style={{ lineHeight: 1.6, color: 'var(--txt)' }}>{opt}</span>
                                    </button>
                                );
                            })}
                        </div>
                        {show && (
                            <div className={sel === q.c ? 'good' : 'tip'}>
                                <strong style={{ color: sel === q.c ? 'var(--suc)' : '#B8860B' }}>
                                    {sel === q.c ? 'âœ“ æ­£ç¢ºï¼' : 'âœ— ç­”éŒ¯äº†'}
                                </strong>
                                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 10, lineHeight: 1.8 }}>{q.e}</p>
                            </div>
                        )}
                        {show && (
                            <button className="btn btn-pri" style={{ width: '100%', justifyContent: 'center', marginTop: 20 }} onClick={next}>
                                {qIdx < quiz.length - 1 ? 'ä¸‹ä¸€é¡Œ â†’' : 'æŸ¥çœ‹çµæœ'}
                            </button>
                        )}
                    </div>
                </div>
            </div>
        );
    };

    const closeBadge = (id) => setNewBadges(prev => prev.filter(b => b !== id));

    return (
        <div style={{ maxWidth: '100%', minHeight: '100vh', background: 'var(--bg)' }}>
            <BadgeToast badges={newBadges} onClose={closeBadge} />
            {page === 'home' ? <Home /> : page === 'lesson' ? <Lesson /> : <Quiz />}
        </div>
    );
};

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
