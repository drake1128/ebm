<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>èƒ¸ç—›èˆ‡æ€¥æ€§å† å¿ƒç—‡å€™ç¾¤è©•ä¼° | JAMA Rational Clinical Examination</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&family=Crimson+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --pri: #C62828;
            --pri2: #EF5350;
            --sec: #AD1457;
            --sec2: #EC407A;
            --suc: #2E7D32;
            --warn: #F9A825;
            --danger: #B71C1C;
            --info: #1565C0;
            --bg: #FFF8F8;
            --txt: #37474F;
            --txt2: #607D8B;
            --card-shadow: 0 4px 20px rgba(198, 40, 40, 0.08);
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg);
            color: var(--txt);
            line-height: 1.8;
            -webkit-font-smoothing: antialiased;
        }
        .card {
            background: #fff;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: var(--card-shadow);
            border: 1px solid rgba(198, 40, 40, 0.08);
        }
        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .btn-pri { background: linear-gradient(135deg, var(--pri), var(--pri2)); color: #fff; }
        .btn-pri:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(198, 40, 40, 0.3); }
        .btn-sec { background: linear-gradient(135deg, var(--sec), var(--sec2)); color: #fff; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; margin: 12px 0; }
        th, td { padding: 12px 10px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: linear-gradient(135deg, #FFEBEE, #FFCDD2); font-weight: 600; color: var(--pri); }
        .formula {
            background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
            border: 2px solid var(--pri2);
            border-radius: 16px;
            padding: 18px;
            margin: 14px 0;
            text-align: center;
            font-family: 'Crimson Pro', serif;
            font-size: 18px;
            color: var(--txt);
            font-weight: 600;
        }
        .tip {
            background: linear-gradient(135deg, #FFF8E1, #FFECB3);
            border-left: 4px solid var(--warn);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .good {
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
            border-left: 4px solid var(--suc);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .danger {
            background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
            border-left: 4px solid var(--danger);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        .info {
            background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
            border-left: 4px solid var(--info);
            border-radius: 0 14px 14px 0;
            padding: 16px;
            margin: 14px 0;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .lr-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            margin-left: 6px;
        }
        .lr-high { background: #FFCDD2; color: #B71C1C; }
        .lr-mod { background: #FFF9C4; color: #F57F17; }
        .lr-low { background: #C8E6C9; color: #1B5E20; }
        .score-box {
            background: linear-gradient(135deg, #FAFAFA, #F5F5F5);
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect } = React;

const MODULE_ID='jama-chest-pain-acs';

// Badge definitions for notifications
const badgeDefs = {
    'first-quiz': { name: 'åˆè©¦å•¼è²', icon: 'ğŸ¯' },
    'perfect-score': { name: 'æ»¿åˆ†é”äºº', icon: 'ğŸ’¯' },
    'five-complete': { name: 'å°æœ‰æˆå°±', icon: 'â­' },
    'ten-complete': { name: 'å­¸æœ‰å°ˆç²¾', icon: 'ğŸŒŸ' },
    'master': { name: 'EBMå¤§å¸«', icon: 'ğŸ‘‘' },
    'speed-demon': { name: 'ç¥é€Ÿç­”é¡Œ', icon: 'âš¡' },
    'persistent': { name: 'å …æŒä¸æ‡ˆ', icon: 'ğŸ’ª' },
    'three-streak': { name: 'é€£å‹ä¸‰å ´', icon: 'ğŸ”¥' },
    'five-streak': { name: 'äº”é€£å‹', icon: 'ğŸ†' },
    'triple-perfect': { name: 'ä¸‰å† ç‹', icon: 'ğŸ‘‘' },
    'early-bird': { name: 'æ—©èµ·çš„é³¥', icon: 'ğŸ¦' },
    'night-owl': { name: 'å¤œè²“å­', icon: 'ğŸ¦‰' },
    'weekend-warrior': { name: 'å‡æ—¥æˆ°å£«', icon: 'ğŸ“…' },
    'comeback-kid': { name: 'é€†è½‰å‹', icon: 'ğŸš€' },
    'quick-learner': { name: 'ä¸€é»å°±é€š', icon: 'ğŸ’¡' },
    'improvement-king': { name: 'é€²æ­¥ç‹', icon: 'ğŸ“ˆ' },
    'marathon-runner': { name: 'é¦¬æ‹‰æ¾å­¸ç¿’è€…', icon: 'ğŸƒ' },
    'reviewer': { name: 'æº«æ•…çŸ¥æ–°', icon: 'ğŸ“–' },
    'almost-there': { name: 'å·®ä¸€é»é»', icon: 'ğŸ˜…' },
    'generous-guesser': { name: 'ä½›ç³»ç­”é¡Œ', icon: 'ğŸ™' },
    'learning-worm': { name: 'å­¸è¡“èš¯èš“', icon: 'ğŸª±' },
    'eternal-student': { name: 'æ°¸æ†çš„å­¸ç”Ÿ', icon: 'â™¾ï¸' },
    'speed-fail': { name: 'å…‰é€Ÿé™£äº¡', icon: 'ğŸ’«' },
    'slow-and-wrong': { name: 'æƒ³å¾ˆä¹…é‚„æ˜¯éŒ¯', icon: 'ğŸ¤”' },
    'zero-hero': { name: 'é›¶åˆ†è‹±é›„', icon: 'ğŸ’€' },
    'procrastinator': { name: 'æœ€å¾Œä¸€ç§’', icon: 'â°' },
    'deja-vu': { name: 'æ—¢è¦–æ„Ÿ', icon: 'ğŸ‘€' },
    'coffee-needed': { name: 'éœ€è¦å’–å•¡', icon: 'â˜•' },
    'wanderer': { name: 'æ¼«éŠè€…', icon: 'ğŸ§­' },
    'consistent-output': { name: 'ç©©å®šè¼¸å‡º', icon: 'ğŸ¯' },
    'heart-expert': { name: 'å¿ƒè‡Ÿé”äºº', icon: 'â¤ï¸' },
    'critical-master': { name: 'æ€¥é‡ç—‡å°ˆå®¶', icon: 'ğŸš¨' },
    'neuro-ninja': { name: 'ç¥ç¶“å¿è€…', icon: 'ğŸ§ ' },
    'pulm-pro': { name: 'èƒ¸è…”é«˜æ‰‹', icon: 'ğŸ«' },
    'ebm-foundation': { name: 'EBMåŸºçŸ³', icon: 'ğŸ›ï¸' },
    'jama-collector': { name: 'JAMAæ”¶è—å®¶', icon: 'ğŸ“š' },
    'achievement-hunter': { name: 'æˆå°±çµäºº', icon: 'ğŸ…' },
    'lucky-seven': { name: 'å¹¸é‹ä¸ƒ', icon: 'ğŸ€' },
    'completionist': { name: 'å…¨æˆå°±é”æˆ', icon: 'ğŸ–ï¸' }
};

// Category module mappings
const categoryModules = {
    cardio: ['jama-chest-pain-acs', 'jama-syncope', 'jama-hypertension'],
    critical: ['jama-bacteremia', 'jama-gi-bleed', 'jama-fluid-responsiveness', 'jama-difficult-intubation', 'jama-cirrhosis', 'jama-wound-infection'],
    neuro: ['jama-head-trauma', 'jama-delirium', 'jama-decision-capacity'],
    pulm: ['jama-pleural-effusion', 'jama-osa'],
    core: ['critical-appraisal', 'diagnostic-study', 'prognosis-study', 'rct-appraisal', 'systematic-review', 'literature-search']
};

const ProgressTracker={
    STORAGE_KEY:'ebm-progress',
    newBadges: [],
    getProgress:()=>{try{const d=localStorage.getItem(ProgressTracker.STORAGE_KEY);return d?JSON.parse(d):{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}catch{return{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}},
    saveQuizResult:(moduleId,score,total,timeSpent)=>{
        ProgressTracker.newBadges = [];
        const progress=ProgressTracker.getProgress();
        const mod=progress.modules[moduleId]||{bestScore:0,totalAttempts:0,allAttempts:[],lessonsViewed:[],completed:false,firstCompleted:null};
        const attempt={date:new Date().toISOString(),score,timeSpent};
        mod.allAttempts.push(attempt);mod.totalAttempts++;
        if(score>mod.bestScore)mod.bestScore=score;
        const passingScore=Math.ceil(total*0.7);
        if(score>=passingScore&&!mod.completed){mod.completed=true;mod.firstCompleted=attempt.date}
        progress.modules[moduleId]=mod;progress.totalTimeSpent+=timeSpent;progress.lastUpdated=new Date().toISOString();
        ProgressTracker.checkBadges(progress,moduleId,score,total,timeSpent);
        localStorage.setItem(ProgressTracker.STORAGE_KEY,JSON.stringify(progress));return progress;
    },
    checkBadges:(progress,moduleId,score,total,timeSpent)=>{
        const badges=progress.badges||[];const ids=badges.map(b=>b.id);const now=new Date();const nowStr=now.toISOString();
        const hour=now.getHours();const day=now.getDay();
        const passed=score>=Math.ceil(total*0.7);const perfect=score===total;
        const addBadge=(id)=>{if(!ids.includes(id)){badges.push({id,earnedAt:nowStr});ids.push(id);ProgressTracker.newBadges.push(id);return true}return false};

        // === MILESTONE & BASIC BADGES ===
        addBadge('first-quiz');
        if(perfect)addBadge('perfect-score');
        if(timeSpent<120&&passed)addBadge('speed-demon');
        const completed=Object.values(progress.modules).filter(m=>m.completed).length;
        if(completed>=5)addBadge('five-complete');
        if(completed>=10)addBadge('ten-complete');
        if(completed>=18)addBadge('master');
        const mod=progress.modules[moduleId];
        if(mod&&mod.totalAttempts>=3)addBadge('persistent');

        // === TIME-BASED BADGES ===
        if(hour<6)addBadge('early-bird');
        if(hour>=0&&hour<5)addBadge('night-owl');
        if(day===0||day===6)addBadge('weekend-warrior');
        if(hour>=2&&hour<5&&!passed)addBadge('coffee-needed');

        // === STREAK BADGES ===
        const streakData=progress.streakData||{currentPassStreak:0,currentPerfectStreak:0};
        if(passed){streakData.currentPassStreak++;if(perfect)streakData.currentPerfectStreak++;else streakData.currentPerfectStreak=0}
        else{streakData.currentPassStreak=0;streakData.currentPerfectStreak=0}
        if(streakData.currentPassStreak>=3)addBadge('three-streak');
        if(streakData.currentPassStreak>=5)addBadge('five-streak');
        if(streakData.currentPerfectStreak>=3)addBadge('triple-perfect');
        progress.streakData=streakData;

        // === MODULE-SPECIFIC BADGES ===
        if(mod){
            if(mod.totalAttempts===1&&perfect)addBadge('quick-learner');
            if(mod.totalAttempts===1&&score===7)addBadge('lucky-seven');
            if(mod.allAttempts&&mod.allAttempts.length>1){
                const firstScore=mod.allAttempts[0].score;
                if(firstScore<7&&perfect)addBadge('comeback-kid');
                if(score-firstScore>=5)addBadge('improvement-king');
                const lastThree=mod.allAttempts.slice(-3);
                if(lastThree.length===3&&lastThree[0].score===lastThree[1].score&&lastThree[1].score===lastThree[2].score)addBadge('deja-vu');
                if(lastThree.length===3&&lastThree.every(a=>a.score===score))addBadge('consistent-output');
            }
            if(mod.totalAttempts>=10)addBadge('learning-worm');
            if(mod.completed&&mod.totalAttempts>1&&passed)addBadge('reviewer');
        }

        // === HUMOROUS BADGES ===
        if(score===6)addBadge('almost-there');
        if(score===0)addBadge('zero-hero');
        if(score>=2&&score<=3)addBadge('generous-guesser');
        if(timeSpent<30&&!passed)addBadge('speed-fail');
        if(timeSpent>600&&!passed)addBadge('slow-and-wrong');

        // === TOTAL ATTEMPTS BADGES ===
        const totalAttempts=Object.values(progress.modules).reduce((sum,m)=>sum+(m.totalAttempts||0),0);
        if(totalAttempts>=50&&completed<18)addBadge('eternal-student');
        const startedNotCompleted=Object.values(progress.modules).filter(m=>m.totalAttempts>0&&!m.completed).length;
        if(startedNotCompleted>=5&&completed===0)addBadge('wanderer');

        // === PROCRASTINATOR BADGE ===
        if(progress.lastActivityDate){
            const lastActivity=new Date(progress.lastActivityDate);
            const daysSince=(now-lastActivity)/(1000*60*60*24);
            if(daysSince>=7)addBadge('procrastinator');
        }
        progress.lastActivityDate=nowStr;

        // === CATEGORY-SPECIFIC BADGES ===
        const checkCat=(cat,badgeId)=>{const mods=categoryModules[cat]||[];if(mods.length>0&&mods.every(id=>progress.modules[id]?.completed))addBadge(badgeId)};
        checkCat('cardio','heart-expert');
        checkCat('critical','critical-master');
        checkCat('neuro','neuro-ninja');
        checkCat('pulm','pulm-pro');
        checkCat('core','ebm-foundation');
        const jamaComplete=Object.keys(progress.modules).filter(k=>k.startsWith('jama-')&&progress.modules[k]?.completed).length;
        if(jamaComplete>=12)addBadge('jama-collector');

        // === META BADGES ===
        if(badges.length>=10)addBadge('achievement-hunter');
        if(badges.length>=39)addBadge('completionist');

        progress.badges=badges;
    }
};

const lessons = [
    { id: 1, title: 'ACSæ¦‚è«–èˆ‡è‡¨åºŠåˆ†é¡', sub: 'ACS Overview & Classification', color: '#C62828' },
    { id: 2, title: 'å±éšªå› å­èˆ‡ç—‡ç‹€è©•ä¼°', sub: 'Risk Factors & Symptoms', color: '#AD1457' },
    { id: 3, title: 'ç†å­¸æª¢æŸ¥èˆ‡å¿ƒé›»åœ–', sub: 'Physical Exam & ECG', color: '#6A1B9A' },
    { id: 4, title: 'HEARTèˆ‡TIMIè©•åˆ†', sub: 'Clinical Decision Rules', color: '#1565C0' },
    { id: 5, title: 'è‡¨åºŠæ‡‰ç”¨æ•´åˆ', sub: 'Clinical Application', color: '#00695C' }
];

// Interactive Clinical Cases
const clinicalCases = [
    {
        id: 1,
        title: 'æ€¥è¨ºå®¤çš„èƒ¸ç—›æ‚£è€…',
        titleEn: 'Chest Pain in the Emergency Department',
        difficulty: 'åŸºç¤',
        estimatedTime: '5-8åˆ†é˜',
        description: 'ä¸€ä½ä¸­å¹´ç”·æ€§å› èƒ¸ç—›ä¾†åˆ°æ€¥è¨ºï¼Œé‹ç”¨æ‰€å­¸çŸ¥è­˜é€²è¡Œè‡¨åºŠè©•ä¼°ã€‚',
        steps: [
            {
                type: 'intro',
                content: {
                    title: 'ğŸ“‹ ç—…æ‚£è³‡æ–™',
                    text: '55æ­²ç”·æ€§ï¼Œå› èƒ¸éª¨å¾Œå£“è¿«æ„ŸæŒçºŒ45åˆ†é˜è‡³æ€¥è¨ºæ±‚è¨ºã€‚',
                    vitals: { BP: '145/92 mmHg', HR: '88 bpm', RR: '18/min', SpO2: '97%', Temp: '36.8Â°C' }
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ¥ åˆæ­¥è©•ä¼°',
                    text: 'è­·ç†å¸«å·²å®Œæˆç”Ÿå‘½å¾µè±¡æ¸¬é‡ã€‚ä½œç‚ºæ€¥è¨ºé†«å¸«ï¼Œæ‚¨é¦–å…ˆéœ€è¦è©•ä¼°ä»€éº¼ï¼Ÿ',
                    options: [
                        { text: 'ç«‹å³å®‰æ’å¿ƒå°ç®¡æª¢æŸ¥', feedback: 'å¤ªæ€¥é€²äº†ï¼éœ€è¦å…ˆå®Œæˆåˆæ­¥è©•ä¼°ï¼ŒåŒ…æ‹¬å¿ƒé›»åœ–å’Œç—…å²è©¢å•ã€‚', correct: false },
                        { text: 'è©¢å•è©³ç´°ç—…å²ä¸¦å®‰æ’å¿ƒé›»åœ–', feedback: 'æ­£ç¢ºï¼å¿ƒé›»åœ–æ˜¯è©•ä¼°èƒ¸ç—›çš„ç¬¬ä¸€æ­¥ï¼Œå¯åœ¨10åˆ†é˜å…§å®Œæˆï¼ŒåŒæ™‚è©¢å•ç—…å²ã€‚', correct: true },
                        { text: 'å…ˆçµ¦äºˆç¡åŒ–ç”˜æ²¹å†è§€å¯Ÿ', feedback: 'ä¸å»ºè­°ã€‚ç¡åŒ–ç”˜æ²¹å°ACSçš„è¨ºæ–·åƒ¹å€¼æœ‰é™(LR+ = 1.1)ï¼Œæ‡‰å…ˆå®Œæˆè©•ä¼°ã€‚', correct: false },
                        { text: 'å®‰æ’èƒ¸éƒ¨Xå…‰æª¢æŸ¥', feedback: 'èƒ¸éƒ¨Xå…‰å°ACSè¨ºæ–·å¹«åŠ©æœ‰é™ï¼Œæ‡‰å„ªå…ˆå®‰æ’å¿ƒé›»åœ–ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'info',
                content: {
                    title: 'ğŸ“Š å¿ƒé›»åœ–çµæœ',
                    text: 'å¿ƒé›»åœ–é¡¯ç¤ºV3-V5å°ç¨‹æœ‰0.5mm STæ®µä¸‹é™ã€‚',
                    highlight: 'STæ®µä¸‹é™çš„è¨ºæ–·åƒ¹å€¼ï¼šLR+ = 5.3 (95% CI, 2.1-8.6)',
                    note: 'é€™æ˜¯å¿ƒé›»åœ–ç™¼ç¾ä¸­æœ€æœ‰åƒ¹å€¼çš„æŒ‡æ¨™ï¼Œç‰¹ç•°åº¦é”95%ã€‚'
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ“ ç—…å²è©¢å•',
                    text: 'æ‚¨è©¢å•ç—…å²æ™‚ï¼Œä¸‹åˆ—å“ªå€‹å•é¡Œå°è¨ºæ–·æœ€æœ‰å¹«åŠ©ï¼Ÿ',
                    options: [
                        { text: 'ç–¼ç—›æœƒä¸æœƒæ”¾å°„åˆ°å·¦è‡‚ï¼Ÿ', feedback: 'æ”¾å°„è‡³å·¦è‡‚çš„LR+åƒ…1.3ï¼Œè¨ºæ–·åƒ¹å€¼æœ‰é™ã€‚', correct: false },
                        { text: 'ç–¼ç—›æœƒä¸æœƒæ”¾å°„åˆ°é›™å´ä¸Šè‚¢ï¼Ÿ', feedback: 'æ­£ç¢ºï¼æ”¾å°„è‡³é›™å´ä¸Šè‚¢çš„LR+ = 2.6ï¼Œç‰¹ç•°åº¦96%ï¼Œæ˜¯ç—‡ç‹€ä¸­é æ¸¬ACSæœ€å¼·çš„ç‰¹å¾µã€‚', correct: true },
                        { text: 'åƒèƒƒè—¥æœ‰æ²’æœ‰æ”¹å–„ï¼Ÿ', feedback: 'èƒƒè—¥åæ‡‰å°å€åˆ†å¿ƒå› æ€§èˆ‡éå¿ƒå› æ€§èƒ¸ç—›å¹«åŠ©ä¸å¤§ã€‚', correct: false },
                        { text: 'ç¡åŒ–ç”˜æ²¹æœ‰æ²’æœ‰ç·©è§£ï¼Ÿ', feedback: 'ç¡åŒ–ç”˜æ²¹åæ‡‰çš„LR+ = 1.1ï¼Œå°ACSè¨ºæ–·å¹¾ä¹æ²’æœ‰å¹«åŠ©ï¼', correct: false }
                    ]
                }
            },
            {
                type: 'info',
                content: {
                    title: 'ğŸ“‹ å®Œæ•´ç—…å²',
                    text: 'æ‚£è€…è¡¨ç¤ºç–¼ç—›ç¢ºå¯¦æ”¾å°„è‡³å·¦è‡‚ï¼Œä½†æœªæ”¾å°„è‡³é›™å´ä¸Šè‚¢ã€‚éå»ç—…å²åŒ…æ‹¬é«˜è¡€å£“(æœè—¥ä¸­)ã€é«˜è¡€è„‚ï¼Œç„¡ç³–å°¿ç—…ã€‚çˆ¶è¦ª65æ­²æ™‚æ›¾å¿ƒè‚Œæ¢—å¡ã€‚',
                    details: [
                        'èƒ¸ç—›æ€§è³ªï¼šå£“è¿«æ„Ÿï¼Œèˆ‡éå»ç¶“é©—ä¸åŒ',
                        'ä¼´éš¨ç—‡ç‹€ï¼šè¼•å¾®å†’å†·æ±—',
                        'ç–¼ç—›æŒçºŒæ™‚é–“ï¼šç´„45åˆ†é˜',
                        'ç¡åŒ–ç”˜æ²¹ï¼šå°šæœªä½¿ç”¨'
                    ]
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ” ç†å­¸æª¢æŸ¥',
                    text: 'ç†å­¸æª¢æŸ¥æ™‚ï¼Œä¸‹åˆ—å“ªå€‹ç™¼ç¾æœ€èƒ½é™ä½ACSçš„å¯èƒ½æ€§ï¼Ÿ',
                    options: [
                        { text: 'å¿ƒæéé€Ÿ (HR > 120)', feedback: 'å¿ƒæéé€Ÿçš„LR+ = 1.3ï¼Œæ—¢ä¸èƒ½ç¢ºèªä¹Ÿä¸èƒ½æ’é™¤ACSã€‚', correct: false },
                        { text: 'ä½è¡€å£“ (SBP < 100)', feedback: 'ä½è¡€å£“çš„LR+ = 3.9ï¼Œåè€Œå¢åŠ ACSå¯èƒ½æ€§ï¼', correct: false },
                        { text: 'è§¸è¨ºå¯é‡ç¾ç–¼ç—›', feedback: 'æ­£ç¢ºï¼è§¸è¨ºå¯é‡ç¾ç–¼ç—›çš„LR = 0.28ï¼Œæ˜¯æ‰€æœ‰ç™¼ç¾ä¸­æœ€èƒ½é™ä½ACSå¯èƒ½æ€§çš„ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚', correct: true },
                        { text: 'è½è¨ºæœ‰è‚ºå›‰éŸ³', feedback: 'è‚ºå›‰éŸ³çš„LR+ = 2.0ï¼Œå¢åŠ ACSå¯èƒ½æ€§ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'info',
                content: {
                    title: 'ğŸ”¬ å¯¦é©—å®¤çµæœ',
                    text: 'ç†å­¸æª¢æŸ¥ï¼šèƒ¸å£ç„¡å£“ç—›ï¼Œå¿ƒéŸ³æ­£å¸¸ï¼Œè‚ºéƒ¨æ¸…æ™°ã€‚',
                    lab: { troponin: '0.08 ng/mL', reference: 'æ­£å¸¸ < 0.04 ng/mL', status: 'è¼•åº¦å‡é«˜' }
                }
            },
            {
                type: 'calculator',
                content: {
                    title: 'â¤ï¸ è¨ˆç®— HEART è©•åˆ†',
                    text: 'æ ¹æ“šç›®å‰æ”¶é›†åˆ°çš„è³‡è¨Šï¼Œè«‹è¨ˆç®—é€™ä½æ‚£è€…çš„HEARTè©•åˆ†ï¼š',
                    items: [
                        { label: 'H - History (ç—…å²)', value: 'å£“è¿«æ€§èƒ¸ç—›ï¼Œå¯èƒ½ç¬¦åˆACS', score: 1 },
                        { label: 'E - ECG (å¿ƒé›»åœ–)', value: 'STæ®µä¸‹é™', score: 2 },
                        { label: 'A - Age (å¹´é½¡)', value: '55æ­² (45-65æ­²)', score: 1 },
                        { label: 'R - Risk factors', value: 'é«˜è¡€å£“ã€é«˜è¡€è„‚ (2å€‹å±éšªå› å­)', score: 1 },
                        { label: 'T - Troponin', value: '0.08 (1-3å€æ­£å¸¸)', score: 1 }
                    ],
                    total: 6,
                    interpretation: 'ä¸­é¢¨éšª (5-6åˆ†)',
                    lr: 'LR = 2.4',
                    postTestProb: 'ä»¥13%å‰æ¸¬æ©Ÿç‡è¨ˆç®— â†’ å¾Œæ¸¬æ©Ÿç‡ç´„26%'
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ¥ è‡¨åºŠæ±ºç­–',
                    text: 'HEARTè©•åˆ†6åˆ†ï¼Œå±¬æ–¼ä¸­é¢¨éšªã€‚æ‚¨çš„è™•ç½®å»ºè­°æ˜¯ï¼Ÿ',
                    options: [
                        { text: 'é–‹ç«‹æ­¢ç—›è—¥å¾Œè®“æ‚£è€…å›å®¶', feedback: 'å±éšªï¼HEART 5-6åˆ†çš„æ‚£è€…ACSæ©Ÿç‡ç´„26%ï¼Œä¸æ‡‰ç›´æ¥å‡ºé™¢ã€‚', correct: false },
                        { text: 'è§€å¯Ÿ2å°æ™‚å¾Œè‹¥ç„¡ç—‡ç‹€å³å¯å‡ºé™¢', feedback: 'ä¸å»ºè­°ã€‚ä¸­é¢¨éšªæ‚£è€…éœ€è¦æ›´å®Œæ•´çš„è©•ä¼°ï¼ŒåŒ…æ‹¬é€£çºŒè‚Œéˆ£è›‹ç™½æª¢æ¸¬ã€‚', correct: false },
                        { text: 'ä½é™¢æ¥å—ACSæ²»ç™‚ä¸¦é€²ä¸€æ­¥è©•ä¼°', feedback: 'æ­£ç¢ºï¼HEART 5-6åˆ†å±¬ä¸­é¢¨éšªï¼Œæ‡‰ä½é™¢æ¥å—æŠ—è¡€å°æ¿ã€æŠ—å‡è¡€æ²»ç™‚ï¼Œä¸¦å®‰æ’é€²ä¸€æ­¥å¿ƒè‡Ÿè©•ä¼°ã€‚', correct: true },
                        { text: 'ç›´æ¥å®‰æ’ç·Šæ€¥å¿ƒå°ç®¡', feedback: 'æ‚£è€…ç›®å‰æ²’æœ‰STEMIçš„å¿ƒé›»åœ–è®ŠåŒ–ï¼Œä¸éœ€è¦ç·Šæ€¥å¿ƒå°ç®¡ï¼Œä½†ç¢ºå¯¦éœ€è¦ä½é™¢è©•ä¼°ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'summary',
                content: {
                    title: 'ğŸ“Š æ¡ˆä¾‹ç¸½çµ',
                    diagnosis: 'NSTE-ACS (é«˜åº¦æ‡·ç–‘)',
                    keyFindings: [
                        'STæ®µä¸‹é™ (LR+ = 5.3) é¡¯è‘—å¢åŠ ACSå¯èƒ½æ€§',
                        'HEARTè©•åˆ†6åˆ†ï¼Œå¾Œæ¸¬æ©Ÿç‡ç´„26%',
                        'è‚Œéˆ£è›‹ç™½è¼•åº¦å‡é«˜æ”¯æŒå¿ƒè‚Œæå‚·'
                    ],
                    management: 'ä½é™¢æ¥å—é›™æŠ—è¡€å°æ¿æ²»ç™‚ã€æŠ—å‡è¡€ï¼Œå®‰æ’éä¾µå…¥æ€§æˆ–ä¾µå…¥æ€§å¿ƒè‡Ÿè©•ä¼°',
                    learningPoints: [
                        'å¿ƒé›»åœ–STæ®µä¸‹é™æ˜¯æœ€æœ‰åƒ¹å€¼çš„ç™¼ç¾',
                        'ç¡åŒ–ç”˜æ²¹åæ‡‰å°è¨ºæ–·ç„¡å¹«åŠ©',
                        'HEARTè©•åˆ†å¯æœ‰æ•ˆé€²è¡Œé¢¨éšªåˆ†å±¤',
                        'ä¸­é¢¨éšªæ‚£è€…éœ€è¦ä½é™¢è©•ä¼°'
                    ]
                }
            }
        ]
    },
    {
        id: 2,
        title: 'ä½é¢¨éšªèƒ¸ç—›çš„å¿«é€Ÿè©•ä¼°',
        titleEn: 'Rapid Assessment of Low-Risk Chest Pain',
        difficulty: 'é€²éš',
        estimatedTime: '5-8åˆ†é˜',
        description: 'ä¸€ä½å¹´è¼•å¥³æ€§å› èƒ¸ç—›å°±è¨ºï¼Œå­¸ç¿’å¦‚ä½•è­˜åˆ¥ä½é¢¨éšªæ‚£è€…ã€‚',
        steps: [
            {
                type: 'intro',
                content: {
                    title: 'ğŸ“‹ ç—…æ‚£è³‡æ–™',
                    text: '38æ­²å¥³æ€§ï¼Œéå»å¥åº·ï¼Œå› é–“æ­‡æ€§å·¦å´èƒ¸ç—›2å¤©è‡³æ€¥è¨ºã€‚ç–¼ç—›ç‚ºåˆºç—›æ„Ÿï¼Œèˆ‡å‘¼å¸ç›¸é—œï¼Œæ¯æ¬¡æŒçºŒæ•¸ç§’åˆ°æ•¸åˆ†é˜ã€‚',
                    vitals: { BP: '118/72 mmHg', HR: '76 bpm', RR: '16/min', SpO2: '99%', Temp: '36.5Â°C' }
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ¤” åˆæ­¥å°è±¡',
                    text: 'æ ¹æ“šé€™å€‹æè¿°ï¼Œæ‚¨çš„åˆæ­¥è‡¨åºŠå°è±¡æ˜¯ï¼Ÿ',
                    options: [
                        { text: 'ã€Œè‚¯å®šæ˜¯ã€ACS', feedback: 'ä¸å¤ªå¯èƒ½ã€‚å¹´è¼•å¥³æ€§ã€é–“æ­‡æ€§åˆºç—›ã€èˆ‡å‘¼å¸ç›¸é—œï¼Œé€™äº›éƒ½æ˜¯éå…¸å‹ç‰¹å¾µã€‚', correct: false },
                        { text: 'ã€Œå¯èƒ½æ˜¯ã€ACS', feedback: 'ä»éœ€è©•ä¼°ï¼Œä½†é€™äº›ç‰¹å¾µé™ä½ACSå¯èƒ½æ€§ã€‚', correct: false },
                        { text: 'ã€Œå¯èƒ½ä¸æ˜¯ã€ACS', feedback: 'æ­£ç¢ºï¼æ ¹æ“šç ”ç©¶ï¼Œã€Œå¯èƒ½ä¸æ˜¯ã€ACSçš„è‡¨åºŠå°è±¡LR = 0.20ï¼Œå¯é¡¯è‘—é™ä½ACSå¯èƒ½æ€§ã€‚', correct: true },
                        { text: 'ç„¡æ³•åˆ¤æ–·', feedback: 'è‡¨åºŠå°è±¡æ˜¯æœ‰åƒ¹å€¼çš„ï¼ã€Œå¯èƒ½ä¸æ˜¯ã€ACSçš„LR = 0.20ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'info',
                content: {
                    title: 'ğŸ“Š å¿ƒé›»åœ–çµæœ',
                    text: 'å¿ƒé›»åœ–å®Œå…¨æ­£å¸¸ï¼Œç„¡ST-Tæ³¢è®ŠåŒ–ã€‚',
                    highlight: 'æ­£å¸¸å¿ƒé›»åœ–ä¸èƒ½å®Œå…¨æ’é™¤ACS',
                    note: 'å¿ƒé›»åœ–å°ACSçš„æ•æ„Ÿåº¦åƒ…25-32%ï¼Œç´„68-75%çš„ACSæ‚£è€…å¿ƒé›»åœ–å¯èƒ½æ­£å¸¸ã€‚'
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ” ç†å­¸æª¢æŸ¥ç™¼ç¾',
                    text: 'æª¢æŸ¥æ™‚ç™¼ç¾å·¦å´èƒ¸å£ç¬¬4-5è‚‹é–“è§¸è¨ºå¯é‡ç¾ç–¼ç—›ã€‚é€™å€‹ç™¼ç¾çš„æ„ç¾©æ˜¯ï¼Ÿ',
                    options: [
                        { text: 'ç¢ºå®šæ’é™¤ACS', feedback: 'éŒ¯èª¤ï¼è§¸è¨ºå¯é‡ç¾ç–¼ç—›çš„LR = 0.28ï¼Œé›–ç„¶æ˜¯æœ€æœ‰åƒ¹å€¼çš„æ’é™¤ç™¼ç¾ï¼Œä½†ä»ä¸èƒ½ã€Œå®Œå…¨ã€æ’é™¤ACSã€‚', correct: false },
                        { text: 'é¡¯è‘—é™ä½ACSå¯èƒ½æ€§ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤', feedback: 'æ­£ç¢ºï¼LR = 0.28æ˜¯æ‰€æœ‰ç™¼ç¾ä¸­æœ€èƒ½é™ä½ACSå¯èƒ½æ€§çš„ï¼Œä½†ä»éœ€çµåˆå…¶ä»–è³‡è¨Šåˆ¤æ–·ã€‚', correct: true },
                        { text: 'å°ACSè¨ºæ–·æ²’æœ‰å¹«åŠ©', feedback: 'éŒ¯èª¤ã€‚è§¸è¨ºå¯é‡ç¾ç–¼ç—›çš„LR = 0.28ï¼Œæ˜¯éå¸¸æœ‰åƒ¹å€¼çš„ç™¼ç¾ã€‚', correct: false },
                        { text: 'å¢åŠ ACSå¯èƒ½æ€§', feedback: 'ç›¸åï¼é€™å€‹ç™¼ç¾é™ä½ACSå¯èƒ½æ€§ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'info',
                content: {
                    title: 'ğŸ”¬ å¯¦é©—å®¤çµæœ',
                    text: 'åˆå§‹è‚Œéˆ£è›‹ç™½ï¼š0.01 ng/mL (æ­£å¸¸ < 0.04 ng/mL)',
                    note: 'è‚Œéˆ£è›‹ç™½åœ¨æ­£å¸¸ç¯„åœå…§ã€‚'
                }
            },
            {
                type: 'calculator',
                content: {
                    title: 'â¤ï¸ è¨ˆç®— HEART è©•åˆ†',
                    text: 'æ ¹æ“šç›®å‰æ”¶é›†åˆ°çš„è³‡è¨Šï¼Œè«‹è¨ˆç®—é€™ä½æ‚£è€…çš„HEARTè©•åˆ†ï¼š',
                    items: [
                        { label: 'H - History (ç—…å²)', value: 'éå…¸å‹èƒ¸ç—›ï¼Œä¸ç¬¦åˆACS', score: 0 },
                        { label: 'E - ECG (å¿ƒé›»åœ–)', value: 'æ­£å¸¸', score: 0 },
                        { label: 'A - Age (å¹´é½¡)', value: '38æ­² (<45æ­²)', score: 0 },
                        { label: 'R - Risk factors', value: 'ç„¡å±éšªå› å­', score: 0 },
                        { label: 'T - Troponin', value: 'æ­£å¸¸', score: 0 }
                    ],
                    total: 0,
                    interpretation: 'ä½é¢¨éšª (0-3åˆ†)',
                    lr: 'LR = 0.20',
                    postTestProb: 'ä»¥13%å‰æ¸¬æ©Ÿç‡è¨ˆç®— â†’ å¾Œæ¸¬æ©Ÿç‡ç´„2.9%'
                }
            },
            {
                type: 'question',
                content: {
                    title: 'ğŸ¥ è‡¨åºŠæ±ºç­–',
                    text: 'HEARTè©•åˆ†0åˆ†ï¼Œå±¬æ–¼ä½é¢¨éšªã€‚æ‚¨çš„è™•ç½®å»ºè­°æ˜¯ï¼Ÿ',
                    options: [
                        { text: 'ä½é™¢è§€å¯Ÿ24å°æ™‚', feedback: 'å°æ–¼HEART 0-3åˆ†çš„æ‚£è€…ï¼Œå¯èƒ½éåº¦è™•ç½®ã€‚', correct: false },
                        { text: '2-3å°æ™‚å¾Œè¤‡é©—è‚Œéˆ£è›‹ç™½ï¼Œè‹¥ä»æ­£å¸¸å¯è€ƒæ…®å‡ºé™¢', feedback: 'æ­£ç¢ºï¼ä½é¢¨éšªæ‚£è€…å¯è€ƒæ…®åŠ é€Ÿè¨ºæ–·æµç¨‹ï¼Œè‹¥é€£çºŒè‚Œéˆ£è›‹ç™½é™°æ€§ï¼Œå¯å®‰å…¨å‡ºé™¢ä¸¦é–€è¨ºè¿½è¹¤ã€‚', correct: true },
                        { text: 'ç›´æ¥å‡ºé™¢ï¼Œç„¡éœ€è¤‡é©—', feedback: 'ä»å»ºè­°è¤‡é©—è‚Œéˆ£è›‹ç™½ä»¥ç¢ºèªå®‰å…¨ã€‚å–®æ¬¡æª¢æ¸¬å¯èƒ½ç„¡æ³•é”åˆ°<1%æ¼è¨ºç‡ã€‚', correct: false },
                        { text: 'å®‰æ’é‹å‹•å¿ƒé›»åœ–', feedback: 'å°æ–¼HEART 0åˆ†ã€è‚Œéˆ£è›‹ç™½é™°æ€§çš„æ‚£è€…ï¼Œå¯èƒ½ä¸éœ€è¦å¸¸è¦å£“åŠ›æ¸¬è©¦ã€‚', correct: false }
                    ]
                }
            },
            {
                type: 'summary',
                content: {
                    title: 'ğŸ“Š æ¡ˆä¾‹ç¸½çµ',
                    diagnosis: 'éå¿ƒå› æ€§èƒ¸ç—›ï¼ˆå¯èƒ½ç‚ºè‚Œè‚‰éª¨éª¼æ€§ï¼‰',
                    keyFindings: [
                        'éå…¸å‹èƒ¸ç—›ç‰¹å¾µï¼ˆåˆºç—›ã€èˆ‡å‘¼å¸ç›¸é—œï¼‰',
                        'è§¸è¨ºå¯é‡ç¾ç–¼ç—› (LR = 0.28)',
                        'HEARTè©•åˆ†0åˆ† â†’ å¾Œæ¸¬æ©Ÿç‡ç´„2.9%',
                        'æ­£å¸¸å¿ƒé›»åœ–å’Œè‚Œéˆ£è›‹ç™½'
                    ],
                    management: 'è¤‡é©—è‚Œéˆ£è›‹ç™½å¾Œè‹¥ä»æ­£å¸¸å¯å‡ºé™¢ï¼Œé–€è¨ºè¿½è¹¤ï¼Œè¡›æ•™è­¦ç¤ºç—‡ç‹€',
                    learningPoints: [
                        'è‡¨åºŠå°è±¡ã€Œå¯èƒ½ä¸æ˜¯ACSã€æœ‰è¨ºæ–·åƒ¹å€¼ (LR = 0.20)',
                        'è§¸è¨ºå¯é‡ç¾ç–¼ç—›æ˜¯æœ€æœ‰åƒ¹å€¼çš„æ’é™¤ç™¼ç¾',
                        'HEART 0-3åˆ†å¯æœ‰æ•ˆè­˜åˆ¥ä½é¢¨éšªæ‚£è€…',
                        'ä½é¢¨éšªæ‚£è€…å¯ä½¿ç”¨åŠ é€Ÿè¨ºæ–·æµç¨‹'
                    ]
                }
            }
        ]
    }
];

const quiz = [
    {
        q: 'æ ¹æ“šJAMAç³»çµ±æ€§å›é¡§ï¼Œæ€¥è¨ºèƒ¸ç—›æ‚£è€…ä¸­æœ€çµ‚è¨ºæ–·ç‚ºACSçš„æ¯”ä¾‹ç´„ç‚ºå¤šå°‘ï¼Ÿ',
        o: ['ç´„5%', 'ç´„13%', 'ç´„25%', 'ç´„40%'],
        c: 1,
        e: 'ç´å…¥ç ”ç©¶çš„æ€¥è¨ºèƒ¸ç—›æ‚£è€…ä¸­ï¼ŒACSçš„ç››è¡Œç‡ä¸­ä½æ•¸ç‚º14% (IQR 10%-20%)ï¼Œç¶œåˆä¼°è¨ˆç´„13% (95% CI, 11%-16%)ã€‚'
    },
    {
        q: 'ä¸‹åˆ—å“ªå€‹å±éšªå› å­å°æ–¼é æ¸¬ACSå…·æœ‰æœ€é«˜çš„é™½æ€§ä¼¼ç„¶æ¯”(LR+)ï¼Ÿ',
        o: ['ç³–å°¿ç—…å²', 'æ›¾æœ‰ç•°å¸¸å£“åŠ›æ¸¬è©¦', 'é«˜è¡€å£“', 'å®¶æ—å† å¿ƒç—…å²'],
        c: 1,
        e: 'æ›¾æœ‰ç•°å¸¸å£“åŠ›æ¸¬è©¦çš„LR+ = 3.1 (95% CI, 2.0-4.7)ï¼Œç‰¹ç•°åº¦96%ï¼Œæ˜¯å±éšªå› å­ä¸­é æ¸¬ACSæœ€å¼·çš„æŒ‡æ¨™ã€‚'
    },
    {
        q: 'é—œæ–¼èƒ¸ç—›ç‰¹å¾µï¼Œä¸‹åˆ—ä½•è€…å°ACSçš„è¨ºæ–·åƒ¹å€¼æœ€é«˜ï¼Ÿ',
        o: ['ç–¼ç—›æ”¾å°„è‡³å·¦è‡‚', 'ç–¼ç—›æ”¾å°„è‡³é›™å´ä¸Šè‚¢', 'å£“è¿«æ„Ÿèƒ¸ç—›', 'ä¼´éš¨å‘¼å¸å›°é›£'],
        c: 1,
        e: 'ç–¼ç—›æ”¾å°„è‡³é›™å´ä¸Šè‚¢çš„LR+ = 2.6 (95% CI, 1.8-3.7)ï¼Œç‰¹ç•°åº¦96%ï¼Œæ˜¯ç—‡ç‹€ä¸­é æ¸¬ACSæœ€å¼·çš„ç‰¹å¾µã€‚'
    },
    {
        q: 'ç¡åŒ–ç”˜æ²¹ç·©è§£èƒ¸ç—›å°æ–¼ACSçš„è¨ºæ–·æ„ç¾©ç‚ºä½•ï¼Ÿ',
        o: ['å¼·çƒˆæ”¯æŒACSè¨ºæ–·', 'å¼·çƒˆæ’é™¤ACSè¨ºæ–·', 'LRæ¥è¿‘1.0ï¼Œè¨ºæ–·åƒ¹å€¼æœ‰é™', 'åƒ…å°ä¸ç©©å®šå¿ƒçµç—›æœ‰åƒ¹å€¼'],
        c: 2,
        e: 'ç¡åŒ–ç”˜æ²¹ç·©è§£èƒ¸ç—›çš„LR+ = 1.1ï¼Œç„¡ç·©è§£çš„LR- = 0.90ï¼Œå…©è€…å‡æ¥è¿‘1.0ï¼Œå°ACSè¨ºæ–·å¹¾ä¹æ²’æœ‰å¹«åŠ©ã€‚'
    },
    {
        q: 'ä¸‹åˆ—å“ªå€‹ç†å­¸æª¢æŸ¥ç™¼ç¾å°æ–¼é™ä½ACSå¯èƒ½æ€§æœ€æœ‰åƒ¹å€¼ï¼Ÿ',
        o: ['å¿ƒæéé€Ÿ', 'ä½è¡€å£“', 'è‚ºå›‰éŸ³', 'è§¸è¨ºå¯é‡ç¾ç–¼ç—›'],
        c: 3,
        e: 'è§¸è¨ºå¯é‡ç¾ç–¼ç—›çš„LR = 0.28 (95% CI, 0.14-0.54)ï¼Œæ˜¯æ‰€æœ‰å±éšªå› å­ã€ç—‡ç‹€å’Œå¾µè±¡ä¸­æœ€èƒ½é™ä½ACSå¯èƒ½æ€§çš„ç™¼ç¾ã€‚'
    },
    {
        q: 'é—œæ–¼å¿ƒé›»åœ–åœ¨ACSè¨ºæ–·çš„åƒ¹å€¼ï¼Œä½•è€…æ­£ç¢ºï¼Ÿ',
        o: ['æ­£å¸¸å¿ƒé›»åœ–å¯æ’é™¤ACS', 'STæ®µä¸‹é™çš„LR+ = 5.3', 'Tæ³¢å€’ç½®æ¯”STæ®µä¸‹é™æ›´æœ‰è¨ºæ–·åƒ¹å€¼', 'å¿ƒé›»åœ–æ•æ„Ÿåº¦è¶…é80%'],
        c: 1,
        e: 'STæ®µä¸‹é™çš„LR+ = 5.3 (95% CI, 2.1-8.6)ï¼Œç‰¹ç•°åº¦95%ï¼Œæ˜¯å¿ƒé›»åœ–ç™¼ç¾ä¸­æœ€æœ‰åƒ¹å€¼çš„æŒ‡æ¨™ã€‚ä½†æ•æ„Ÿåº¦åƒ…25%ï¼Œæ­£å¸¸å¿ƒé›»åœ–ä¸èƒ½æ’é™¤ACSã€‚'
    },
    {
        q: 'HEARTè©•åˆ†ç‚º0-3åˆ†æ™‚ï¼Œå°æ–¼ACSçš„è¨ºæ–·æ„ç¾©ç‚ºä½•ï¼Ÿ',
        o: ['LR = 0.20ï¼Œå¯æœ‰æ•ˆé™ä½ACSå¯èƒ½æ€§', 'LR = 0.50ï¼Œä¸­ç­‰é™ä½å¯èƒ½æ€§', 'LRæ¥è¿‘1.0ï¼Œç„¡è¨ºæ–·åƒ¹å€¼', 'LR > 2.0ï¼Œå¢åŠ ACSå¯èƒ½æ€§'],
        c: 0,
        e: 'HEARTè©•åˆ†0-3åˆ†çš„LR = 0.20 (95% CI, 0.13-0.30)ï¼Œä»¥13%å‰æ¸¬æ©Ÿç‡è¨ˆç®—ï¼Œå¾Œæ¸¬æ©Ÿç‡é™è‡³2.9%ï¼Œæ˜¯ä½é¢¨éšªè­˜åˆ¥çš„æœ‰æ•ˆå·¥å…·ã€‚'
    },
    {
        q: 'TIMIè©•åˆ†5-7åˆ†æ™‚ï¼ŒACSçš„å¾Œæ¸¬æ©Ÿç‡ç´„ç‚ºå¤šå°‘ï¼Ÿ(å‡è¨­å‰æ¸¬æ©Ÿç‡13%)',
        o: ['ç´„25%', 'ç´„50%', 'ç´„75%', 'ç´„90%'],
        c: 1,
        e: 'TIMIè©•åˆ†5-7åˆ†çš„LR = 6.8 (95% CI, 5.2-8.9)ï¼Œä»¥13%å‰æ¸¬æ©Ÿç‡è¨ˆç®—ï¼Œå¾Œæ¸¬æ©Ÿç‡å‡è‡³ç´„50%ã€‚'
    },
    {
        q: 'HEARTè©•åˆ†åŒ…å«ä¸‹åˆ—å“ªäº›è¦ç´ ï¼Ÿ',
        o: ['ç—…å²ã€å¿ƒé›»åœ–ã€å¹´é½¡ã€å±éšªå› å­ã€è‚Œéˆ£è›‹ç™½', 'å¹´é½¡ã€æ€§åˆ¥ã€è¡€å£“ã€å¿ƒç‡ã€è‚Œéˆ£è›‹ç™½', 'èƒ¸ç—›ç‰¹å¾µã€å¿ƒé›»åœ–ã€è¡€å£“ã€è‚Œé…¸æ¿€é…¶', 'å±éšªå› å­ã€ç—‡ç‹€ã€å¿ƒé›»åœ–ã€BNP'],
        c: 0,
        e: 'HEARTè©•åˆ†åŒ…å«ï¼šHistory(ç—…å²)ã€ECG(å¿ƒé›»åœ–)ã€Age(å¹´é½¡)ã€Risk factors(å±éšªå› å­)ã€Troponin(è‚Œéˆ£è›‹ç™½)ï¼Œå„é …0-2åˆ†ï¼Œç¸½åˆ†0-10åˆ†ã€‚'
    },
    {
        q: 'é—œæ–¼è‡¨åºŠæ±ºç­–è¦å‰‡çš„ä½¿ç”¨ï¼Œä½•è€…æ­£ç¢ºï¼Ÿ',
        o: ['å–®ç¨çš„ç—…å²å’Œç†å­¸æª¢æŸ¥å¯æ’é™¤ACS', 'HEARTå’ŒTIMIè©•åˆ†è¡¨ç¾ç›¸è¿‘', 'ä½é¢¨éšªè©•åˆ†å¯é”åˆ°<1%çš„æ¼è¨ºç‡', 'è©•åˆ†å·¥å…·å¯å–ä»£é€£çºŒè‚Œéˆ£è›‹ç™½æª¢æ¸¬'],
        c: 1,
        e: 'HEARTå’ŒTIMIè©•åˆ†åœ¨è­˜åˆ¥é«˜é¢¨éšª(LR 13 vs 6.8)å’Œä½é¢¨éšªæ‚£è€…(LR 0.20 vs 0.31)çš„è¡¨ç¾ç›¸è¿‘ã€‚ä½†å–®æ¬¡è©•åˆ†å¯èƒ½ç„¡æ³•é”åˆ°<1%æ¼è¨ºç‡ï¼Œä»éœ€çµåˆé€£çºŒæª¢æ¸¬ã€‚'
    }
];

// Badge notification toast component
const BadgeToast = ({ badges, onClose }) => {
    if (!badges || badges.length === 0) return null;
    return (
        <div style={{position:'fixed',top:20,right:20,zIndex:9999,display:'flex',flexDirection:'column',gap:10}}>
            {badges.map((badgeId, i) => {
                const badge = badgeDefs[badgeId];
                if (!badge) return null;
                return (
                    <div key={badgeId} style={{
                        background:'linear-gradient(135deg, #FFD700, #FFA500)',
                        padding:'16px 20px',borderRadius:16,boxShadow:'0 8px 32px rgba(0,0,0,0.2)',
                        display:'flex',alignItems:'center',gap:12,animation:'slideIn 0.5s ease-out',minWidth:240
                    }}>
                        <span style={{fontSize:36}}>{badge.icon}</span>
                        <div style={{flex:1}}>
                            <div style={{fontSize:12,fontWeight:600,color:'#5D4037'}}>æ–°æˆå°±è§£é–!</div>
                            <div style={{fontSize:16,fontWeight:700,color:'#3E2723'}}>{badge.name}</div>
                        </div>
                        <button onClick={()=>onClose(badgeId)} style={{background:'rgba(0,0,0,0.1)',border:'none',borderRadius:8,width:28,height:28,cursor:'pointer',fontSize:14}}>âœ•</button>
                    </div>
                );
            })}
            <style>{`@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}`}</style>
        </div>
    );
};

const App = () => {
    const [page, setPage] = useState('home');
    const [lessonId, setLessonId] = useState(1);
    const [qIdx, setQIdx] = useState(0);
    const [score, setScore] = useState(0);
    const [sel, setSel] = useState(null);
    const [show, setShow] = useState(false);
    const [done, setDone] = useState(false);
    const [quizStartTime, setQuizStartTime] = useState(null);
    const [newBadges, setNewBadges] = useState([]);
    // Case-based learning states
    const [caseId, setCaseId] = useState(1);
    const [caseStep, setCaseStep] = useState(0);
    const [caseScore, setCaseScore] = useState(0);
    const [caseAnswers, setCaseAnswers] = useState({});

    useEffect(() => { if (page === 'quiz' && !done && !quizStartTime) setQuizStartTime(Date.now()) }, [page, done]);
    useEffect(() => {
        if (done && quizStartTime) {
            const t = Math.round((Date.now() - quizStartTime) / 1000);
            ProgressTracker.saveQuizResult(MODULE_ID, score, quiz.length, t);
            if (ProgressTracker.newBadges.length > 0) {
                setNewBadges(ProgressTracker.newBadges);
                setTimeout(() => setNewBadges([]), 5000);
            }
        }
    }, [done]);

    const Header = ({ title }) => (
        <header style={{ 
            background: '#fff', 
            borderBottom: '1px solid rgba(198, 40, 40, 0.1)', 
            padding: '14px 16px', 
            position: 'sticky', 
            top: 0, 
            zIndex: 10,
            backdropFilter: 'blur(10px)'
        }}>
            <div style={{ maxWidth: 480, margin: '0 auto', display: 'flex', alignItems: 'center', gap: 12 }}>
                <button 
                    onClick={() => page === 'home' ? window.location.href = 'jama-rational-exam.html' : setPage('home')} 
                    style={{ 
                        background: 'linear-gradient(135deg, #FFEBEE, #FFCDD2)', 
                        border: 'none', 
                        borderRadius: 12, 
                        width: 42, 
                        height: 42, 
                        cursor: 'pointer', 
                        color: 'var(--pri)', 
                        display: 'flex', 
                        alignItems: 'center', 
                        justifyContent: 'center',
                        boxShadow: '0 2px 8px rgba(198, 40, 40, 0.1)'
                    }}
                >
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                </button>
                <span style={{ fontWeight: 700, color: 'var(--txt)', fontSize: 16 }}>{title}</span>
            </div>
        </header>
    );

    const Home = () => (
        <div className="fade-in">
            <Header title="èƒ¸ç—›èˆ‡ACSè©•ä¼°" />
            <div style={{ 
                background: 'linear-gradient(135deg, #C62828 0%, #AD1457 50%, #6A1B9A 100%)', 
                padding: '36px 20px 44px', 
                color: '#fff',
                position: 'relative',
                overflow: 'hidden'
            }}>
                <div style={{
                    position: 'absolute',
                    top: -30,
                    right: -30,
                    width: 150,
                    height: 150,
                    borderRadius: '50%',
                    background: 'rgba(255,255,255,0.1)'
                }} />
                <div style={{ maxWidth: 480, margin: '0 auto', position: 'relative', zIndex: 1 }}>
                    <div style={{ 
                        background: 'rgba(255,255,255,0.2)', 
                        display: 'inline-block', 
                        padding: '8px 16px', 
                        borderRadius: 50, 
                        fontSize: 12, 
                        fontWeight: 600, 
                        marginBottom: 16,
                        backdropFilter: 'blur(10px)'
                    }}>
                        â¤ï¸ JAMA Rational Clinical Examination
                    </div>
                    <h1 style={{ fontSize: 24, fontWeight: 700, marginBottom: 12, lineHeight: 1.3 }}>
                        Does This Patient Have Acute Coronary Syndrome?
                    </h1>
                    <p style={{ opacity: 0.95, fontSize: 14, lineHeight: 1.7 }}>
                        èƒ¸ç—›æ‚£è€…çš„æ€¥æ€§å† å¿ƒç—‡å€™ç¾¤è‡¨åºŠè©•ä¼°
                    </p>
                    <p style={{ opacity: 0.8, fontSize: 12, marginTop: 8 }}>
                        Fanaroff AC, et al. JAMA. 2015;314(18):1955-1965
                    </p>
                    <a 
                        href="https://jamanetwork.com/journals/jama/fullarticle/2468896" 
                        target="_blank" 
                        rel="noopener noreferrer"
                        style={{
                            display:'inline-flex',
                            alignItems:'center',
                            gap:6,
                            background:'rgba(255,255,255,0.25)',
                            color:'#fff',
                            padding:'8px 16px',
                            borderRadius:25,
                            fontSize:13,
                            fontWeight:600,
                            textDecoration:'none',
                            backdropFilter:'blur(10px)',
                            marginTop: 12,
                            transition:'all 0.3s'
                        }}
                    >
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16"><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/></svg>
                        é–±è®€åŸæ–‡ Read Full Article
                    </a>
                </div>
            </div>
            
            <div style={{ padding: '0 16px', marginTop: -24 }}>
                <div style={{ maxWidth: 480, margin: '0 auto' }}>
                    <div className="card">
                        <h3 style={{ fontSize: 17, fontWeight: 700, color: 'var(--pri)', marginBottom: 14, display: 'flex', alignItems: 'center', gap: 8 }}>
                            <span style={{ fontSize: 22 }}>ğŸ¯</span> å­¸ç¿’ç›®æ¨™
                        </h3>
                        {[
                            'äº†è§£ACSçš„è‡¨åºŠåˆ†é¡èˆ‡æµè¡Œç—…å­¸',
                            'æŒæ¡ç—…å²å’Œç—‡ç‹€å°ACSçš„è¨ºæ–·åƒ¹å€¼',
                            'ç†Ÿæ‚‰HEARTèˆ‡TIMIé¢¨éšªè©•åˆ†ç³»çµ±',
                            'å­¸ç¿’æ•´åˆè‡¨åºŠè³‡è¨Šé€²è¡Œé¢¨éšªåˆ†å±¤'
                        ].map((t, i) => (
                            <div key={i} style={{ display: 'flex', gap: 12, marginBottom: 10, fontSize: 14 }}>
                                <span style={{ 
                                    background: 'linear-gradient(135deg, var(--suc), #43A047)', 
                                    color: '#fff', 
                                    borderRadius: 8, 
                                    width: 26, 
                                    height: 26, 
                                    display: 'flex', 
                                    alignItems: 'center', 
                                    justifyContent: 'center', 
                                    fontSize: 13, 
                                    flexShrink: 0,
                                    fontWeight: 600
                                }}>{i + 1}</span>
                                <span style={{ color: 'var(--txt2)', lineHeight: 1.6 }}>{t}</span>
                            </div>
                        ))}
                    </div>

                    <div className="danger" style={{ marginBottom: 20 }}>
                        <strong style={{ color: 'var(--danger)', display: 'flex', alignItems: 'center', gap: 6 }}>
                            âš ï¸ è‡¨åºŠé‡è¦æ€§
                        </strong>
                        <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                            æ¯å¹´è¶…é800è¬ç¾åœ‹äººå› æ€¥æ€§èƒ¸ç—›è‡³æ€¥è¨ºå°±é†«ï¼Œä½†åƒ…ç´„10-13%æœ€çµ‚è¨ºæ–·ç‚ºACSã€‚æº–ç¢ºçš„é¢¨éšªåˆ†å±¤å¯é¿å…ä½é¢¨éšªæ‚£è€…ä¸å¿…è¦çš„ä½é™¢ï¼ŒåŒæ™‚ç¢ºä¿é«˜é¢¨éšªæ‚£è€…ç²å¾—åŠæ™‚æ²»ç™‚ã€‚
                        </p>
                    </div>

                    <h3 style={{ fontSize: 18, fontWeight: 700, marginBottom: 16, color: 'var(--txt)' }}>ğŸ“š èª²ç¨‹å…§å®¹</h3>
                    {lessons.map(l => (
                        <div 
                            key={l.id} 
                            className="card" 
                            onClick={() => { setLessonId(l.id); setPage('lesson'); }} 
                            style={{ cursor: 'pointer', transition: 'all 0.3s ease' }}
                        >
                            <div style={{ display: 'flex', alignItems: 'center', gap: 16 }}>
                                <div style={{ 
                                    width: 52, 
                                    height: 52, 
                                    borderRadius: 14, 
                                    background: `linear-gradient(135deg, ${l.color}, ${l.color}99)`, 
                                    display: 'flex', 
                                    alignItems: 'center', 
                                    justifyContent: 'center', 
                                    color: '#fff', 
                                    fontWeight: 700,
                                    fontSize: 18,
                                    boxShadow: `0 4px 12px ${l.color}33`
                                }}>{l.id}</div>
                                <div style={{ flex: 1 }}>
                                    <div style={{ fontSize: 11, color: l.color, fontWeight: 600, marginBottom: 2 }}>Lesson {l.id}</div>
                                    <div style={{ fontSize: 16, fontWeight: 700, color: 'var(--txt)' }}>{l.title}</div>
                                    <div style={{ fontSize: 13, color: 'var(--txt2)' }}>{l.sub}</div>
                                </div>
                                <svg viewBox="0 0 24 24" fill={l.color} width="22" height="22">
                                    <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/>
                                </svg>
                            </div>
                        </div>
                    ))}
                    
                    <button
                        className="btn btn-sec"
                        onClick={() => setPage('cases')}
                        style={{ width: '100%', justifyContent: 'center', marginTop: 24, marginBottom: 12, padding: '16px 24px' }}
                    >
                        ğŸ¥ è‡¨åºŠæ¡ˆä¾‹æ¼”ç·´ (2å€‹æ¡ˆä¾‹)
                    </button>

                    <button
                        className="btn btn-pri"
                        onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); setPage('quiz'); }}
                        style={{ width: '100%', justifyContent: 'center', marginBottom: 16, padding: '16px 24px' }}
                    >
                        ğŸ“ é–‹å§‹æ¸¬é©— (10é¡Œ)
                    </button>

                    <a 
                        href="https://jamanetwork.com/journals/jama/fullarticle/2468896"
                        target="_blank"
                        rel="noopener noreferrer"
                        style={{
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            gap: 8,
                            padding: '14px 20px',
                            background: 'linear-gradient(135deg, #F8F9FA, #E9ECEF)',
                            borderRadius: 14,
                            textDecoration: 'none',
                            color: 'var(--pri)',
                            fontSize: 14,
                            fontWeight: 600,
                            marginBottom: 32,
                            border: '1px solid rgba(198, 40, 40, 0.2)'
                        }}
                    >
                        ğŸ“„ é–±è®€åŸæ–‡ (JAMA 2015)
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                        </svg>
                    </a>
                </div>
            </div>
            
            <footer style={{ background: 'linear-gradient(135deg, #FFEBEE, #FFCDD2)', padding: '28px 16px', textAlign: 'center' }}>
                <p style={{ fontSize: 13, color: 'var(--txt2)', fontWeight: 600 }}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨</p>
                <p style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 4 }}>è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
            </footer>
        </div>
    );

    // Lesson 1: ACSæ¦‚è«–èˆ‡è‡¨åºŠåˆ†é¡
    const L1 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>â¤ï¸ ä»€éº¼æ˜¯æ€¥æ€§å† å¿ƒç—‡å€™ç¾¤(ACS)ï¼Ÿ</h3>
                <div className="formula">
                    ACS = STEMI + NSTEMI + ä¸ç©©å®šå¿ƒçµç—› (Unstable Angina)
                </div>
                <p style={{ fontSize: 14, color: 'var(--txt2)', lineHeight: 1.8 }}>
                    æ€¥æ€§å† å¿ƒç—‡å€™ç¾¤æ˜¯ä¸€çµ„ç”±å† ç‹€å‹•è„ˆæ€¥æ€§è¡€æµæ¸›å°‘å¼•èµ·çš„è‡¨åºŠç—‡å€™ç¾¤ï¼ŒåŒ…æ‹¬STæ®µä¸Šå‡å‹å¿ƒè‚Œæ¢—å¡(STEMI)ã€éSTæ®µä¸Šå‡å‹å¿ƒè‚Œæ¢—å¡(NSTEMI)å’Œä¸ç©©å®šå¿ƒçµç—›ã€‚
                </p>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ“Š ACSçš„è‡¨åºŠåˆ†é¡</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é¡å‹</th>
                            <th>å¿ƒé›»åœ–</th>
                            <th>è‚Œéˆ£è›‹ç™½</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--danger)' }}>STEMI</td>
                            <td>STæ®µä¸Šå‡</td>
                            <td>å‡é«˜</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--pri)' }}>NSTEMI</td>
                            <td>STæ®µä¸‹é™/Tæ³¢å€’ç½®/æ­£å¸¸</td>
                            <td>å‡é«˜</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--warn)' }}>ä¸ç©©å®šå¿ƒçµç—›</td>
                            <td>STæ®µä¸‹é™/Tæ³¢å€’ç½®/æ­£å¸¸</td>
                            <td>æ­£å¸¸</td>
                        </tr>
                    </tbody>
                </table>
                <div className="info">
                    <strong>ğŸ’¡ è‡¨åºŠè¦é»</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        STEMIå¯ç”±å¿ƒé›»åœ–ç«‹å³è¨ºæ–·ï¼Œä½”ACSä¸åˆ°25%ã€‚å¤§å¤šæ•¸æ‚£è€…éœ€è¦å€åˆ†çš„æ˜¯NSTE-ACSï¼ˆåŒ…æ‹¬NSTEMIå’Œä¸ç©©å®šå¿ƒçµç—›ï¼‰èˆ‡éå¿ƒå› æ€§èƒ¸ç—›ã€‚
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>ğŸ“ˆ æµè¡Œç—…å­¸æ•¸æ“š</h3>
                <div className="danger">
                    <strong>é—œéµçµ±è¨ˆ</strong>
                    <ul style={{ marginTop: 8, marginLeft: 16, color: 'var(--txt2)', fontSize: 14 }}>
                        <li>æ¯å¹´è¶…é<strong>800è¬</strong>ç¾åœ‹äººå› æ€¥æ€§èƒ¸ç—›è‡³æ€¥è¨º</li>
                        <li>æœ€çµ‚è¨ºæ–·ç‚ºACSçš„æ¯”ä¾‹ï¼š<strong>ç´„10-13%</strong></li>
                        <li>ç ”ç©¶ä¸­ACSç››è¡Œç‡ä¸­ä½æ•¸ï¼š<strong>14%</strong> (IQR 10%-20%)</li>
                        <li>æ€¥è¨ºèƒ¸ç—›èª¤è¨ºå‡ºé™¢å¾Œçš„ACSç‡ï¼š<strong>2.2%</strong></li>
                    </ul>
                </div>
                <div className="tip">
                    <strong>âš ï¸ è‡¨åºŠæ„æ¶µ</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        å¤šæ•¸æ€¥è¨ºé†«å¸«æœŸæœ›ACSæ¼è¨ºç‡ä½æ–¼1%ã€‚å–®ç¨çš„è‡¨åºŠå°è±¡æ•æ„Ÿåº¦ä¸è¶³ä»¥é”åˆ°é€™å€‹æ¨™æº–ï¼Œéœ€è¦çµåˆè©•åˆ†å·¥å…·å’Œé€£çºŒæª¢æ¸¬ã€‚
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: '#6A1B9A', marginBottom: 14 }}>ğŸ”¬ å¿ƒè‚Œæ¢—å¡çš„å®šç¾©</h3>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginBottom: 12, lineHeight: 1.8 }}>
                    æ ¹æ“šç¬¬ä¸‰ç‰ˆé€šç”¨å®šç¾©ï¼Œå¿ƒè‚Œæ¢—å¡éœ€è¦ï¼š
                </p>
                <div style={{ display: 'grid', gap: 10 }}>
                    <div style={{ 
                        background: 'linear-gradient(135deg, #F3E5F5, #E1BEE7)', 
                        padding: '12px 16px', 
                        borderRadius: 12,
                        fontSize: 14
                    }}>
                        <strong>1.</strong> å¿ƒè‚Œè‚Œéˆ£è›‹ç™½è‡³å°‘ä¸€æ¬¡è¶…éç¬¬99ç™¾åˆ†ä½åƒè€ƒä¸Šé™ï¼Œä¸”æœ‰å…¸å‹å‡é™è®ŠåŒ–
                    </div>
                    <div style={{ 
                        background: 'linear-gradient(135deg, #F3E5F5, #E1BEE7)', 
                        padding: '12px 16px', 
                        borderRadius: 12,
                        fontSize: 14
                    }}>
                        <strong>2.</strong> åŠ ä¸Šä»¥ä¸‹ä»»ä¸€é …ï¼šç¼ºè¡€ç—‡ç‹€ã€å¿ƒé›»åœ–ç¼ºè¡€è®ŠåŒ–ã€å½±åƒå­¸å¿ƒè‚Œæ´»åŠ›å–ªå¤±ã€å† ç‹€å‹•è„ˆè¡€æ “
                    </div>
                </div>
            </div>
        </div>
    );

    // Lesson 2: å±éšªå› å­èˆ‡ç—‡ç‹€è©•ä¼°
    const L2 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ“‹ å±éšªå› å­çš„è¨ºæ–·åƒ¹å€¼</h3>
                <table>
                    <thead>
                        <tr>
                            <th>å±éšªå› å­</th>
                            <th>LR+ (95% CI)</th>
                            <th>LR-</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 600 }}>æ›¾æœ‰ç•°å¸¸å£“åŠ›æ¸¬è©¦</td>
                            <td><span className="lr-badge lr-high">3.1 (2.0-4.7)</span></td>
                            <td>0.92</td>
                        </tr>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 600 }}>å‘¨é‚Šå‹•è„ˆç–¾ç—…</td>
                            <td><span className="lr-badge lr-mod">2.7 (1.5-4.8)</span></td>
                            <td>0.96</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>å·²çŸ¥å† å¿ƒç—…</td>
                            <td><span className="lr-badge lr-mod">2.0 (1.4-2.6)</span></td>
                            <td>0.75</td>
                        </tr>
                        <tr>
                            <td>æ›¾æœ‰å¿ƒè‚Œæ¢—å¡</td>
                            <td>1.6 (1.4-1.7)</td>
                            <td>0.88</td>
                        </tr>
                        <tr>
                            <td>ç³–å°¿ç—…</td>
                            <td>1.4 (1.3-1.6)</td>
                            <td>0.90</td>
                        </tr>
                        <tr>
                            <td>é«˜è¡€è„‚</td>
                            <td>1.3 (1.1-1.5)</td>
                            <td>0.85</td>
                        </tr>
                        <tr>
                            <td>é«˜è¡€å£“</td>
                            <td>1.2 (1.1-1.3)</td>
                            <td>0.78</td>
                        </tr>
                        <tr>
                            <td>å¸è¸</td>
                            <td>1.1 (0.9-1.3)</td>
                            <td>0.96</td>
                        </tr>
                        <tr>
                            <td>å®¶æ—å† å¿ƒç—…å²</td>
                            <td>1.0 (0.9-1.2)</td>
                            <td>0.99</td>
                        </tr>
                    </tbody>
                </table>
                <div className="tip">
                    <strong>ğŸ’¡ è‡¨åºŠè§£è®€</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        å‚³çµ±å¿ƒè¡€ç®¡å±éšªå› å­ï¼ˆé«˜è¡€å£“ã€ç³–å°¿ç—…ã€å¸è¸ã€å®¶æ—å²ï¼‰å°ACSçš„è¨ºæ–·åƒ¹å€¼æœ‰é™ï¼ŒLR+å¤šæ¥è¿‘1.0ã€‚æ²’æœ‰ä»»ä½•å–®ä¸€å±éšªå› å­ç¼ºä¹æ™‚å¯æœ‰æ•ˆæ’é™¤ACSã€‚
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ¤• ç—‡ç‹€ç‰¹å¾µçš„è¨ºæ–·åƒ¹å€¼</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ç—‡ç‹€ç‰¹å¾µ</th>
                            <th>LR+ (95% CI)</th>
                            <th>ç‰¹ç•°åº¦</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FCE4EC' }}>
                            <td style={{ fontWeight: 700, color: 'var(--sec)' }}>æ”¾å°„è‡³é›™å´ä¸Šè‚¢</td>
                            <td><span className="lr-badge lr-high">2.6 (1.8-3.7)</span></td>
                            <td>96%</td>
                        </tr>
                        <tr style={{ background: '#FCE4EC' }}>
                            <td style={{ fontWeight: 600 }}>ç–¼ç—›é¡ä¼¼éå»ç¼ºè¡€ç™¼ä½œ</td>
                            <td><span className="lr-badge lr-mod">2.2 (2.0-2.6)</span></td>
                            <td>79%</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>éå»24å°æ™‚ç–¼ç—›å‹æ…‹æ”¹è®Š</td>
                            <td><span className="lr-badge lr-mod">2.0 (1.6-2.4)</span></td>
                            <td>86%</td>
                        </tr>
                        <tr>
                            <td>ã€Œå…¸å‹ã€èƒ¸ç—›</td>
                            <td>1.9 (0.94-2.9)</td>
                            <td>66%</td>
                        </tr>
                        <tr>
                            <td>æ”¾å°„è‡³é ¸éƒ¨æˆ–ä¸‹é¡</td>
                            <td>1.5 (1.3-1.8)</td>
                            <td>84%</td>
                        </tr>
                        <tr>
                            <td>æ”¾å°„è‡³å·¦è‡‚</td>
                            <td>1.3 (1.2-1.4)</td>
                            <td>69%</td>
                        </tr>
                        <tr>
                            <td>ä¼´éš¨å‘¼å¸å›°é›£</td>
                            <td>1.2 (1.1-1.3)</td>
                            <td>61%</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--danger)', marginBottom: 14 }}>âŒ é™ä½ACSå¯èƒ½æ€§çš„ç—‡ç‹€</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ç—‡ç‹€ç‰¹å¾µ</th>
                            <th>LR+</th>
                            <th>è‡¨åºŠæ„ç¾©</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style={{ fontWeight: 600, color: 'var(--suc)' }}>è‚‹è†œæ€§èƒ¸ç—›</td>
                            <td><span className="lr-badge lr-low">0.35-0.61</span></td>
                            <td>é™ä½ACSå¯èƒ½æ€§</td>
                        </tr>
                        <tr>
                            <td>ä¼´éš¨æ˜å¥</td>
                            <td>0.55</td>
                            <td>ç•¥é™ä½å¯èƒ½æ€§</td>
                        </tr>
                    </tbody>
                </table>
                <div className="danger" style={{ marginTop: 14 }}>
                    <strong>ğŸš¨ ç¡åŒ–ç”˜æ²¹çš„è¿·æ€</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        ç¡åŒ–ç”˜æ²¹ç·©è§£èƒ¸ç—› LR+ = 1.1<br/>
                        ç¡åŒ–ç”˜æ²¹ç„¡æ³•ç·©è§£ LR- = 0.90<br/><br/>
                        <strong>çµè«–ï¼šç¡åŒ–ç”˜æ²¹åæ‡‰å°ACSè¨ºæ–·å¹¾ä¹æ²’æœ‰å¹«åŠ©ï¼</strong>
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>ğŸ‘¨â€âš•ï¸ è‡¨åºŠå°è±¡çš„åƒ¹å€¼</h3>
                <p style={{ fontSize: 14, color: 'var(--txt2)', marginBottom: 12, lineHeight: 1.8 }}>
                    ä¸€é …ç´å…¥458åæ‚£è€…çš„ç ”ç©¶è©•ä¼°äº†é†«å¸«åœ¨çœ‹åˆ°å¿ƒé›»åœ–å’Œè‚Œéˆ£è›‹ç™½çµæœå‰çš„è‡¨åºŠå°è±¡ï¼š
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>è‡¨åºŠå°è±¡</th>
                            <th>LR (95% CI)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ã€Œè‚¯å®šæ˜¯ã€ACS</td>
                            <td><span className="lr-badge lr-high">4.0 (2.5-6.6)</span></td>
                        </tr>
                        <tr>
                            <td>ã€Œå¯èƒ½æ˜¯ã€ACS</td>
                            <td>1.8 (1.3-2.4)</td>
                        </tr>
                        <tr>
                            <td>ã€Œæœ‰å¯èƒ½ã€ACS</td>
                            <td>0.66 (0.46-0.96)</td>
                        </tr>
                        <tr>
                            <td>ã€Œå¯èƒ½ä¸æ˜¯ã€ACS</td>
                            <td><span className="lr-badge lr-low">0.20 (0.09-0.44)</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    );

    // Lesson 3: ç†å­¸æª¢æŸ¥èˆ‡å¿ƒé›»åœ–
    const L3 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ” ç†å­¸æª¢æŸ¥ç™¼ç¾</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ç†å­¸æª¢æŸ¥</th>
                            <th>LR+ (95% CI)</th>
                            <th>LR-</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style={{ fontWeight: 600 }}>ä½è¡€å£“ (SBP&lt;100)</td>
                            <td>3.9 (0.98-15)</td>
                            <td>0.98</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>è‚ºå›‰éŸ³</td>
                            <td>2.0 (1.0-4.0)</td>
                            <td>0.95</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>å‘¼å¸æ€¥ä¿ƒ</td>
                            <td>1.9 (0.99-3.5)</td>
                            <td>0.95</td>
                        </tr>
                        <tr>
                            <td>å¿ƒæéé€Ÿ (HR&gt;120)</td>
                            <td>1.3 (0.42-3.94)</td>
                            <td>0.99</td>
                        </tr>
                        <tr style={{ background: '#E8F5E9' }}>
                            <td style={{ fontWeight: 700, color: 'var(--suc)' }}>è§¸è¨ºå¯é‡ç¾ç–¼ç—›</td>
                            <td><span className="lr-badge lr-low">0.28 (0.14-0.54)</span></td>
                            <td>1.2</td>
                        </tr>
                    </tbody>
                </table>
                <div className="good">
                    <strong>âœ“ æœ€æœ‰åƒ¹å€¼çš„ç™¼ç¾</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        <strong>è§¸è¨ºå¯é‡ç¾ç–¼ç—›</strong>æ˜¯æ‰€æœ‰å±éšªå› å­ã€ç—‡ç‹€å’Œå¾µè±¡ä¸­æœ€èƒ½é™ä½ACSå¯èƒ½æ€§çš„ç™¼ç¾ (LR = 0.28)ã€‚
                        ä½†è«‹æ³¨æ„ï¼šé€™ä»ä¸èƒ½å®Œå…¨æ’é™¤ACSï¼
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ“ˆ å¿ƒé›»åœ–çš„è¨ºæ–·åƒ¹å€¼</h3>
                <table>
                    <thead>
                        <tr>
                            <th>å¿ƒé›»åœ–ç™¼ç¾</th>
                            <th>æ•æ„Ÿåº¦</th>
                            <th>ç‰¹ç•°åº¦</th>
                            <th>LR+</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 700, color: 'var(--danger)' }}>STæ®µä¸‹é™</td>
                            <td>25%</td>
                            <td>95%</td>
                            <td><span className="lr-badge lr-high">5.3 (2.1-8.6)</span></td>
                        </tr>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 600 }}>ç¼ºè¡€æ€§å¿ƒé›»åœ–*</td>
                            <td>32%</td>
                            <td>91%</td>
                            <td><span className="lr-badge lr-high">3.6 (1.6-5.7)</span></td>
                        </tr>
                        <tr>
                            <td>Tæ³¢å€’ç½®</td>
                            <td>24%</td>
                            <td>87%</td>
                            <td>1.8 (1.3-2.7)</td>
                        </tr>
                    </tbody>
                </table>
                <div className="info">
                    <strong>*ç¼ºè¡€æ€§å¿ƒé›»åœ–å®šç¾©</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        åŒ…æ‹¬ï¼šTæ³¢å€’ç½®ã€STæ®µä¸‹é™ã€Qæ³¢ç­‰è®ŠåŒ–
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--danger)', marginBottom: 14 }}>âš ï¸ å¿ƒé›»åœ–çš„é™åˆ¶</h3>
                <div className="danger">
                    <strong>é‡è¦è§€å¿µ</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        å¿ƒé›»åœ–å°ACSçš„<strong>æ•æ„Ÿåº¦åƒ…25-32%</strong>ï¼Œé€™æ„å‘³è‘—ï¼š
                    </p>
                    <ul style={{ marginTop: 8, marginLeft: 16, color: 'var(--txt2)', fontSize: 14 }}>
                        <li>æ­£å¸¸å¿ƒé›»åœ–<strong>ä¸èƒ½æ’é™¤</strong>ACS</li>
                        <li>ç´„68-75%çš„ACSæ‚£è€…å¿ƒé›»åœ–å¯èƒ½æ­£å¸¸æˆ–éç‰¹ç•°æ€§è®ŠåŒ–</li>
                        <li>å¿ƒé›»åœ–ä¸»è¦åƒ¹å€¼åœ¨æ–¼é«˜ç‰¹ç•°åº¦ï¼šç•°å¸¸æ™‚å¼·çƒˆæ”¯æŒACS</li>
                    </ul>
                </div>
                <div className="formula" style={{ marginTop: 14 }}>
                    STæ®µä¸‹é™ï¼šé«˜ç‰¹ç•°åº¦(95%) + ä½æ•æ„Ÿåº¦(25%) = Rule Inå·¥å…·
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>ğŸ’¡ STæ®µä¸‹é™çš„è‡¨åºŠæ„ç¾©</h3>
                <div style={{ 
                    background: 'linear-gradient(135deg, #E3F2FD, #BBDEFB)', 
                    padding: 16, 
                    borderRadius: 12,
                    marginBottom: 12
                }}>
                    <h4 style={{ color: 'var(--info)', marginBottom: 8, fontSize: 15 }}>å¾Œæ¸¬æ©Ÿç‡è¨ˆç®—ç¯„ä¾‹</h4>
                    <p style={{ fontSize: 14, color: 'var(--txt2)' }}>
                        å‰æ¸¬æ©Ÿç‡ 13% + STæ®µä¸‹é™ (LR+ = 5.3)<br/>
                        â†’ å¾Œæ¸¬æ©Ÿç‡ â‰ˆ <strong>44%</strong>
                    </p>
                </div>
                <div className="tip">
                    <strong>è‡¨åºŠæ‡‰ç”¨</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        STæ®µä¸‹é™æ˜¯æ€¥è¨ºæœ€é‡è¦çš„å¿ƒé›»åœ–ç™¼ç¾ï¼Œé¡¯è‘—å¢åŠ ACSå¯èƒ½æ€§ã€‚
                        ä½†ä»éœ€çµåˆè‚Œéˆ£è›‹ç™½å’Œè‡¨åºŠè©•ä¼°åšå‡ºæœ€çµ‚åˆ¤æ–·ã€‚
                    </p>
                </div>
            </div>
        </div>
    );

    // Lesson 4: HEARTèˆ‡TIMIè©•åˆ†
    const L4 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>â¤ï¸ HEARTè©•åˆ†ç³»çµ±</h3>
                <div className="formula">
                    HEART = History + ECG + Age + Risk factors + Troponin (0-10åˆ†)
                </div>
                <div style={{ display: 'grid', gap: 10, marginTop: 14 }}>
                    <div className="score-box">
                        <h4 style={{ color: 'var(--pri)', marginBottom: 8, fontSize: 14 }}>H - History (ç—…å²) 0-2åˆ†</h4>
                        <div style={{ fontSize: 13, color: 'var(--txt2)' }}>
                            0åˆ†ï¼šç—…å²ä¸ç¬¦åˆACS<br/>
                            1åˆ†ï¼šç—…å²å¯èƒ½ç¬¦åˆACS<br/>
                            2åˆ†ï¼šç—…å²å¼·çƒˆæç¤ºACS
                        </div>
                    </div>
                    <div className="score-box">
                        <h4 style={{ color: 'var(--sec)', marginBottom: 8, fontSize: 14 }}>E - ECG (å¿ƒé›»åœ–) 0-2åˆ†</h4>
                        <div style={{ fontSize: 13, color: 'var(--txt2)' }}>
                            0åˆ†ï¼šæ­£å¸¸å¿ƒé›»åœ–<br/>
                            1åˆ†ï¼šéç‰¹ç•°æ€§å†æ¥µåŒ–ç•°å¸¸<br/>
                            2åˆ†ï¼šSTæ®µä¸‹é™æˆ–çŸ­æš«STæ®µä¸Šå‡
                        </div>
                    </div>
                    <div className="score-box">
                        <h4 style={{ color: '#6A1B9A', marginBottom: 8, fontSize: 14 }}>A - Age (å¹´é½¡) 0-2åˆ†</h4>
                        <div style={{ fontSize: 13, color: 'var(--txt2)' }}>
                            0åˆ†ï¼š&lt;45æ­²<br/>
                            1åˆ†ï¼š45-65æ­²<br/>
                            2åˆ†ï¼š&gt;65æ­²
                        </div>
                    </div>
                    <div className="score-box">
                        <h4 style={{ color: 'var(--info)', marginBottom: 8, fontSize: 14 }}>R - Risk factors (å±éšªå› å­) 0-2åˆ†</h4>
                        <div style={{ fontSize: 13, color: 'var(--txt2)' }}>
                            0åˆ†ï¼šç„¡å±éšªå› å­<br/>
                            1åˆ†ï¼š1-2å€‹å±éšªå› å­<br/>
                            2åˆ†ï¼šâ‰¥3å€‹å±éšªå› å­æˆ–å·²çŸ¥å† å¿ƒç—…
                        </div>
                    </div>
                    <div className="score-box">
                        <h4 style={{ color: 'var(--danger)', marginBottom: 8, fontSize: 14 }}>T - Troponin (è‚Œéˆ£è›‹ç™½) 0-2åˆ†</h4>
                        <div style={{ fontSize: 13, color: 'var(--txt2)' }}>
                            0åˆ†ï¼šæ­£å¸¸<br/>
                            1åˆ†ï¼š1-3å€æ­£å¸¸ä¸Šé™<br/>
                            2åˆ†ï¼š&gt;3å€æ­£å¸¸ä¸Šé™
                        </div>
                    </div>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ“Š HEARTè©•åˆ†çš„è¨ºæ–·è¡¨ç¾</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é¢¨éšªå±¤ç´š</th>
                            <th>åˆ†æ•¸ç¯„åœ</th>
                            <th>LR (95% CI)</th>
                            <th>é æ¸¬å€¼*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 700, color: 'var(--danger)' }}>é«˜é¢¨éšª</td>
                            <td>7-10åˆ†</td>
                            <td><span className="lr-badge lr-high">13 (7.0-24)</span></td>
                            <td>66%</td>
                        </tr>
                        <tr style={{ background: '#FFF8E1' }}>
                            <td style={{ fontWeight: 600, color: '#F57F17' }}>ä¸­é¢¨éšª</td>
                            <td>5-6åˆ†</td>
                            <td>2.4 (1.6-3.6)</td>
                            <td>26%</td>
                        </tr>
                        <tr>
                            <td>ä¸ç¢ºå®š</td>
                            <td>4åˆ†</td>
                            <td>0.79 (0.53-1.2)</td>
                            <td>11%</td>
                        </tr>
                        <tr style={{ background: '#E8F5E9' }}>
                            <td style={{ fontWeight: 700, color: 'var(--suc)' }}>ä½é¢¨éšª</td>
                            <td>0-3åˆ†</td>
                            <td><span className="lr-badge lr-low">0.20 (0.13-0.30)</span></td>
                            <td>2.9%</td>
                        </tr>
                    </tbody>
                </table>
                <p style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 8 }}>*å‡è¨­å‰æ¸¬æ©Ÿç‡13%</p>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>ğŸ“‹ TIMIé¢¨éšªè©•åˆ†</h3>
                <div className="formula">
                    TIMI Risk Score (0-7åˆ†) - æ¯é …1åˆ†
                </div>
                <div style={{ display: 'grid', gap: 8, marginTop: 14 }}>
                    {[
                        'å¹´é½¡ â‰¥65æ­²',
                        'â‰¥3å€‹å¿ƒè¡€ç®¡å±éšªå› å­',
                        'å·²çŸ¥å† å¿ƒç—… (ç‹¹çª„â‰¥50%)',
                        'ä½¿ç”¨é˜¿æ–¯åŒ¹éˆ',
                        'éå»24å°æ™‚å…§â‰¥2æ¬¡å¿ƒçµç—›ç™¼ä½œ',
                        'STæ®µåç§» â‰¥0.5mm',
                        'å¿ƒè‚Œæ¨™è¨˜å‡é«˜'
                    ].map((item, i) => (
                        <div key={i} style={{ 
                            background: 'linear-gradient(135deg, #E3F2FD, #BBDEFB)',
                            padding: '10px 14px', 
                            borderRadius: 10,
                            fontSize: 13,
                            display: 'flex',
                            alignItems: 'center',
                            gap: 10
                        }}>
                            <span style={{ 
                                background: 'var(--info)',
                                color: '#fff',
                                borderRadius: '50%',
                                width: 22,
                                height: 22,
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                fontSize: 12,
                                fontWeight: 700,
                                flexShrink: 0
                            }}>{i + 1}</span>
                            {item}
                        </div>
                    ))}
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: '#6A1B9A', marginBottom: 14 }}>ğŸ“Š TIMIè©•åˆ†çš„è¨ºæ–·è¡¨ç¾</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é¢¨éšªå±¤ç´š</th>
                            <th>åˆ†æ•¸ç¯„åœ</th>
                            <th>LR (95% CI)</th>
                            <th>é æ¸¬å€¼*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style={{ background: '#FFEBEE' }}>
                            <td style={{ fontWeight: 700, color: 'var(--danger)' }}>é«˜é¢¨éšª</td>
                            <td>5-7åˆ†</td>
                            <td><span className="lr-badge lr-high">6.8 (5.2-8.9)</span></td>
                            <td>50%</td>
                        </tr>
                        <tr style={{ background: '#FFF8E1' }}>
                            <td style={{ fontWeight: 600, color: '#F57F17' }}>ä¸­é¢¨éšª</td>
                            <td>3-4åˆ†</td>
                            <td>2.4 (2.1-2.7)</td>
                            <td>26%</td>
                        </tr>
                        <tr>
                            <td>ä¸ç¢ºå®š</td>
                            <td>2åˆ†</td>
                            <td>0.94 (0.85-1.0)</td>
                            <td>12%</td>
                        </tr>
                        <tr style={{ background: '#E8F5E9' }}>
                            <td style={{ fontWeight: 700, color: 'var(--suc)' }}>ä½é¢¨éšª</td>
                            <td>0-1åˆ†</td>
                            <td><span className="lr-badge lr-low">0.31 (0.23-0.43)</span></td>
                            <td>4.4%</td>
                        </tr>
                    </tbody>
                </table>
                <p style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 8 }}>*å‡è¨­å‰æ¸¬æ©Ÿç‡13%</p>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--suc)', marginBottom: 14 }}>ğŸ“Š å…©ç¨®è©•åˆ†æ¯”è¼ƒ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ç‰¹æ€§</th>
                            <th>HEART</th>
                            <th>TIMI</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style={{ fontWeight: 600 }}>è¨­è¨ˆç›®çš„</td>
                            <td>è¨ºæ–·ACS</td>
                            <td>é å¾Œ(åŸè¨­è¨ˆ)</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>åˆ†æ•¸ç¯„åœ</td>
                            <td>0-10åˆ†</td>
                            <td>0-7åˆ†</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>é«˜é¢¨éšªLR</td>
                            <td>13</td>
                            <td>6.8</td>
                        </tr>
                        <tr>
                            <td style={{ fontWeight: 600 }}>ä½é¢¨éšªLR</td>
                            <td>0.20</td>
                            <td>0.31</td>
                        </tr>
                    </tbody>
                </table>
                <div className="good">
                    <strong>âœ“ çµè«–</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        HEARTå’ŒTIMIè©•åˆ†åœ¨è­˜åˆ¥é«˜é¢¨éšªå’Œä½é¢¨éšªæ‚£è€…çš„è¡¨ç¾ç›¸è¿‘ã€‚HEARTè©•åˆ†åœ¨ä½é¢¨éšªè­˜åˆ¥ç•¥å„ª(LR 0.20 vs 0.31)ã€‚
                    </p>
                </div>
            </div>
        </div>
    );

    // Lesson 5: è‡¨åºŠæ‡‰ç”¨æ•´åˆ
    const L5 = () => (
        <div className="fade-in">
            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>ğŸ¥ Case 1ï¼š42æ­²å¥³æ€§å…¸å‹èƒ¸ç—›</h3>
                <div className="info">
                    <strong>ç—…å²</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        42æ­²ï¼Œéå»å¥åº·çš„å¥³æ€§ï¼Œå› 45åˆ†é˜å£“è¿«æ€§èƒ¸éª¨å¾Œèƒ¸ç—›è‡³æ€¥è¨ºã€‚
                        åˆ°é”æ€¥è¨ºå¾Œï¼Œèƒ¸ç—›ç¶“ç¡åŒ–ç”˜æ²¹å®Œå…¨ç·©è§£ã€‚å¿ƒé›»åœ–æ­£å¸¸ï¼Œåˆå§‹è‚Œéˆ£è›‹ç™½0.01 ng/mL (åƒè€ƒç¯„åœ0.00-0.08)ã€‚
                    </p>
                </div>
                <div style={{ marginTop: 14 }}>
                    <h4 style={{ color: 'var(--sec)', marginBottom: 10 }}>ğŸ“‹ HEARTè©•åˆ†è¨ˆç®—</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td style={{ fontWeight: 600 }}>H - ç—…å²</td>
                                <td>å¯èƒ½ç¬¦åˆACS</td>
                                <td>1åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>E - å¿ƒé›»åœ–</td>
                                <td>æ­£å¸¸</td>
                                <td>0åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>A - å¹´é½¡</td>
                                <td>&lt;45æ­²</td>
                                <td>0åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>R - å±éšªå› å­</td>
                                <td>ç„¡å±éšªå› å­</td>
                                <td>0åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>T - è‚Œéˆ£è›‹ç™½</td>
                                <td>æ­£å¸¸</td>
                                <td>0åˆ†</td>
                            </tr>
                            <tr style={{ background: '#E8F5E9' }}>
                                <td style={{ fontWeight: 700 }}>ç¸½åˆ†</td>
                                <td></td>
                                <td style={{ fontWeight: 700, color: 'var(--suc)' }}>1åˆ†</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div className="good" style={{ marginTop: 14 }}>
                    <strong>å¾Œæ¸¬æ©Ÿç‡è¨ˆç®—</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        HEARTè©•åˆ† 1åˆ† â†’ LR = 0.20<br/>
                        å‰æ¸¬æ©Ÿç‡ 13% Ã— LR 0.20 â†’ å¾Œæ¸¬æ©Ÿç‡ â‰ˆ <strong>3%</strong>
                    </p>
                </div>
                <div className="tip" style={{ marginTop: 14 }}>
                    <strong>ğŸ’¡ è™•ç½®å»ºè­°</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        ç¡åŒ–ç”˜æ²¹ç·©è§£èƒ¸ç—›å°è¨ºæ–·ç„¡å¹«åŠ©ã€‚æ­¤æ‚£è€…å±¬ä½é¢¨éšªï¼Œå¯è€ƒæ…®åŠ é€Ÿè¨ºæ–·æµç¨‹ï¼Œè‹¥ç¬¬äºŒæ¬¡è‚Œéˆ£è›‹ç™½é™°æ€§å¯æ—©æœŸå‡ºé™¢ã€‚
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>ğŸ¥ Case 2ï¼š74æ­²ç”·æ€§æœ‰å¿ƒè‚Œæ¢—å¡ç—…å²</h3>
                <div className="info">
                    <strong>ç—…å²</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        74æ­²ç”·æ€§ï¼Œ3å¹´å‰æ›¾æœ‰å¿ƒè‚Œæ¢—å¡ï¼Œå› æ•¸æ—¥é–“æ­‡æ€§ç‡’ç¼æ„Ÿèƒ¸éª¨å¾Œèƒ¸ç—›è‡³æ€¥è¨ºã€‚
                        å¿ƒé›»åœ–é¡¯ç¤ºIIã€IIIã€aVFå°ç¨‹Qæ³¢(èˆ‡3å€‹æœˆå‰ç›¸åŒï¼Œç„¡æ–°è®ŠåŒ–)ã€‚
                        åˆå§‹è‚Œéˆ£è›‹ç™½0.14 ng/mL (åƒè€ƒç¯„åœ0.00-0.08)ã€‚
                    </p>
                </div>
                <div style={{ marginTop: 14 }}>
                    <h4 style={{ color: 'var(--sec)', marginBottom: 10 }}>ğŸ“‹ HEARTè©•åˆ†è¨ˆç®—</h4>
                    <table>
                        <tbody>
                            <tr>
                                <td style={{ fontWeight: 600 }}>H - ç—…å²</td>
                                <td>å¯èƒ½ç¬¦åˆACS</td>
                                <td>1åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>E - å¿ƒé›»åœ–</td>
                                <td>ç„¡å‹•æ…‹è®ŠåŒ–</td>
                                <td>0åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>A - å¹´é½¡</td>
                                <td>&gt;65æ­²</td>
                                <td>2åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>R - å±éšªå› å­</td>
                                <td>å·²çŸ¥å† å¿ƒç—…</td>
                                <td>2åˆ†</td>
                            </tr>
                            <tr>
                                <td style={{ fontWeight: 600 }}>T - è‚Œéˆ£è›‹ç™½</td>
                                <td>è¼•åº¦å‡é«˜(1-3Ã—)</td>
                                <td>1åˆ†</td>
                            </tr>
                            <tr style={{ background: '#FFF8E1' }}>
                                <td style={{ fontWeight: 700 }}>ç¸½åˆ†</td>
                                <td></td>
                                <td style={{ fontWeight: 700, color: '#F57F17' }}>6åˆ†</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div className="danger" style={{ marginTop: 14 }}>
                    <strong>å¾Œæ¸¬æ©Ÿç‡è¨ˆç®—</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        HEARTè©•åˆ† 6åˆ† â†’ LR = 2.4 (ä¸­é¢¨éšª)<br/>
                        å‰æ¸¬æ©Ÿç‡ 13% Ã— LR 2.4 â†’ å¾Œæ¸¬æ©Ÿç‡ â‰ˆ <strong>26%</strong>
                    </p>
                </div>
                <div className="tip" style={{ marginTop: 14 }}>
                    <strong>ğŸ’¡ è™•ç½®å»ºè­°</strong>
                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                        æ­¤æ‚£è€…å±¬ä¸­é¢¨éšªï¼Œæ‡‰ä½é™¢æ¥å—ACSæ²»ç™‚ï¼ŒåŒ…æ‹¬æŠ—è¡€å°æ¿å’ŒæŠ—å‡è¡€æ²»ç™‚ï¼Œä¸¦é€²ä¸€æ­¥è©•ä¼°ã€‚
                    </p>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>ğŸ“Š è‡¨åºŠæ±ºç­–æµç¨‹</h3>
                <div style={{ 
                    background: 'linear-gradient(135deg, #FFEBEE, #FFCDD2)', 
                    padding: 20, 
                    borderRadius: 16,
                    textAlign: 'center'
                }}>
                    <div style={{ marginBottom: 16 }}>
                        <div style={{ 
                            background: 'var(--pri)', 
                            color: '#fff', 
                            padding: '10px 20px', 
                            borderRadius: 10,
                            display: 'inline-block',
                            fontWeight: 600
                        }}>
                            æ€¥è¨ºèƒ¸ç—›æ‚£è€…
                        </div>
                    </div>
                    <div style={{ fontSize: 24, marginBottom: 16 }}>â†“</div>
                    <div style={{ marginBottom: 16 }}>
                        <div style={{ 
                            background: 'var(--danger)', 
                            color: '#fff', 
                            padding: '10px 20px', 
                            borderRadius: 10,
                            display: 'inline-block',
                            fontWeight: 600
                        }}>
                            å¿ƒé›»åœ– STæ®µä¸Šå‡?
                        </div>
                    </div>
                    <div style={{ display: 'flex', justifyContent: 'center', gap: 40 }}>
                        <div>
                            <div style={{ fontSize: 14, color: 'var(--danger)', fontWeight: 600 }}>æ˜¯</div>
                            <div style={{ fontSize: 20 }}>â†“</div>
                            <div style={{ 
                                background: 'var(--danger)', 
                                color: '#fff', 
                                padding: '8px 16px', 
                                borderRadius: 8,
                                fontSize: 13
                            }}>
                                STEMIè·¯å¾‘
                            </div>
                        </div>
                        <div>
                            <div style={{ fontSize: 14, color: 'var(--suc)', fontWeight: 600 }}>å¦</div>
                            <div style={{ fontSize: 20 }}>â†“</div>
                            <div style={{ 
                                background: 'var(--info)', 
                                color: '#fff', 
                                padding: '8px 16px', 
                                borderRadius: 8,
                                fontSize: 13
                            }}>
                                HEART/TIMIè©•åˆ†
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div className="card">
                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--suc)', marginBottom: 14 }}>âœ… æ ¸å¿ƒé‡é»ç¸½çµ</h3>
                <div style={{ display: 'grid', gap: 12 }}>
                    {[
                        'æ€¥è¨ºèƒ¸ç—›æ‚£è€…ACSç››è¡Œç‡ç´„13%',
                        'å–®ç¨ç—…å²å’Œç†å­¸æª¢æŸ¥ä¸èƒ½ç¢ºèªæˆ–æ’é™¤ACS',
                        'è§¸è¨ºå¯é‡ç¾ç–¼ç—›æ˜¯æœ€èƒ½é™ä½ACSå¯èƒ½æ€§çš„ç™¼ç¾(LR 0.28)',
                        'ç¡åŒ–ç”˜æ²¹åæ‡‰å°ACSè¨ºæ–·ç„¡å¹«åŠ©',
                        'STæ®µä¸‹é™æ˜¯æœ€æœ‰åƒ¹å€¼çš„å¿ƒé›»åœ–ç™¼ç¾(LR+ 5.3)',
                        'HEARTè©•åˆ†0-3åˆ†å¯å°‡ACSæ©Ÿç‡é™è‡³ç´„3%',
                        'é¢¨éšªè©•åˆ†éœ€çµåˆé€£çºŒè‚Œéˆ£è›‹ç™½æª¢æ¸¬ä½¿ç”¨'
                    ].map((item, i) => (
                        <div key={i} style={{ 
                            background: 'linear-gradient(135deg, #E8F5E9, #C8E6C9)',
                            padding: '12px 16px', 
                            borderRadius: 12,
                            display: 'flex',
                            alignItems: 'center',
                            gap: 12
                        }}>
                            <span style={{ 
                                background: 'var(--suc)',
                                color: '#fff',
                                borderRadius: '50%',
                                width: 24,
                                height: 24,
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                fontSize: 12,
                                fontWeight: 700,
                                flexShrink: 0
                            }}>âœ“</span>
                            <span style={{ fontSize: 14, color: 'var(--txt)' }}>{item}</span>
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );

    const Lesson = () => {
        const l = lessons.find(x => x.id === lessonId);
        return (
            <div className="fade-in">
                <Header title={l.title} />
                <div style={{ background: `linear-gradient(135deg, ${l.color}, ${l.color}88)`, padding: '20px', color: '#fff' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        <div style={{ fontSize: 12, opacity: 0.9 }}>Lesson {l.id} â€¢ {l.sub}</div>
                        <h1 style={{ fontSize: 24, fontWeight: 700 }}>{l.title}</h1>
                    </div>
                </div>
                <div style={{ padding: '20px 16px' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        {lessonId === 1 && <L1 />}
                        {lessonId === 2 && <L2 />}
                        {lessonId === 3 && <L3 />}
                        {lessonId === 4 && <L4 />}
                        {lessonId === 5 && <L5 />}
                        <div style={{ display: 'flex', gap: 12, marginTop: 24 }}>
                            {lessonId > 1 && (
                                <button className="btn" style={{ flex: 1, background: '#fff', border: '2px solid var(--pri)', color: 'var(--pri)' }} onClick={() => setLessonId(lessonId - 1)}>
                                    â† ä¸Šä¸€èª²
                                </button>
                            )}
                            {lessonId < 5 ? (
                                <button className="btn btn-pri" style={{ flex: 1 }} onClick={() => setLessonId(lessonId + 1)}>
                                    ä¸‹ä¸€èª² â†’
                                </button>
                            ) : (
                                <button className="btn btn-sec" style={{ flex: 1 }} onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); setPage('quiz'); }}>
                                    é–‹å§‹æ¸¬é©— ğŸ“
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            </div>
        );
    };

    const Quiz = () => {
        const pick = (i) => { if (show) return; setSel(i); setShow(true); if (i === quiz[qIdx].c) setScore(score + 1); };
        const next = () => { if (qIdx < quiz.length - 1) { setQIdx(qIdx + 1); setSel(null); setShow(false); } else setDone(true); };

        if (done) {
            const pct = Math.round((score / quiz.length) * 100);
            return (
                <div className="fade-in">
                    <Header title="æ¸¬é©—çµæœ" />
                    <div style={{ padding: '48px 16px', textAlign: 'center' }}>
                        <div style={{ 
                            width: 150, 
                            height: 150, 
                            borderRadius: '50%', 
                            background: `conic-gradient(${pct >= 80 ? 'var(--suc)' : pct >= 60 ? 'var(--warn)' : 'var(--danger)'} ${pct * 3.6}deg, #E5E5E5 0deg)`, 
                            display: 'flex', 
                            alignItems: 'center', 
                            justifyContent: 'center', 
                            margin: '0 auto 28px',
                            boxShadow: '0 8px 32px rgba(0,0,0,0.1)'
                        }}>
                            <div style={{ 
                                width: 126, 
                                height: 126, 
                                borderRadius: '50%', 
                                background: '#fff', 
                                display: 'flex', 
                                flexDirection: 'column', 
                                alignItems: 'center', 
                                justifyContent: 'center' 
                            }}>
                                <div style={{ fontSize: 40, fontWeight: 700, color: 'var(--txt)' }}>{pct}%</div>
                                <div style={{ fontSize: 15, color: 'var(--txt2)' }}>{score}/{quiz.length}</div>
                            </div>
                        </div>
                        <h2 style={{ fontSize: 26, fontWeight: 700, marginBottom: 10 }}>
                            {pct >= 80 ? 'ğŸ‰ å„ªç§€ï¼' : pct >= 60 ? 'ğŸ‘ ä¸éŒ¯ï¼' : 'ğŸ’ª åŠ æ²¹ï¼'}
                        </h2>
                        <p style={{ color: 'var(--txt2)', marginBottom: 36, fontSize: 15 }}>
                            {pct >= 80 ? 'ä½ å°èƒ¸ç—›ACSè©•ä¼°æŒæ¡è‰¯å¥½ï¼' : pct >= 60 ? 'å†è¤‡ç¿’å¯ä»¥æ›´é€²æ­¥ï¼' : 'å»ºè­°é‡æ–°é–±è®€èª²ç¨‹å…§å®¹'}
                        </p>
                        <div style={{ display: 'flex', gap: 14, justifyContent: 'center', flexWrap: 'wrap' }}>
                            <button className="btn btn-pri" onClick={() => { setQIdx(0); setScore(0); setSel(null); setShow(false); setDone(false); }}>
                                é‡æ–°æ¸¬é©—
                            </button>
                            <button className="btn" style={{ background: '#fff', border: '2px solid var(--pri)', color: 'var(--pri)' }} onClick={() => setPage('home')}>
                                è¿”å›èª²ç¨‹
                            </button>
                        </div>
                    </div>
                    <footer style={{ background: 'linear-gradient(135deg, #FFEBEE, #FFCDD2)', padding: '28px 16px', textAlign: 'center', marginTop: 48 }}>
                        <p style={{ fontSize: 12, color: 'var(--txt2)' }}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨ | è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                    </footer>
                </div>
            );
        }

        const q = quiz[qIdx];
        return (
            <div className="fade-in">
                <Header title="è‡ªæˆ‘æ¸¬é©—" />
                <div style={{ padding: '20px 16px' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 10, fontSize: 14 }}>
                            <span style={{ color: 'var(--txt2)' }}>é€²åº¦</span>
                            <span style={{ fontWeight: 600, color: 'var(--pri)' }}>{qIdx + 1}/{quiz.length}</span>
                        </div>
                        <div style={{ height: 10, background: '#E5E5E5', borderRadius: 5, marginBottom: 24, overflow: 'hidden' }}>
                            <div style={{ 
                                height: '100%', 
                                width: `${((qIdx + 1) / quiz.length) * 100}%`, 
                                background: 'linear-gradient(90deg, var(--pri), var(--pri2))', 
                                borderRadius: 5, 
                                transition: 'width 0.4s ease' 
                            }} />
                        </div>
                        <div className="card">
                            <h3 style={{ fontSize: 16, fontWeight: 600, lineHeight: 1.7, marginBottom: 22, color: 'var(--txt)' }}>{q.q}</h3>
                            {q.o.map((opt, i) => {
                                let bg = '#fff', bd = '#E5E5E5';
                                if (show) {
                                    if (i === q.c) { bg = '#E8F5E9'; bd = 'var(--suc)'; }
                                    else if (i === sel) { bg = '#FFEBEE'; bd = 'var(--danger)'; }
                                } else if (i === sel) { bg = '#FFEBEE'; bd = 'var(--pri)'; }
                                return (
                                    <button 
                                        key={i} 
                                        onClick={() => pick(i)} 
                                        disabled={show} 
                                        style={{ 
                                            width: '100%', 
                                            padding: '14px 16px', 
                                            marginBottom: 12, 
                                            background: bg, 
                                            border: `2px solid ${bd}`, 
                                            borderRadius: 14, 
                                            textAlign: 'left', 
                                            fontSize: 14, 
                                            cursor: show ? 'default' : 'pointer', 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            gap: 14,
                                            transition: 'all 0.2s ease'
                                        }}
                                    >
                                        <span style={{ 
                                            width: 30, 
                                            height: 30, 
                                            borderRadius: 10, 
                                            background: show && i === q.c ? 'var(--suc)' : show && i === sel ? 'var(--danger)' : 'linear-gradient(135deg, #FFEBEE, #FFCDD2)', 
                                            color: show && (i === q.c || i === sel) ? '#fff' : 'var(--pri)', 
                                            display: 'flex', 
                                            alignItems: 'center', 
                                            justifyContent: 'center', 
                                            fontWeight: 700, 
                                            fontSize: 14, 
                                            flexShrink: 0 
                                        }}>
                                            {show && i === q.c ? 'âœ“' : show && i === sel && i !== q.c ? 'âœ—' : String.fromCharCode(65 + i)}
                                        </span>
                                        <span style={{ lineHeight: 1.6, color: 'var(--txt)' }}>{opt}</span>
                                    </button>
                                );
                            })}
                        </div>
                        {show && (
                            <div className={sel === q.c ? 'good' : 'tip'}>
                                <strong style={{ color: sel === q.c ? 'var(--suc)' : '#F57F17' }}>
                                    {sel === q.c ? 'âœ“ æ­£ç¢ºï¼' : 'âœ— ç­”éŒ¯äº†'}
                                </strong>
                                <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 10, lineHeight: 1.8 }}>{q.e}</p>
                            </div>
                        )}
                        {show && (
                            <button className="btn btn-pri" style={{ width: '100%', justifyContent: 'center', marginTop: 20 }} onClick={next}>
                                {qIdx < quiz.length - 1 ? 'ä¸‹ä¸€é¡Œ â†’' : 'æŸ¥çœ‹çµæœ'}
                            </button>
                        )}
                    </div>
                </div>
            </div>
        );
    };

    // Case Selection Component
    const CaseSelection = () => (
        <div className="fade-in">
            <Header title="è‡¨åºŠæ¡ˆä¾‹æ¼”ç·´" />
            <div style={{
                background: 'linear-gradient(135deg, #1565C0 0%, #0D47A1 100%)',
                padding: '32px 20px',
                color: '#fff'
            }}>
                <div style={{ maxWidth: 480, margin: '0 auto' }}>
                    <div style={{ fontSize: 28, marginBottom: 8 }}>ğŸ¥</div>
                    <h1 style={{ fontSize: 22, fontWeight: 700, marginBottom: 8 }}>è‡¨åºŠæ¡ˆä¾‹æ¼”ç·´</h1>
                    <p style={{ opacity: 0.9, fontSize: 14 }}>Interactive Clinical Cases</p>
                </div>
            </div>
            <div style={{ padding: '20px 16px' }}>
                <div style={{ maxWidth: 480, margin: '0 auto' }}>
                    <div className="info" style={{ marginBottom: 20 }}>
                        <strong>ğŸ’¡ æ¡ˆä¾‹å­¸ç¿’æ¨¡å¼</strong>
                        <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 6 }}>
                            é€éäº’å‹•å¼è‡¨åºŠæ¡ˆä¾‹ï¼Œå°‡èª²ç¨‹æ‰€å­¸æ‡‰ç”¨æ–¼å¯¦éš›æƒ…å¢ƒã€‚æ¯å€‹æ¡ˆä¾‹åŒ…å«ç—…å²æ”¶é›†ã€ç†å­¸æª¢æŸ¥ã€æª¢é©—åˆ¤è®€å’Œè‡¨åºŠæ±ºç­–ç­‰ç’°ç¯€ã€‚
                        </p>
                    </div>
                    {clinicalCases.map(c => (
                        <div
                            key={c.id}
                            className="card"
                            onClick={() => { setCaseId(c.id); setCaseStep(0); setCaseScore(0); setCaseAnswers({}); setPage('case'); }}
                            style={{ cursor: 'pointer' }}
                        >
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: 16 }}>
                                <div style={{
                                    width: 56,
                                    height: 56,
                                    borderRadius: 14,
                                    background: 'linear-gradient(135deg, #1565C0, #0D47A1)',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    color: '#fff',
                                    fontSize: 24,
                                    flexShrink: 0
                                }}>
                                    {c.id === 1 ? 'ğŸ«€' : 'ğŸ©º'}
                                </div>
                                <div style={{ flex: 1 }}>
                                    <div style={{ display: 'flex', gap: 8, marginBottom: 6 }}>
                                        <span style={{
                                            background: c.difficulty === 'åŸºç¤' ? '#E8F5E9' : '#FFF3E0',
                                            color: c.difficulty === 'åŸºç¤' ? 'var(--suc)' : '#E65100',
                                            padding: '2px 8px',
                                            borderRadius: 6,
                                            fontSize: 11,
                                            fontWeight: 600
                                        }}>{c.difficulty}</span>
                                        <span style={{
                                            background: '#E3F2FD',
                                            color: '#1565C0',
                                            padding: '2px 8px',
                                            borderRadius: 6,
                                            fontSize: 11,
                                            fontWeight: 600
                                        }}>{c.estimatedTime}</span>
                                    </div>
                                    <h3 style={{ fontSize: 16, fontWeight: 700, color: 'var(--txt)', marginBottom: 4 }}>{c.title}</h3>
                                    <p style={{ fontSize: 12, color: 'var(--txt2)', marginBottom: 6 }}>{c.titleEn}</p>
                                    <p style={{ fontSize: 13, color: 'var(--txt2)', lineHeight: 1.6 }}>{c.description}</p>
                                </div>
                                <svg viewBox="0 0 24 24" fill="#1565C0" width="22" height="22" style={{ flexShrink: 0 }}>
                                    <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/>
                                </svg>
                            </div>
                        </div>
                    ))}
                    <button
                        className="btn"
                        onClick={() => setPage('home')}
                        style={{
                            width: '100%',
                            justifyContent: 'center',
                            marginTop: 16,
                            background: '#fff',
                            border: '2px solid var(--pri)',
                            color: 'var(--pri)'
                        }}
                    >
                        â† è¿”å›èª²ç¨‹
                    </button>
                </div>
            </div>
        </div>
    );

    // Interactive Case Component
    const CaseLearning = () => {
        const currentCase = clinicalCases.find(c => c.id === caseId);
        if (!currentCase) return null;

        const step = currentCase.steps[caseStep];
        const totalSteps = currentCase.steps.length;
        const progress = ((caseStep + 1) / totalSteps) * 100;

        const handleAnswer = (optionIndex, isCorrect) => {
            if (caseAnswers[caseStep] !== undefined) return;
            setCaseAnswers({ ...caseAnswers, [caseStep]: optionIndex });
            if (isCorrect) setCaseScore(caseScore + 1);
        };

        const nextStep = () => {
            if (caseStep < totalSteps - 1) {
                setCaseStep(caseStep + 1);
            }
        };

        const renderStepContent = () => {
            const c = step.content;

            switch (step.type) {
                case 'intro':
                    return (
                        <div className="fade-in">
                            <div className="card">
                                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--info)', marginBottom: 14 }}>{c.title}</h3>
                                <p style={{ fontSize: 15, color: 'var(--txt)', lineHeight: 1.8, marginBottom: 16 }}>{c.text}</p>
                                {c.vitals && (
                                    <div style={{
                                        background: 'linear-gradient(135deg, #E3F2FD, #BBDEFB)',
                                        borderRadius: 12,
                                        padding: 16
                                    }}>
                                        <h4 style={{ fontSize: 14, fontWeight: 600, color: '#1565C0', marginBottom: 10 }}>ğŸ“Š ç”Ÿå‘½å¾µè±¡</h4>
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: 8, fontSize: 13 }}>
                                            {Object.entries(c.vitals).map(([key, val]) => (
                                                <div key={key} style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--txt2)' }}>{key}:</span>
                                                    <span style={{ fontWeight: 600, color: 'var(--txt)' }}>{val}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    );

                case 'question':
                    const answered = caseAnswers[caseStep] !== undefined;
                    return (
                        <div className="fade-in">
                            <div className="card">
                                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>{c.title}</h3>
                                <p style={{ fontSize: 15, color: 'var(--txt)', lineHeight: 1.8, marginBottom: 20 }}>{c.text}</p>
                                {c.options.map((opt, i) => {
                                    let bg = '#fff', bd = '#E5E5E5';
                                    if (answered) {
                                        if (opt.correct) { bg = '#E8F5E9'; bd = 'var(--suc)'; }
                                        else if (i === caseAnswers[caseStep]) { bg = '#FFEBEE'; bd = 'var(--danger)'; }
                                    }
                                    return (
                                        <button
                                            key={i}
                                            onClick={() => handleAnswer(i, opt.correct)}
                                            disabled={answered}
                                            style={{
                                                width: '100%',
                                                padding: '14px 16px',
                                                marginBottom: 10,
                                                background: bg,
                                                border: `2px solid ${bd}`,
                                                borderRadius: 12,
                                                textAlign: 'left',
                                                fontSize: 14,
                                                cursor: answered ? 'default' : 'pointer',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: 12,
                                                transition: 'all 0.2s ease'
                                            }}
                                        >
                                            <span style={{
                                                width: 28,
                                                height: 28,
                                                borderRadius: 8,
                                                background: answered && opt.correct ? 'var(--suc)' : answered && i === caseAnswers[caseStep] ? 'var(--danger)' : 'linear-gradient(135deg, #E3F2FD, #BBDEFB)',
                                                color: answered && (opt.correct || i === caseAnswers[caseStep]) ? '#fff' : '#1565C0',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontWeight: 700,
                                                fontSize: 13,
                                                flexShrink: 0
                                            }}>
                                                {answered && opt.correct ? 'âœ“' : answered && i === caseAnswers[caseStep] && !opt.correct ? 'âœ—' : String.fromCharCode(65 + i)}
                                            </span>
                                            <span style={{ lineHeight: 1.5 }}>{opt.text}</span>
                                        </button>
                                    );
                                })}
                                {answered && (
                                    <div className={c.options[caseAnswers[caseStep]].correct ? 'good' : 'tip'} style={{ marginTop: 16 }}>
                                        <strong style={{ color: c.options[caseAnswers[caseStep]].correct ? 'var(--suc)' : '#F57F17' }}>
                                            {c.options[caseAnswers[caseStep]].correct ? 'âœ“ æ­£ç¢ºï¼' : 'âœ— å†æƒ³æƒ³'}
                                        </strong>
                                        <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 8, lineHeight: 1.7 }}>
                                            {c.options[caseAnswers[caseStep]].feedback}
                                        </p>
                                    </div>
                                )}
                            </div>
                        </div>
                    );

                case 'info':
                    return (
                        <div className="fade-in">
                            <div className="card">
                                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--sec)', marginBottom: 14 }}>{c.title}</h3>
                                <p style={{ fontSize: 15, color: 'var(--txt)', lineHeight: 1.8, marginBottom: 12 }}>{c.text}</p>
                                {c.highlight && (
                                    <div className="formula">{c.highlight}</div>
                                )}
                                {c.note && (
                                    <div className="info">
                                        <p style={{ fontSize: 14, color: 'var(--txt2)' }}>{c.note}</p>
                                    </div>
                                )}
                                {c.details && (
                                    <ul style={{ marginTop: 12, marginLeft: 20, color: 'var(--txt2)', fontSize: 14 }}>
                                        {c.details.map((d, i) => <li key={i} style={{ marginBottom: 6 }}>{d}</li>)}
                                    </ul>
                                )}
                                {c.lab && (
                                    <div style={{
                                        background: c.lab.status === 'è¼•åº¦å‡é«˜' ? 'linear-gradient(135deg, #FFF8E1, #FFECB3)' : 'linear-gradient(135deg, #E8F5E9, #C8E6C9)',
                                        borderRadius: 12,
                                        padding: 16,
                                        marginTop: 12
                                    }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ fontWeight: 600 }}>Troponin</span>
                                            <span style={{
                                                fontWeight: 700,
                                                color: c.lab.status === 'è¼•åº¦å‡é«˜' ? '#F57F17' : 'var(--suc)'
                                            }}>{c.lab.troponin}</span>
                                        </div>
                                        <div style={{ fontSize: 12, color: 'var(--txt2)', marginTop: 4 }}>
                                            {c.lab.reference} â€¢ <strong>{c.lab.status}</strong>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    );

                case 'calculator':
                    return (
                        <div className="fade-in">
                            <div className="card">
                                <h3 style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)', marginBottom: 14 }}>{c.title}</h3>
                                <p style={{ fontSize: 14, color: 'var(--txt2)', marginBottom: 16 }}>{c.text}</p>
                                {c.items.map((item, i) => (
                                    <div key={i} className="score-box" style={{ marginBottom: 10 }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <div>
                                                <div style={{ fontSize: 13, fontWeight: 600, color: 'var(--pri)' }}>{item.label}</div>
                                                <div style={{ fontSize: 12, color: 'var(--txt2)' }}>{item.value}</div>
                                            </div>
                                            <div style={{
                                                background: 'var(--pri)',
                                                color: '#fff',
                                                padding: '4px 12px',
                                                borderRadius: 8,
                                                fontWeight: 700,
                                                fontSize: 14
                                            }}>{item.score}åˆ†</div>
                                        </div>
                                    </div>
                                ))}
                                <div style={{
                                    background: 'linear-gradient(135deg, var(--pri), var(--pri2))',
                                    borderRadius: 12,
                                    padding: 16,
                                    color: '#fff',
                                    marginTop: 16
                                }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 8 }}>
                                        <span style={{ fontSize: 16, fontWeight: 600 }}>ç¸½åˆ†</span>
                                        <span style={{ fontSize: 28, fontWeight: 700 }}>{c.total}åˆ†</span>
                                    </div>
                                    <div style={{ fontSize: 14, opacity: 0.95 }}>{c.interpretation}</div>
                                    <div style={{ fontSize: 13, opacity: 0.9, marginTop: 4 }}>{c.lr}</div>
                                </div>
                                <div className="good" style={{ marginTop: 16 }}>
                                    <strong>å¾Œæ¸¬æ©Ÿç‡</strong>
                                    <p style={{ fontSize: 14, color: 'var(--txt2)', marginTop: 4 }}>{c.postTestProb}</p>
                                </div>
                            </div>
                        </div>
                    );

                case 'summary':
                    const totalQuestions = currentCase.steps.filter(s => s.type === 'question').length;
                    return (
                        <div className="fade-in">
                            <div className="card" style={{ background: 'linear-gradient(135deg, #E8F5E9, #C8E6C9)', border: '2px solid var(--suc)' }}>
                                <h3 style={{ fontSize: 20, fontWeight: 700, color: 'var(--suc)', marginBottom: 16 }}>{c.title}</h3>

                                <div style={{
                                    background: '#fff',
                                    borderRadius: 12,
                                    padding: 16,
                                    marginBottom: 16
                                }}>
                                    <div style={{ fontSize: 13, color: 'var(--txt2)', marginBottom: 4 }}>æœ€çµ‚è¨ºæ–·</div>
                                    <div style={{ fontSize: 18, fontWeight: 700, color: 'var(--pri)' }}>{c.diagnosis}</div>
                                </div>

                                <div style={{ marginBottom: 16 }}>
                                    <h4 style={{ fontSize: 14, fontWeight: 600, color: 'var(--txt)', marginBottom: 10 }}>ğŸ” é—œéµç™¼ç¾</h4>
                                    {c.keyFindings.map((f, i) => (
                                        <div key={i} style={{
                                            background: '#fff',
                                            borderRadius: 8,
                                            padding: '10px 14px',
                                            marginBottom: 8,
                                            fontSize: 13,
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: 10
                                        }}>
                                            <span style={{ color: 'var(--suc)' }}>âœ“</span>
                                            {f}
                                        </div>
                                    ))}
                                </div>

                                <div style={{
                                    background: '#fff',
                                    borderRadius: 12,
                                    padding: 16,
                                    marginBottom: 16
                                }}>
                                    <h4 style={{ fontSize: 14, fontWeight: 600, color: 'var(--txt)', marginBottom: 8 }}>ğŸ¥ è™•ç½®å»ºè­°</h4>
                                    <p style={{ fontSize: 14, color: 'var(--txt2)', lineHeight: 1.7 }}>{c.management}</p>
                                </div>

                                <div>
                                    <h4 style={{ fontSize: 14, fontWeight: 600, color: 'var(--txt)', marginBottom: 10 }}>ğŸ’¡ å­¸ç¿’é‡é»</h4>
                                    {c.learningPoints.map((p, i) => (
                                        <div key={i} style={{
                                            background: 'linear-gradient(135deg, #FFF8E1, #FFECB3)',
                                            borderRadius: 8,
                                            padding: '10px 14px',
                                            marginBottom: 8,
                                            fontSize: 13,
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: 10
                                        }}>
                                            <span>ğŸ’¡</span>
                                            {p}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="card" style={{ textAlign: 'center' }}>
                                <div style={{ fontSize: 48, marginBottom: 12 }}>ğŸ‰</div>
                                <h3 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>æ¡ˆä¾‹å®Œæˆï¼</h3>
                                <p style={{ color: 'var(--txt2)', marginBottom: 16 }}>
                                    æ‚¨çš„ç­”é¡Œæ­£ç¢ºç‡ï¼š{caseScore}/{totalQuestions} ({Math.round((caseScore/totalQuestions)*100)}%)
                                </p>
                                <div style={{ display: 'flex', gap: 12, justifyContent: 'center' }}>
                                    <button
                                        className="btn btn-pri"
                                        onClick={() => setPage('cases')}
                                    >
                                        æ›´å¤šæ¡ˆä¾‹
                                    </button>
                                    <button
                                        className="btn"
                                        onClick={() => setPage('home')}
                                        style={{ background: '#fff', border: '2px solid var(--pri)', color: 'var(--pri)' }}
                                    >
                                        è¿”å›èª²ç¨‹
                                    </button>
                                </div>
                            </div>
                        </div>
                    );

                default:
                    return null;
            }
        };

        const canProceed = step.type !== 'question' || caseAnswers[caseStep] !== undefined;

        return (
            <div className="fade-in">
                <Header title={currentCase.title} />
                <div style={{
                    background: 'linear-gradient(135deg, #1565C0, #0D47A1)',
                    padding: '16px 20px',
                    color: '#fff'
                }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8, fontSize: 13 }}>
                            <span style={{ opacity: 0.9 }}>æ­¥é©Ÿ {caseStep + 1} / {totalSteps}</span>
                            <span style={{ fontWeight: 600 }}>{Math.round(progress)}%</span>
                        </div>
                        <div style={{ height: 6, background: 'rgba(255,255,255,0.3)', borderRadius: 3, overflow: 'hidden' }}>
                            <div style={{
                                height: '100%',
                                width: `${progress}%`,
                                background: '#fff',
                                borderRadius: 3,
                                transition: 'width 0.4s ease'
                            }} />
                        </div>
                    </div>
                </div>
                <div style={{ padding: '20px 16px' }}>
                    <div style={{ maxWidth: 480, margin: '0 auto' }}>
                        {renderStepContent()}

                        {step.type !== 'summary' && (
                            <button
                                className="btn btn-pri"
                                onClick={nextStep}
                                disabled={!canProceed}
                                style={{
                                    width: '100%',
                                    justifyContent: 'center',
                                    marginTop: 20,
                                    opacity: canProceed ? 1 : 0.5,
                                    cursor: canProceed ? 'pointer' : 'not-allowed'
                                }}
                            >
                                {caseStep < totalSteps - 1 ? 'ç¹¼çºŒ â†’' : 'æŸ¥çœ‹ç¸½çµ'}
                            </button>
                        )}
                    </div>
                </div>
            </div>
        );
    };

    const closeBadge = (id) => setNewBadges(prev => prev.filter(b => b !== id));

    return (
        <div style={{ maxWidth: '100%', minHeight: '100vh', background: 'var(--bg)' }}>
            <BadgeToast badges={newBadges} onClose={closeBadge} />
            {page === 'home' && <Home />}
            {page === 'lesson' && <Lesson />}
            {page === 'quiz' && <Quiz />}
            {page === 'cases' && <CaseSelection />}
            {page === 'case' && <CaseLearning />}
        </div>
    );
};

ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
