<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“è¨ºæ–· | JAMA Rational Clinical Examination</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--pri:#5B8C5A;--pri2:#7CB342;--acc:#FF8F00;--suc:#26A69A;--warn:#FFC107;--err:#EF5350;--pur:#7E57C2;--blue:#42A5F5;--pink:#EC407A;--bg:#FAFCFA;--txt:#1A2E1A;--txt2:#6B7280}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--txt);line-height:1.7}
        .container{max-width:480px;margin:0 auto}
        .card{background:#fff;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 2px 12px rgba(91,140,90,0.1)}
        .btn{padding:14px 24px;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;transition:all 0.3s;width:100%}
        .btn-pri{background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff}
        .btn-acc{background:linear-gradient(135deg,var(--acc),#FFB300);color:#fff}
        .btn-out{background:#fff;border:2px solid var(--pri);color:var(--pri)}
        table{width:100%;border-collapse:collapse;font-size:13px;margin:12px 0}
        th,td{padding:10px;text-align:center;border-bottom:1px solid #eee}
        th{background:#F0F7F0;font-weight:600;color:var(--pri)}
        .formula{background:linear-gradient(135deg,#F0F7F0,#E8F5E9);border:2px solid var(--pri);border-radius:12px;padding:16px;margin:12px 0;text-align:center;font-size:17px;color:#2E5D2E}
        .tip{background:#FFF8E1;border-left:4px solid var(--acc);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .good{background:#E8F5E9;border-left:4px solid var(--suc);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .info{background:#E3F2FD;border-left:4px solid var(--blue);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .warn{background:#FFF3E0;border-left:4px solid var(--warn);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .purple{background:#EDE7F6;border-left:4px solid var(--pur);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .pink{background:#FCE4EC;border-left:4px solid var(--pink);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .key-point{background:linear-gradient(135deg,#5B8C5A,#7CB342);color:#fff;border-radius:12px;padding:16px;margin:16px 0}
        .lr-high{background:#C8E6C9;color:#2E7D32;padding:2px 8px;border-radius:4px;font-weight:600}
        .lr-mod{background:#FFF9C4;color:#F57F17;padding:2px 8px;border-radius:4px;font-weight:600}
        .lr-low{background:#FFCDD2;color:#C62828;padding:2px 8px;border-radius:4px;font-weight:600}
        header{background:#fff;border-bottom:1px solid #eee;padding:12px 16px;position:sticky;top:0;z-index:10}
        .header-inner{max-width:480px;margin:0 auto;display:flex;align-items:center;gap:12px}
        .back-btn{background:#F0F7F0;border:none;border-radius:10px;width:40px;height:40px;cursor:pointer;color:var(--pri);display:flex;align-items:center;justify-content:center}
        .hero{background:linear-gradient(135deg,#5B8C5A,#7CB342);padding:32px 20px;color:#fff}
        .tag{background:rgba(255,255,255,0.2);display:inline-block;padding:6px 14px;border-radius:50px;font-size:12px;font-weight:600;margin-bottom:16px}
        .badge-row{display:flex;gap:10px;flex-wrap:wrap}
        .badge{background:rgba(255,255,255,0.2);padding:6px 12px;border-radius:20px;font-size:11px}
        .content{padding:0 16px;margin-top:-20px}
        .lesson-item{display:flex;align-items:center;gap:12px;padding:14px;margin-bottom:8px;background:#F8FBF8;border-radius:12px;cursor:pointer;border:2px solid transparent;transition:border-color 0.2s}
        .lesson-item:hover{border-color:var(--pri)}
        .lesson-num{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
        .goal-item{display:flex;gap:10px;margin-bottom:8px;font-size:14px}
        .goal-num{background:var(--suc);color:#fff;border-radius:6px;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0}
        footer{background:#F0F7F0;padding:24px 16px;border-radius:16px;text-align:center;margin:20px 0 40px}
        .page{display:none}
        .page.active{display:block}
        .lesson-header{padding:20px;color:#fff}
        .lesson-content{padding:20px 16px}
        .nav-buttons{display:flex;gap:12px;margin-top:24px}
        .nav-buttons .btn{flex:1}
        .progress-bar{height:8px;background:#E5E5E5;border-radius:4px;margin-bottom:20px}
        .progress-fill{height:100%;background:linear-gradient(90deg,var(--pri),var(--pri2));border-radius:4px;transition:width 0.3s}
        .quiz-option{width:100%;padding:12px 14px;margin-bottom:10px;background:#fff;border:2px solid #E5E5E5;border-radius:12px;text-align:left;font-size:14px;cursor:pointer;display:flex;align-items:center;gap:12px}
        .quiz-option:hover{border-color:var(--pri)}
        .quiz-option.selected{background:#F0F7F0;border-color:var(--pri)}
        .quiz-option.correct{background:#E8F5E9;border-color:var(--suc)}
        .quiz-option.wrong{background:#FFEBEE;border-color:var(--err)}
        .quiz-option.disabled{cursor:default}
        .option-label{width:26px;height:26px;border-radius:8px;background:#F0F7F0;color:var(--pri);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:13px;flex-shrink:0}
        .option-label.correct{background:var(--suc);color:#fff}
        .option-label.wrong{background:var(--err);color:#fff}
        .result-circle{width:140px;height:140px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 24px}
        .result-inner{width:120px;height:120px;border-radius:50%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center}
        .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
        .stat-box{border-radius:12px;padding:16px;text-align:center}
        .stat-box .label{font-size:11px;color:var(--txt2)}
        .stat-box .value{font-size:20px;font-weight:700}
    </style>
</head>
<body>
    <!-- é¦–é  -->
    <div id="home" class="page active">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="location.href='jama-rational-exam.html'">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#2E5D2E">å…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“</span>
            </div>
        </header>
        <div class="hero">
            <div class="container">
                <div class="tag">ğŸ‘¶ JAMA Rational Clinical Examination</div>
                <h1 style="font-size:22px;font-weight:700;margin-bottom:8px">Does This Child With High Blood Pressure Have Secondary Hypertension?</h1>
                <h2 style="font-size:15px;font-weight:500;margin-bottom:12px;opacity:0.95">å…’ç«¥åŠé’å°‘å¹´ç¹¼ç™¼æ€§é«˜è¡€å£“çš„è‡¨åºŠè¨ºæ–·</h2>
                <a href="https://jamanetwork.com/journals/jama/article-abstract/2802908" target="_blank" style="display:inline-block;background:rgba(255,255,255,0.25);padding:8px 16px;border-radius:8px;color:#fff;text-decoration:none;font-size:13px;margin-bottom:16px;transition:background 0.2s" onmouseover="this.style.background='rgba(255,255,255,0.4)'" onmouseout="this.style.background='rgba(255,255,255,0.25)'">ğŸ“„ JAMA 2023;329(12):1012-1021 â†—</a>
                <div class="badge-row">
                    <div class="badge">ğŸ“Š N=4,210</div>
                    <div class="badge">ğŸ“š 30 Studies</div>
                    <div class="badge">ğŸ¯ LR Analysis</div>
                </div>
            </div>
        </div>
        <div class="content">
            <div class="container">
                <div class="card">
                    <h3 style="font-size:16px;font-weight:700;color:var(--pri);margin-bottom:12px">ğŸ¯ å­¸ç¿’ç›®æ¨™</h3>
                    <div class="goal-item"><span class="goal-num">1</span><span style="color:var(--txt2)">äº†è§£å…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“çš„ç››è¡Œç‡</span></div>
                    <div class="goal-item"><span class="goal-num">2</span><span style="color:var(--txt2)">æŒæ¡ç—…å²åŠèº«é«”æª¢æŸ¥ç™¼ç¾çš„ä¼¼ç„¶æ¯”</span></div>
                    <div class="goal-item"><span class="goal-num">3</span><span style="color:var(--txt2)">å­¸æœƒå¯¦é©—å®¤æª¢æŸ¥çš„è¨ºæ–·åƒ¹å€¼</span></div>
                    <div class="goal-item"><span class="goal-num">4</span><span style="color:var(--txt2)">ç†è§£ABPMåœ¨è¨ºæ–·ä¸­çš„è§’è‰²</span></div>
                    <div class="goal-item"><span class="goal-num">5</span><span style="color:var(--txt2)">è‡¨åºŠç¶œåˆåˆ¤æ–·èˆ‡æ±ºç­–æ‡‰ç”¨</span></div>
                </div>
                <div class="card">
                    <h3 style="font-size:16px;font-weight:700;color:var(--pri);margin-bottom:12px">ğŸ“– èª²ç¨‹å–®å…ƒ</h3>
                    <div class="lesson-item" onclick="showLesson(1)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#5B8C5A,#5B8C5A88)">1</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">å…’ç«¥é«˜è¡€å£“æ¦‚è«–</div><div style="font-size:12px;color:var(--txt2)">Primary vs Secondary HTN</div></div>
                        <svg viewBox="0 0 24 24" fill="#5B8C5A" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(2)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#7CB342,#7CB34288)">2</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">ç—…å²èˆ‡å±éšªå› å­</div><div style="font-size:12px;color:var(--txt2)">History & Risk Factors</div></div>
                        <svg viewBox="0 0 24 24" fill="#7CB342" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(3)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#42A5F5,#42A5F588)">3</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">å¯¦é©—å®¤æª¢æŸ¥</div><div style="font-size:12px;color:var(--txt2)">Laboratory Studies</div></div>
                        <svg viewBox="0 0 24 24" fill="#42A5F5" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(4)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#7E57C2,#7E57C288)">4</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">å‹•æ…‹è¡€å£“ç›£æ¸¬</div><div style="font-size:12px;color:var(--txt2)">ABPM Findings</div></div>
                        <svg viewBox="0 0 24 24" fill="#7E57C2" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                    <div class="lesson-item" onclick="showLesson(5)">
                        <div class="lesson-num" style="background:linear-gradient(135deg,#FF8F00,#FF8F0088)">5</div>
                        <div style="flex:1"><div style="font-weight:600;font-size:15px">è‡¨åºŠæ±ºç­–æ‡‰ç”¨</div><div style="font-size:12px;color:var(--txt2)">Clinical Application</div></div>
                        <svg viewBox="0 0 24 24" fill="#FF8F00" width="20" height="20"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
                    </div>
                </div>
                <button class="btn btn-acc" onclick="startQuiz()">ğŸ“ é–‹å§‹è‡ªæˆ‘æ¸¬é©—</button>
                <div class="card" style="background:linear-gradient(135deg,#E8F5E9,#F1F8E9);margin-top:16px">
                    <h3 style="font-size:14px;font-weight:700;color:var(--pri);margin-bottom:8px">ğŸ“Œ è‡¨åºŠè¦é»</h3>
                    <p style="font-size:13px;color:var(--txt2);line-height:1.8">å…’ç«¥é«˜è¡€å£“è©•ä¼°éœ€è€ƒé‡ç¹¼ç™¼æ€§ç—…å› ã€‚å¹´é½¡â‰¤6æ­²ã€éè‚¥èƒ–ã€æœ‰ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²ã€å¾®é‡ç™½è›‹ç™½å°¿ã€ä½è¡€æ¸…å°¿é…¸ç­‰ç™¼ç¾æç¤ºç¹¼ç™¼æ€§é«˜è¡€å£“çš„å¯èƒ½æ€§è¼ƒé«˜ã€‚ä½†æ²’æœ‰ä»»ä½•å–®ä¸€ç™¼ç¾å¯ä»¥å®Œå…¨å€åˆ†åŸç™¼æ€§èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ã€‚</p>
                </div>
                <footer>
                    <p style="font-size:12px;color:var(--txt2);margin-bottom:8px">æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨</p>
                    <p style="font-size:11px;color:var(--txt2)">è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                    <p style="font-size:10px;color:var(--txt2);margin-top:8px">è³‡æ–™ä¾†æº: JAMA 2023;329(12):1012-1021</p>
                </footer>
            </div>
        </div>
    </div>

    <!-- èª²ç¨‹é  -->
    <div id="lesson" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span id="lesson-title" style="font-weight:700;color:#2E5D2E"></span>
            </div>
        </header>
        <div id="lesson-header" class="lesson-header"></div>
        <div class="lesson-content">
            <div class="container">
                <div id="lesson-body"></div>
                <div class="nav-buttons">
                    <button id="prev-btn" class="btn btn-out" onclick="prevLesson()">â† ä¸Šä¸€èª²</button>
                    <button id="next-btn" class="btn btn-pri" onclick="nextLesson()">ä¸‹ä¸€èª² â†’</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¸¬é©—é  -->
    <div id="quiz" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#2E5D2E">è‡ªæˆ‘æ¸¬é©—</span>
            </div>
        </header>
        <div style="padding:20px 16px">
            <div class="container">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;font-size:14px">
                    <span style="color:var(--txt2)">é€²åº¦</span>
                    <span id="quiz-progress" style="font-weight:600;color:var(--pri)"></span>
                </div>
                <div class="progress-bar"><div id="quiz-progress-bar" class="progress-fill"></div></div>
                <div id="quiz-content" class="card"></div>
                <div id="quiz-feedback"></div>
                <button id="quiz-next" class="btn btn-pri" style="display:none;margin-top:16px" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â†’</button>
            </div>
        </div>
    </div>

    <!-- çµæœé  -->
    <div id="result" class="page">
        <header>
            <div class="header-inner">
                <button class="back-btn" onclick="showHome()">
                    <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                </button>
                <span style="font-weight:700;color:#2E5D2E">æ¸¬é©—çµæœ</span>
            </div>
        </header>
        <div style="padding:40px 16px;text-align:center">
            <div id="result-circle" class="result-circle">
                <div class="result-inner">
                    <div id="result-pct" style="font-size:36px;font-weight:700"></div>
                    <div id="result-score" style="font-size:14px;color:var(--txt2)"></div>
                </div>
            </div>
            <h2 id="result-title" style="font-size:24px;font-weight:700;margin-bottom:8px"></h2>
            <p id="result-msg" style="color:var(--txt2);margin-bottom:32px"></p>
            <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
                <button class="btn btn-pri" style="width:auto" onclick="startQuiz()">é‡æ–°æ¸¬é©—</button>
                <button class="btn btn-out" style="width:auto" onclick="showHome()">è¿”å›èª²ç¨‹</button>
            </div>
        </div>
        <footer style="margin-top:40px">
            <p style="font-size:12px;color:var(--txt2)">æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨ | è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
        </footer>
    </div>

<script>
const lessons = [
    {id:1, title:'å…’ç«¥é«˜è¡€å£“æ¦‚è«–', sub:'Primary vs Secondary HTN', color:'#5B8C5A'},
    {id:2, title:'ç—…å²èˆ‡å±éšªå› å­', sub:'History & Risk Factors', color:'#7CB342'},
    {id:3, title:'å¯¦é©—å®¤æª¢æŸ¥', sub:'Laboratory Studies', color:'#42A5F5'},
    {id:4, title:'å‹•æ…‹è¡€å£“ç›£æ¸¬', sub:'ABPM Findings', color:'#7E57C2'},
    {id:5, title:'è‡¨åºŠæ±ºç­–æ‡‰ç”¨', sub:'Clinical Application', color:'#FF8F00'}
];

const lessonContent = {
    1: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ æ ¸å¿ƒæ¦‚å¿µ</h4><p style="font-size:13px">å…’ç«¥é«˜è¡€å£“å¯åˆ†ç‚ºåŸç™¼æ€§ (Primary) èˆ‡ç¹¼ç™¼æ€§ (Secondary)ã€‚ç¹¼ç™¼æ€§é«˜è¡€å£“æœ‰æ˜ç¢ºå¯è¾¨è­˜çš„ç—…å› ï¼Œæ—©æœŸè¨ºæ–·å¯èƒ½æ”¹è®Šæ²»ç™‚æ–¹å‘ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š ç››è¡Œç‡å·®ç•°</h4>
    <table><thead><tr><th>è‡¨åºŠå ´åŸŸ</th><th>ç¹¼ç™¼æ€§é«˜è¡€å£“ç››è¡Œç‡</th><th>95% CI</th></tr></thead>
    <tbody><tr><td>åŸºå±¤é†«ç™‚/å­¸æ ¡ç¯©æª¢</td><td style="font-weight:600">9%</td><td>4.5-15%</td></tr>
    <tr><td>æ¬¡å°ˆç§‘é–€è¨º</td><td style="font-weight:600;color:var(--err)">44%</td><td>36-53%</td></tr></tbody></table>
    <div class="info"><strong>ğŸ’¡ è½‰ä»‹åå·® (Referral Bias)</strong><p style="font-size:13px;margin-top:6px">æ¬¡å°ˆç§‘é–€è¨ºçš„ç¹¼ç™¼æ€§é«˜è¡€å£“ç››è¡Œç‡è¼ƒé«˜ï¼Œåæ˜ äº†è½‰ä»‹æ‚£è€…é€šå¸¸æœ‰æ›´è¤‡é›œçš„ç—…æƒ…æˆ–ç–‘ä¼¼ç¹¼ç™¼æ€§åŸå› ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ©º å¸¸è¦‹ç¹¼ç™¼æ€§åŸå› </h4>
    <div class="grid-2">
        <div style="background:#E8F5E9;padding:12px;border-radius:10px"><div style="font-weight:600;color:var(--pri);margin-bottom:6px">è…è‡Ÿç–¾ç—…</div><div style="font-size:12px;color:var(--txt2)">â€¢ è…å¯¦è³ªç–¾ç—…<br>â€¢ è…è¡€ç®¡ç–¾ç—…<br>â€¢ è…ç™¼è‚²ç•°å¸¸</div></div>
        <div style="background:#E3F2FD;padding:12px;border-radius:10px"><div style="font-weight:600;color:var(--blue);margin-bottom:6px">å…§åˆ†æ³Œç–¾ç—…</div><div style="font-size:12px;color:var(--txt2)">â€¢ å—œé‰»ç´°èƒç˜¤<br>â€¢ åº«æ¬£ç—‡å€™ç¾¤<br>â€¢ ç”²ç‹€è…ºç–¾ç—…</div></div>
        <div style="background:#EDE7F6;padding:12px;border-radius:10px"><div style="font-weight:600;color:var(--pur);margin-bottom:6px">å¿ƒè¡€ç®¡ç–¾ç—…</div><div style="font-size:12px;color:var(--txt2)">â€¢ ä¸»å‹•è„ˆç‹¹çª„<br>â€¢ è¡€ç®¡ç‚</div></div>
        <div style="background:#FFF3E0;padding:12px;border-radius:10px"><div style="font-weight:600;color:var(--acc);margin-bottom:6px">å…¶ä»–åŸå› </div><div style="font-size:12px;color:var(--txt2)">â€¢ è—¥ç‰©ç›¸é—œ<br>â€¢ ç¥ç¶“ç³»çµ±ç–¾ç—…</div></div>
    </div>`,
    2: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ ç—…å²è¦é»</h4><p style="font-size:13px">å¹´é½¡ã€å®¶æ—å²ã€å‡ºç”Ÿå²ã€é«”é‡æ˜¯è©•ä¼°ç¹¼ç™¼æ€§é«˜è¡€å£“çš„é‡è¦ç—…å²å› ç´ ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š å¢åŠ ç¹¼ç™¼æ€§é«˜è¡€å£“å¯èƒ½æ€§çš„ç™¼ç¾</h4>
    <table><thead><tr><th>è‡¨åºŠç™¼ç¾</th><th>æ•æ„Ÿåº¦</th><th>ç‰¹ç•°åº¦</th><th>LR+</th></tr></thead>
    <tbody><tr><td style="text-align:left;font-weight:600">ç¹¼ç™¼æ€§HTNå®¶æ—å²</td><td>46%</td><td>90%</td><td><span class="lr-high">4.7</span></td></tr>
    <tr><td style="text-align:left;font-weight:600">é«”é‡â‰¤ç¬¬10ç™¾åˆ†ä½</td><td>27%</td><td>94%</td><td><span class="lr-high">4.5</span></td></tr>
    <tr><td style="text-align:left;font-weight:600">æ—©ç”¢å²</td><td>17-33%</td><td>86-94%</td><td><span class="lr-mod">2.3-2.8</span></td></tr>
    <tr><td style="text-align:left;font-weight:600">å¹´é½¡ â‰¤6æ­²</td><td>25-36%</td><td>86-88%</td><td><span class="lr-mod">2.2-2.6</span></td></tr></tbody></table>
    <div class="good"><strong>âœ“ è‡¨åºŠæ„ç¾©</strong><p style="font-size:13px;margin-top:6px">ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²çš„LR+ = 4.7æ˜¯ç—…å²ä¸­è¨ºæ–·åƒ¹å€¼æœ€é«˜çš„ç™¼ç¾ï¼Œä½†æ•æ„Ÿåº¦åªæœ‰46%ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š é™ä½ç¹¼ç™¼æ€§é«˜è¡€å£“å¯èƒ½æ€§çš„ç™¼ç¾</h4>
    <table><thead><tr><th>è‡¨åºŠç™¼ç¾</th><th>LR</th><th>95% CI</th></tr></thead>
    <tbody><tr><td style="text-align:left;font-weight:600">ç„¡ç—‡ç‹€è¡¨ç¾</td><td><span class="lr-low">0.19-0.36</span></td><td>-</td></tr>
    <tr><td style="text-align:left;font-weight:600">è‚¥èƒ–</td><td><span class="lr-low">0.34</span></td><td>0.13-0.90</td></tr>
    <tr><td style="text-align:left;font-weight:600">ä»»ä½•HTNå®¶æ—å²</td><td><span class="lr-low">0.42</span></td><td>0.30-0.57</td></tr></tbody></table>
    <div class="tip"><strong>ğŸ” å€åˆ†å…©ç¨®å®¶æ—å²</strong><p style="font-size:13px;margin-top:6px">â€¢ ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²ï¼šLR+ = 4.7 (å¢åŠ ç¹¼ç™¼æ€§å¯èƒ½)<br>â€¢ ä»»ä½•é«˜è¡€å£“å®¶æ—å²ï¼šLR = 0.42 (é™ä½ç¹¼ç™¼æ€§å¯èƒ½)</p></div>
    <div class="purple"><strong>âŒ ç„¡é‘‘åˆ¥åƒ¹å€¼çš„ç™¼ç¾</strong><p style="font-size:13px;margin-top:6px">ä»¥ä¸‹ç™¼ç¾ç„¡æ³•å€åˆ†åŸç™¼æ€§èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ï¼šé«˜è¡€å£“åˆ†æœŸã€é ­ç—›ç—‡ç‹€ã€å·¦å¿ƒå®¤è‚¥åš (LVH)</p></div>`,
    3: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ å¯¦é©—å®¤æª¢æŸ¥</h4><p style="font-size:13px">å¾®é‡ç™½è›‹ç™½å°¿å’Œè¡€æ¸…å°¿é…¸æ˜¯å…·æœ‰è¨ºæ–·åƒ¹å€¼çš„å¯¦é©—å®¤æŒ‡æ¨™ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ”¬ å¾®é‡ç™½è›‹ç™½å°¿ (Microalbuminuria)</h4>
    <div class="stat-box" style="background:#E3F2FD;margin-bottom:16px">
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr;gap:10px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--blue)">13%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--blue)">99%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">13</div></div>
        </div>
    </div>
    <div class="good"><strong>âœ“ è‡¨åºŠæ„ç¾©</strong><p style="font-size:13px;margin-top:6px">å¾®é‡ç™½è›‹ç™½å°¿æ˜¯æœ¬ç ”ç©¶ä¸­LR+æœ€é«˜çš„å¯¦é©—å®¤æŒ‡æ¨™ (LR+ = 13)ã€‚ç•¶ç™¼ç¾å¾®é‡ç™½è›‹ç™½å°¿æ™‚ï¼Œæ‡‰é«˜åº¦æ‡·ç–‘ç¹¼ç™¼æ€§é«˜è¡€å£“ï¼Œç‰¹åˆ¥æ˜¯è…è‡Ÿç›¸é—œç—…å› ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ§ª è¡€æ¸…å°¿é…¸ (Serum Uric Acid)</h4>
    <table><thead><tr><th>å°¿é…¸æ¿ƒåº¦</th><th>æ•æ„Ÿåº¦</th><th>ç‰¹ç•°åº¦</th><th>LR+</th></tr></thead>
    <tbody><tr><td style="font-weight:600">â‰¤5.5 mg/dL</td><td>70-73%</td><td>65-89%</td><td><span class="lr-mod">2.1-6.3</span></td></tr></tbody></table>
    <div class="info"><strong>ğŸ’¡ æ©Ÿåˆ¶è§£é‡‹</strong><p style="font-size:13px;margin-top:6px">åŸç™¼æ€§é«˜è¡€å£“å¸¸èˆ‡ä»£è¬ç—‡å€™ç¾¤ç›¸é—œï¼Œè¡€æ¸…å°¿é…¸é€šå¸¸è¼ƒé«˜ã€‚ç¹¼ç™¼æ€§é«˜è¡€å£“æ‚£è€…å¯èƒ½å› ä¸åŒçš„ç—…ç†æ©Ÿåˆ¶è€Œå°¿é…¸è¼ƒä½ã€‚</p></div>
    <div class="warn" style="margin-top:16px"><strong>âš ï¸ é‡è¦æé†’</strong><p style="font-size:13px;margin-top:6px">é›–ç„¶å¾®é‡ç™½è›‹ç™½å°¿çš„LR+å¾ˆé«˜ï¼Œä½†æ•æ„Ÿåº¦åªæœ‰13%ï¼Œå¤§å¤šæ•¸ç¹¼ç™¼æ€§é«˜è¡€å£“æ‚£è€…ä¸æœƒæœ‰æ­¤ç™¼ç¾ã€‚æª¢æŸ¥é™°æ€§ä¸èƒ½æ’é™¤ç¹¼ç™¼æ€§é«˜è¡€å£“ã€‚</p></div>`,
    4: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ å‹•æ…‹è¡€å£“ç›£æ¸¬</h4><p style="font-size:13px">24å°æ™‚å‹•æ…‹è¡€å£“ç›£æ¸¬ (ABPM) çš„è¡€å£“è² è·æ¨¡å¼å¯æä¾›è¨ºæ–·ç·šç´¢ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š è¡€å£“è² è· (BP Load) å®šç¾©</h4>
    <div class="formula">è¡€å£“è² è· = è¡€å£“è®€æ•¸ â‰¥ 95th ç™¾åˆ†ä½çš„æ¯”ä¾‹</div>
    <div class="info"><strong>ğŸ’¡ èªªæ˜</strong><p style="font-size:13px;margin-top:6px">è¡€å£“è² è·æ˜¯æŒ‡åœ¨ABPMç›£æ¸¬æœŸé–“ï¼Œè¡€å£“è®€æ•¸è¶…éè©²å¹´é½¡ã€æ€§åˆ¥ã€èº«é«˜ç¬¬95ç™¾åˆ†ä½çš„æ¯”ä¾‹ã€‚æ­£å¸¸æ‡‰<25%ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸŒ™ ABPMç™¼ç¾èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“</h4>
    <div class="stat-box" style="background:#EDE7F6;margin-bottom:16px">
        <div style="font-weight:700;color:var(--pur);margin-bottom:10px">å¢åŠ ç™½å¤©èˆ’å¼µå£“è² è· + å¢åŠ å¤œé–“æ”¶ç¸®å£“è² è·</div>
        <div class="grid-2" style="grid-template-columns:1fr 1fr 1fr;gap:10px;text-align:center">
            <div><div class="label">æ•æ„Ÿåº¦</div><div class="value" style="color:var(--pur)">40%</div></div>
            <div><div class="label">ç‰¹ç•°åº¦</div><div class="value" style="color:var(--pur)">82%</div></div>
            <div><div class="label">LR+</div><div class="value" style="color:var(--suc)">4.8</div></div>
        </div>
        <div style="font-size:11px;color:var(--txt2);margin-top:8px">95% CI: 1.2-20</div>
    </div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ• æ—¥å¤œè¡€å£“æ¨¡å¼</h4>
    <div class="grid-2">
        <div style="background:#FFF9C4;padding:12px;border-radius:10px"><div style="font-weight:600;color:#F57F17;margin-bottom:6px">â˜€ï¸ ç™½å¤©</div><p style="font-size:12px;color:var(--txt2)">èˆ’å¼µå£“è² è·å¢åŠ èˆ‡ç¹¼ç™¼æ€§HTNç›¸é—œ</p></div>
        <div style="background:#E1F5FE;padding:12px;border-radius:10px"><div style="font-weight:600;color:#0288D1;margin-bottom:6px">ğŸŒ™ å¤œé–“</div><p style="font-size:12px;color:var(--txt2)">æ”¶ç¸®å£“è² è·å¢åŠ èˆ‡ç¹¼ç™¼æ€§HTNç›¸é—œ</p></div>
    </div>
    <div class="good" style="margin-top:16px"><strong>âœ“ è‡¨åºŠæ‡‰ç”¨</strong><p style="font-size:13px;margin-top:6px">ABPMä¸åƒ…ç”¨æ–¼ç¢ºè¨ºé«˜è¡€å£“ï¼Œå…¶è¡€å£“è² è·æ¨¡å¼é‚„å¯æä¾›ç¹¼ç™¼æ€§é«˜è¡€å£“çš„è¨ºæ–·ç·šç´¢ã€‚</p></div>`,
    5: `<div class="key-point"><h4 style="font-size:14px;margin-bottom:8px">ğŸ”‘ è‡¨åºŠæ±ºç­–</h4><p style="font-size:13px">ç¶œåˆå¤šé …å› ç´ è©•ä¼°ï¼Œæ²’æœ‰å–®ä¸€ç™¼ç¾å¯ç¢ºè¨ºæˆ–æ’é™¤ç¹¼ç™¼æ€§é«˜è¡€å£“ã€‚</p></div>
    <h4 style="font-weight:700;margin-top:20px;margin-bottom:12px;color:var(--pri)">ğŸ“Š ä¼¼ç„¶æ¯”æ‡‰ç”¨é€ŸæŸ¥è¡¨</h4>
    <table><thead><tr><th>ç™¼ç¾</th><th>LR</th><th>æ–¹å‘</th></tr></thead>
    <tbody>
    <tr><td style="text-align:left">å¾®é‡ç™½è›‹ç™½å°¿</td><td><span class="lr-high">13</span></td><td>â†‘â†‘â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr><td style="text-align:left">ABPMç‰¹å®šæ¨¡å¼</td><td><span class="lr-high">4.8</span></td><td>â†‘â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr><td style="text-align:left">ç¹¼ç™¼æ€§HTNå®¶æ—å²</td><td><span class="lr-high">4.7</span></td><td>â†‘â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr><td style="text-align:left">ä½é«”é‡ (â‰¤10%tile)</td><td><span class="lr-high">4.5</span></td><td>â†‘â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr><td style="text-align:left">æ—©ç”¢å²</td><td><span class="lr-mod">2.3-2.8</span></td><td>â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr><td style="text-align:left">å¹´é½¡â‰¤6æ­²</td><td><span class="lr-mod">2.2-2.6</span></td><td>â†‘ ç¹¼ç™¼æ€§</td></tr>
    <tr style="background:#FFEBEE"><td style="text-align:left">ä»»ä½•HTNå®¶æ—å²</td><td><span class="lr-low">0.42</span></td><td>â†“ ç¹¼ç™¼æ€§</td></tr>
    <tr style="background:#FFEBEE"><td style="text-align:left">è‚¥èƒ–</td><td><span class="lr-low">0.34</span></td><td>â†“ ç¹¼ç™¼æ€§</td></tr>
    <tr style="background:#FFEBEE"><td style="text-align:left">ç„¡ç—‡ç‹€è¡¨ç¾</td><td><span class="lr-low">0.19-0.36</span></td><td>â†“â†“ ç¹¼ç™¼æ€§</td></tr>
    </tbody></table>
    <div class="warn" style="margin-top:16px"><strong>âš ï¸ ç ”ç©¶çµè«–</strong><p style="font-size:13px;margin-top:6px"><strong>æ²’æœ‰ä»»ä½•å–®ä¸€ç—‡ç‹€æˆ–å¾µè±¡å¯ä»¥å®Œå…¨å€åˆ†ç¹¼ç™¼æ€§èˆ‡åŸç™¼æ€§é«˜è¡€å£“ã€‚</strong>è‡¨åºŠæ±ºç­–éœ€è¦ç¶œåˆè€ƒé‡å¤šé …å› ç´ ã€‚</p></div>
    <div class="good" style="margin-top:16px"><strong>âœ“ é«˜åº¦æ‡·ç–‘ç¹¼ç™¼æ€§æ™‚</strong><p style="font-size:13px;margin-top:6px">ç•¶æ‚£è€…å…·å‚™å¤šé …é«˜ä¼¼ç„¶æ¯”çš„ç™¼ç¾ï¼ˆå¦‚å¹´å¹¼ã€ä½é«”é‡ã€æœ‰ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²ã€å¾®é‡ç™½è›‹ç™½å°¿ï¼‰ï¼Œæ‡‰ç©æ¥µé€²è¡Œç¹¼ç™¼æ€§é«˜è¡€å£“çš„æª¢æŸ¥è©•ä¼°ã€‚</p></div>
    <div class="pink" style="margin-top:16px"><strong>ğŸ’ åŸç™¼æ€§é«˜è¡€å£“å‚¾å‘</strong><p style="font-size:13px;margin-top:6px">ç•¶æ‚£è€…ç‚ºè‚¥èƒ–é’å°‘å¹´ã€ç„¡ç—‡ç‹€ã€æœ‰åŸç™¼æ€§é«˜è¡€å£“å®¶æ—å²æ™‚ï¼ŒåŸç™¼æ€§é«˜è¡€å£“çš„å¯èƒ½æ€§è¼ƒé«˜ï¼Œä½†ä»éœ€ä¾æ“šæŒ‡å¼•å®ŒæˆåŸºæœ¬æª¢æŸ¥ã€‚</p></div>`
};

const quiz = [
    {q:'æ ¹æ“šJAMAç³»çµ±æ€§å›é¡§ï¼Œåœ¨æ¬¡å°ˆç§‘é–€è¨ºä¸­ï¼Œå…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“çš„ç››è¡Œç‡ç´„ç‚ºå¤šå°‘ï¼Ÿ',o:['ç´„ 9%','ç´„ 25%','ç´„ 44%','ç´„ 70%'],c:2,e:'åœ¨æ¬¡å°ˆç§‘é–€è¨ºä¸­ï¼Œç¹¼ç™¼æ€§é«˜è¡€å£“çš„ç››è¡Œç‡ç‚º44% (95% CI: 36%-53%)ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨åŸºå±¤é†«ç™‚æˆ–å­¸æ ¡ç¯©æª¢ä¸­åƒ…ç‚º9%ã€‚'},
    {q:'å“ªä¸€é …ç—…å²ç™¼ç¾èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“çš„é—œè¯æ€§æœ€å¼·ï¼ˆLR+æœ€é«˜ï¼‰ï¼Ÿ',o:['æ—©ç”¢å²','è‚¥èƒ–','ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²','ä»»ä½•é«˜è¡€å£“å®¶æ—å²'],c:2,e:'ç¹¼ç™¼æ€§é«˜è¡€å£“å®¶æ—å²çš„ LR+ = 4.7 (95% CI: 2.9-7.6)ï¼Œæ˜¯ç—…å²ç™¼ç¾ä¸­è¨ºæ–·åƒ¹å€¼æœ€é«˜çš„ã€‚'},
    {q:'é—œæ–¼å¹´é½¡èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“çš„é—œä¿‚ï¼Œä»¥ä¸‹ä½•è€…æ­£ç¢ºï¼Ÿ',o:['å¹´é½¡â‰¤6æ­²èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ç„¡é—œ','å¹´é½¡â‰¤6æ­²çš„LR+ç´„ç‚º2.2-2.6','å¹´é½¡è¶Šå¤§è¶Šå¯èƒ½æ˜¯ç¹¼ç™¼æ€§','å¹´é½¡æ˜¯æ’é™¤ç¹¼ç™¼æ€§çš„æœ€ä½³æŒ‡æ¨™'],c:1,e:'å¹´é½¡â‰¤6æ­²èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ç›¸é—œï¼ŒLR+ ç´„ 2.2-2.6ã€‚'},
    {q:'å¾®é‡ç™½è›‹ç™½å°¿è¨ºæ–·ç¹¼ç™¼æ€§é«˜è¡€å£“çš„ç‰¹ç•°åº¦ç´„ç‚ºå¤šå°‘ï¼Ÿ',o:['70%','85%','99%','50%'],c:2,e:'å¾®é‡ç™½è›‹ç™½å°¿çš„ç‰¹ç•°åº¦é«˜é”99%ï¼Œä½†æ•æ„Ÿåº¦åƒ…13%ï¼Œå› æ­¤ LR+ = 13ã€‚'},
    {q:'è¡€æ¸…å°¿é…¸æ¿ƒåº¦â‰¤5.5 mg/dL èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“çš„é—œä¿‚ç‚ºä½•ï¼Ÿ',o:['èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ç„¡é—œ','æç¤ºåŸç™¼æ€§é«˜è¡€å£“','æç¤ºç¹¼ç™¼æ€§é«˜è¡€å£“ï¼ŒLR+ 2.1-6.3','åªåœ¨æˆäººæœ‰è¨ºæ–·åƒ¹å€¼'],c:2,e:'ä½è¡€æ¸…å°¿é…¸æ¿ƒåº¦ (â‰¤5.5 mg/dL) èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ç›¸é—œï¼ŒLR+ 2.1-6.3ã€‚'},
    {q:'ä»¥ä¸‹ä½•è€…èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“çš„å¯èƒ½æ€§é™ä½æœ€ç›¸é—œï¼Ÿ',o:['æœ‰ç—‡ç‹€è¡¨ç¾','é ­ç—›','è‚¥èƒ– (LR 0.34)','å·¦å¿ƒå®¤è‚¥åš'],c:2,e:'è‚¥èƒ–çš„ LR = 0.34ï¼Œæ„å‘³è‘—è‚¥èƒ–æ‚£è€…æ›´å¯èƒ½æ˜¯åŸç™¼æ€§é«˜è¡€å£“è€Œéç¹¼ç™¼æ€§ã€‚'},
    {q:'ä»»ä½•é«˜è¡€å£“å®¶æ—å²å°è¨ºæ–·ç¹¼ç™¼æ€§é«˜è¡€å£“çš„æ„ç¾©ç‚ºä½•ï¼Ÿ',o:['å¢åŠ ç¹¼ç™¼æ€§é«˜è¡€å£“å¯èƒ½æ€§','é™ä½ç¹¼ç™¼æ€§é«˜è¡€å£“å¯èƒ½æ€§ (LR 0.42)','ç„¡è¨ºæ–·åƒ¹å€¼','åªåœ¨é’å°‘å¹´æœ‰æ„ç¾©'],c:1,e:'ä»»ä½•é«˜è¡€å£“å®¶æ—å²çš„ LR = 0.42ï¼Œæ„å‘³è‘—æœ‰é«˜è¡€å£“å®¶æ—å²è€…æ›´å¯èƒ½æ˜¯åŸç™¼æ€§é«˜è¡€å£“ã€‚'},
    {q:'24å°æ™‚ABPMä¸­ï¼Œå“ªç¨®çµ„åˆèˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“æœ€ç›¸é—œï¼Ÿ',o:['ç™½å¤©æ”¶ç¸®å£“è² è·å¢åŠ ','å¤œé–“èˆ’å¼µå£“è² è·å¢åŠ ','ç™½å¤©èˆ’å¼µå£“è² è·+å¤œé–“æ”¶ç¸®å£“è² è·å¢åŠ ','å–®ç´”å¤œé–“è¡€å£“å‡é«˜'],c:2,e:'ç™½å¤©èˆ’å¼µå£“è² è·å¢åŠ åˆä½µå¤œé–“æ”¶ç¸®å£“è² è·å¢åŠ çš„ LR+ = 4.8ã€‚'},
    {q:'é—œæ–¼é«˜è¡€å£“åˆ†æœŸå°é‘‘åˆ¥åŸç™¼æ€§èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“çš„åƒ¹å€¼ï¼Œç ”ç©¶ç™¼ç¾ä»€éº¼ï¼Ÿ',o:['ç¬¬2æœŸé«˜è¡€å£“æ›´å¯èƒ½æ˜¯ç¹¼ç™¼æ€§','ç¬¬1æœŸé«˜è¡€å£“æ›´å¯èƒ½æ˜¯ç¹¼ç™¼æ€§','é«˜è¡€å£“åˆ†æœŸç„¡æ³•å€åˆ†å…©è€…','åªæœ‰ç¬¬3æœŸæ‰èƒ½å€åˆ†'],c:2,e:'ç ”ç©¶ç™¼ç¾é«˜è¡€å£“åˆ†æœŸç„¡æ³•å€åˆ†åŸç™¼æ€§èˆ‡ç¹¼ç™¼æ€§é«˜è¡€å£“ã€‚'},
    {q:'æ ¹æ“šJAMAç ”ç©¶çµè«–ï¼Œé—œæ–¼å…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“çš„è¨ºæ–·ï¼Œä»¥ä¸‹ä½•è€…æœ€æ­£ç¢ºï¼Ÿ',o:['å–®ä¸€ç—‡ç‹€æˆ–å¾µè±¡å³å¯ç¢ºè¨ºç¹¼ç™¼æ€§é«˜è¡€å£“','ç„¡å€‹åˆ¥ç—‡ç‹€æˆ–å¾µè±¡å¯å®Œå…¨å€åˆ†ç¹¼ç™¼æ€§èˆ‡åŸç™¼æ€§é«˜è¡€å£“','æ‰€æœ‰é«˜è¡€å£“å…’ç«¥éƒ½éœ€è¦å®Œæ•´ç¹¼ç™¼æ€§é«˜è¡€å£“æª¢æŸ¥','è‚¥èƒ–å…’ç«¥ä¸éœ€æª¢æŸ¥ç¹¼ç™¼æ€§é«˜è¡€å£“'],c:1,e:'ç ”ç©¶çµè«–ï¼šæ²’æœ‰ä»»ä½•å–®ä¸€ç—‡ç‹€æˆ–å¾µè±¡å¯ä»¥å®Œå…¨å€åˆ†ç¹¼ç™¼æ€§èˆ‡åŸç™¼æ€§é«˜è¡€å£“ã€‚'}
];

const MODULE_ID = 'jama-pediatric-htn';

// Badge definitions for notifications
const badgeDefs = {
    'first-quiz': { name: 'åˆè©¦å•¼è²', icon: 'ğŸ¯' },
    'perfect-score': { name: 'æ»¿åˆ†é”äºº', icon: 'ğŸ’¯' },
    'five-complete': { name: 'å°æœ‰æˆå°±', icon: 'â­' },
    'ten-complete': { name: 'å­¸æœ‰å°ˆç²¾', icon: 'ğŸŒŸ' },
    'master': { name: 'EBMå¤§å¸«', icon: 'ğŸ‘‘' },
    'speed-demon': { name: 'ç¥é€Ÿç­”é¡Œ', icon: 'âš¡' },
    'persistent': { name: 'å …æŒä¸æ‡ˆ', icon: 'ğŸ’ª' },
    'three-streak': { name: 'é€£å‹ä¸‰å ´', icon: 'ğŸ”¥' },
    'five-streak': { name: 'äº”é€£å‹', icon: 'ğŸ†' },
    'triple-perfect': { name: 'ä¸‰å† ç‹', icon: 'ğŸ‘‘' },
    'early-bird': { name: 'æ—©èµ·çš„é³¥', icon: 'ğŸ¦' },
    'night-owl': { name: 'å¤œè²“å­', icon: 'ğŸ¦‰' },
    'weekend-warrior': { name: 'å‡æ—¥æˆ°å£«', icon: 'ğŸ“…' },
    'comeback-kid': { name: 'é€†è½‰å‹', icon: 'ğŸš€' },
    'quick-learner': { name: 'ä¸€é»å°±é€š', icon: 'ğŸ’¡' },
    'improvement-king': { name: 'é€²æ­¥ç‹', icon: 'ğŸ“ˆ' },
    'marathon-runner': { name: 'é¦¬æ‹‰æ¾å­¸ç¿’è€…', icon: 'ğŸƒ' },
    'reviewer': { name: 'æº«æ•…çŸ¥æ–°', icon: 'ğŸ“–' },
    'almost-there': { name: 'å·®ä¸€é»é»', icon: 'ğŸ˜…' },
    'generous-guesser': { name: 'ä½›ç³»ç­”é¡Œ', icon: 'ğŸ™' },
    'learning-worm': { name: 'å­¸è¡“èš¯èš“', icon: 'ğŸª±' },
    'eternal-student': { name: 'æ°¸æ†çš„å­¸ç”Ÿ', icon: 'â™¾ï¸' },
    'speed-fail': { name: 'å…‰é€Ÿé™£äº¡', icon: 'ğŸ’«' },
    'slow-and-wrong': { name: 'æƒ³å¾ˆä¹…é‚„æ˜¯éŒ¯', icon: 'ğŸ¤”' },
    'zero-hero': { name: 'é›¶åˆ†è‹±é›„', icon: 'ğŸ’€' },
    'procrastinator': { name: 'æœ€å¾Œä¸€ç§’', icon: 'â°' },
    'deja-vu': { name: 'æ—¢è¦–æ„Ÿ', icon: 'ğŸ‘€' },
    'coffee-needed': { name: 'éœ€è¦å’–å•¡', icon: 'â˜•' },
    'wanderer': { name: 'æ¼«éŠè€…', icon: 'ğŸ§­' },
    'consistent-output': { name: 'ç©©å®šè¼¸å‡º', icon: 'ğŸ¯' },
    'heart-expert': { name: 'å¿ƒè‡Ÿé”äºº', icon: 'â¤ï¸' },
    'critical-master': { name: 'æ€¥é‡ç—‡å°ˆå®¶', icon: 'ğŸš¨' },
    'neuro-ninja': { name: 'ç¥ç¶“å¿è€…', icon: 'ğŸ§ ' },
    'pulm-pro': { name: 'èƒ¸è…”é«˜æ‰‹', icon: 'ğŸ«' },
    'ebm-foundation': { name: 'EBMåŸºçŸ³', icon: 'ğŸ›ï¸' },
    'jama-collector': { name: 'JAMAæ”¶è—å®¶', icon: 'ğŸ“š' },
    'achievement-hunter': { name: 'æˆå°±çµäºº', icon: 'ğŸ…' },
    'lucky-seven': { name: 'å¹¸é‹ä¸ƒ', icon: 'ğŸ€' },
    'completionist': { name: 'å…¨æˆå°±é”æˆ', icon: 'ğŸ–ï¸' }
};

const categoryModules = {
    cardio: ['jama-chest-pain-acs', 'jama-syncope', 'jama-hypertension'],
    critical: ['jama-bacteremia', 'jama-gi-bleed', 'jama-fluid-responsiveness', 'jama-difficult-intubation', 'jama-cirrhosis', 'jama-wound-infection'],
    neuro: ['jama-head-trauma', 'jama-delirium', 'jama-decision-capacity'],
    pulm: ['jama-pleural-effusion', 'jama-osa'],
    core: ['critical-appraisal', 'diagnostic-study', 'prognosis-study', 'rct-appraisal', 'systematic-review', 'literature-search']
};

const ProgressTracker={
    STORAGE_KEY:'ebm-progress',
    newBadges: [],
    getProgress:()=>{try{const d=localStorage.getItem(ProgressTracker.STORAGE_KEY);return d?JSON.parse(d):{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}catch{return{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}},
    saveQuizResult:(moduleId,score,total,timeSpent)=>{
        ProgressTracker.newBadges = [];
        const progress=ProgressTracker.getProgress();
        const mod=progress.modules[moduleId]||{bestScore:0,totalAttempts:0,allAttempts:[],lessonsViewed:[],completed:false,firstCompleted:null};
        const attempt={date:new Date().toISOString(),score,timeSpent};
        mod.allAttempts.push(attempt);mod.totalAttempts++;
        if(score>mod.bestScore)mod.bestScore=score;
        const passingScore=Math.ceil(total*0.7);
        if(score>=passingScore&&!mod.completed){mod.completed=true;mod.firstCompleted=attempt.date}
        progress.modules[moduleId]=mod;progress.totalTimeSpent+=timeSpent;progress.lastUpdated=new Date().toISOString();
        ProgressTracker.checkBadges(progress,moduleId,score,total,timeSpent);
        localStorage.setItem(ProgressTracker.STORAGE_KEY,JSON.stringify(progress));return progress;
    },
    checkBadges:(progress,moduleId,score,total,timeSpent)=>{
        const badges=progress.badges||[];const ids=badges.map(b=>b.id);const now=new Date();const nowStr=now.toISOString();
        const hour=now.getHours();const day=now.getDay();
        const passed=score>=Math.ceil(total*0.7);const perfect=score===total;
        const addBadge=(id)=>{if(!ids.includes(id)){badges.push({id,earnedAt:nowStr});ids.push(id);ProgressTracker.newBadges.push(id);return true}return false};

        addBadge('first-quiz');
        if(perfect)addBadge('perfect-score');
        if(timeSpent<120&&passed)addBadge('speed-demon');
        const completed=Object.values(progress.modules).filter(m=>m.completed).length;
        if(completed>=5)addBadge('five-complete');
        if(completed>=10)addBadge('ten-complete');
        if(completed>=18)addBadge('master');
        const mod=progress.modules[moduleId];
        if(mod&&mod.totalAttempts>=3)addBadge('persistent');

        if(hour<6)addBadge('early-bird');
        if(hour>=0&&hour<5)addBadge('night-owl');
        if(day===0||day===6)addBadge('weekend-warrior');
        if(hour>=2&&hour<5&&!passed)addBadge('coffee-needed');

        const streakData=progress.streakData||{currentPassStreak:0,currentPerfectStreak:0};
        if(passed){streakData.currentPassStreak++;if(perfect)streakData.currentPerfectStreak++;else streakData.currentPerfectStreak=0}
        else{streakData.currentPassStreak=0;streakData.currentPerfectStreak=0}
        if(streakData.currentPassStreak>=3)addBadge('three-streak');
        if(streakData.currentPassStreak>=5)addBadge('five-streak');
        if(streakData.currentPerfectStreak>=3)addBadge('triple-perfect');
        progress.streakData=streakData;

        if(mod){
            if(mod.totalAttempts===1&&perfect)addBadge('quick-learner');
            if(mod.totalAttempts===1&&score===7)addBadge('lucky-seven');
            if(mod.allAttempts&&mod.allAttempts.length>1){
                const firstScore=mod.allAttempts[0].score;
                if(firstScore<7&&perfect)addBadge('comeback-kid');
                if(score-firstScore>=5)addBadge('improvement-king');
                const lastThree=mod.allAttempts.slice(-3);
                if(lastThree.length===3&&lastThree[0].score===lastThree[1].score&&lastThree[1].score===lastThree[2].score)addBadge('deja-vu');
                if(lastThree.length===3&&lastThree.every(a=>a.score===score))addBadge('consistent-output');
            }
            if(mod.totalAttempts>=10)addBadge('learning-worm');
            if(mod.completed&&mod.totalAttempts>1&&passed)addBadge('reviewer');
        }

        if(score===6)addBadge('almost-there');
        if(score===0)addBadge('zero-hero');
        if(score>=2&&score<=3)addBadge('generous-guesser');
        if(timeSpent<30&&!passed)addBadge('speed-fail');
        if(timeSpent>600&&!passed)addBadge('slow-and-wrong');

        const totalAttempts=Object.values(progress.modules).reduce((sum,m)=>sum+(m.totalAttempts||0),0);
        if(totalAttempts>=50&&completed<18)addBadge('eternal-student');
        const startedNotCompleted=Object.values(progress.modules).filter(m=>m.totalAttempts>0&&!m.completed).length;
        if(startedNotCompleted>=5&&completed===0)addBadge('wanderer');

        if(progress.lastActivityDate){
            const lastActivity=new Date(progress.lastActivityDate);
            const daysSince=(now-lastActivity)/(1000*60*60*24);
            if(daysSince>=7)addBadge('procrastinator');
        }
        progress.lastActivityDate=nowStr;

        const checkCat=(cat,badgeId)=>{const mods=categoryModules[cat]||[];if(mods.length>0&&mods.every(id=>progress.modules[id]?.completed))addBadge(badgeId)};
        checkCat('cardio','heart-expert');
        checkCat('critical','critical-master');
        checkCat('neuro','neuro-ninja');
        checkCat('pulm','pulm-pro');
        checkCat('core','ebm-foundation');
        const jamaComplete=Object.keys(progress.modules).filter(k=>k.startsWith('jama-')&&progress.modules[k]?.completed).length;
        if(jamaComplete>=12)addBadge('jama-collector');

        if(badges.length>=10)addBadge('achievement-hunter');
        if(badges.length>=39)addBadge('completionist');

        progress.badges=badges;
    }
};

// Badge notification toast component
function showBadgeToast(badges) {
    if (!badges || badges.length === 0) return;

    // Remove existing toast container if any
    const existingToast = document.getElementById('badge-toast-container');
    if (existingToast) existingToast.remove();

    const container = document.createElement('div');
    container.id = 'badge-toast-container';
    container.style.cssText = 'position:fixed;top:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:10px';

    badges.forEach((badgeId, i) => {
        const badge = badgeDefs[badgeId];
        if (!badge) return;

        const toast = document.createElement('div');
        toast.id = `badge-toast-${badgeId}`;
        toast.style.cssText = 'background:linear-gradient(135deg, #FFD700, #FFA500);padding:16px 20px;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.2);display:flex;align-items:center;gap:12px;animation:slideIn 0.5s ease-out;min-width:240px';
        toast.innerHTML = `
            <span style="font-size:36px">${badge.icon}</span>
            <div style="flex:1">
                <div style="font-size:12px;font-weight:600;color:#5D4037">æ–°æˆå°±è§£é–!</div>
                <div style="font-size:16px;font-weight:700;color:#3E2723">${badge.name}</div>
            </div>
            <button onclick="closeBadgeToast('${badgeId}')" style="background:rgba(0,0,0,0.1);border:none;border-radius:8px;width:28px;height:28px;cursor:pointer;font-size:14px">âœ•</button>
        `;
        container.appendChild(toast);
    });

    // Add animation style if not exists
    if (!document.getElementById('badge-toast-style')) {
        const style = document.createElement('style');
        style.id = 'badge-toast-style';
        style.textContent = '@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}';
        document.head.appendChild(style);
    }

    document.body.appendChild(container);

    // Auto-hide after 5 seconds
    setTimeout(() => {
        const toastContainer = document.getElementById('badge-toast-container');
        if (toastContainer) toastContainer.remove();
    }, 5000);
}

function closeBadgeToast(badgeId) {
    const toast = document.getElementById(`badge-toast-${badgeId}`);
    if (toast) toast.remove();
    const container = document.getElementById('badge-toast-container');
    if (container && container.children.length === 0) container.remove();
}

let currentLesson = 1;
let currentQ = 0;
let score = 0;
let answered = false;
let quizStartTime = null;

function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    window.scrollTo(0, 0);
}

function showHome() { showPage('home'); }

function showLesson(id) {
    currentLesson = id;
    const l = lessons[id-1];
    document.getElementById('lesson-title').textContent = l.title;
    document.getElementById('lesson-header').style.background = `linear-gradient(135deg,${l.color},${l.color}88)`;
    document.getElementById('lesson-header').innerHTML = `<div class="container"><div style="font-size:12px;opacity:0.9">Lesson ${l.id} â€¢ ${l.sub}</div><h1 style="font-size:22px;font-weight:700">${l.title}</h1></div>`;
    document.getElementById('lesson-body').innerHTML = lessonContent[id];
    document.getElementById('prev-btn').style.display = id > 1 ? 'block' : 'none';
    document.getElementById('next-btn').textContent = id < 5 ? 'ä¸‹ä¸€èª² â†’' : 'é–‹å§‹æ¸¬é©— ğŸ“';
    document.getElementById('next-btn').onclick = id < 5 ? nextLesson : startQuiz;
    showPage('lesson');
}

function prevLesson() { if (currentLesson > 1) showLesson(currentLesson - 1); }
function nextLesson() { if (currentLesson < 5) showLesson(currentLesson + 1); }

function startQuiz() {
    currentQ = 0; score = 0; answered = false;
    quizStartTime = Date.now();
    renderQuestion();
    showPage('quiz');
}

function renderQuestion() {
    const q = quiz[currentQ];
    document.getElementById('quiz-progress').textContent = `${currentQ+1}/${quiz.length}`;
    document.getElementById('quiz-progress-bar').style.width = `${((currentQ+1)/quiz.length)*100}%`;
    
    let html = `<h3 style="font-size:15px;font-weight:600;line-height:1.7;margin-bottom:20px">${q.q}</h3>`;
    q.o.forEach((opt, i) => {
        html += `<button class="quiz-option" onclick="selectAnswer(${i})" id="opt${i}">
            <span class="option-label" id="lbl${i}">${String.fromCharCode(65+i)}</span>
            <span style="line-height:1.5">${opt}</span>
        </button>`;
    });
    document.getElementById('quiz-content').innerHTML = html;
    document.getElementById('quiz-feedback').innerHTML = '';
    document.getElementById('quiz-next').style.display = 'none';
    answered = false;
}

function selectAnswer(i) {
    if (answered) return;
    answered = true;
    const q = quiz[currentQ];
    
    document.querySelectorAll('.quiz-option').forEach((btn, idx) => {
        btn.classList.add('disabled');
        if (idx === q.c) {
            btn.classList.add('correct');
            document.getElementById('lbl'+idx).classList.add('correct');
            document.getElementById('lbl'+idx).textContent = 'âœ“';
        } else if (idx === i && i !== q.c) {
            btn.classList.add('wrong');
            document.getElementById('lbl'+idx).classList.add('wrong');
            document.getElementById('lbl'+idx).textContent = 'âœ—';
        }
    });
    
    if (i === q.c) score++;
    
    const feedbackClass = i === q.c ? 'good' : 'tip';
    const feedbackTitle = i === q.c ? 'âœ“ æ­£ç¢ºï¼' : 'âœ— ç­”éŒ¯äº†';
    const feedbackColor = i === q.c ? 'var(--suc)' : 'var(--acc)';
    document.getElementById('quiz-feedback').innerHTML = `<div class="${feedbackClass}"><strong style="color:${feedbackColor}">${feedbackTitle}</strong><p style="font-size:13px;color:var(--txt2);margin-top:8px;line-height:1.7">${q.e}</p></div>`;
    
    document.getElementById('quiz-next').style.display = 'block';
    document.getElementById('quiz-next').textContent = currentQ < quiz.length - 1 ? 'ä¸‹ä¸€é¡Œ â†’' : 'æŸ¥çœ‹çµæœ';
}

function nextQuestion() {
    if (currentQ < quiz.length - 1) {
        currentQ++;
        renderQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    const pct = Math.round((score / quiz.length) * 100);
    const color = pct >= 80 ? 'var(--suc)' : pct >= 60 ? 'var(--warn)' : 'var(--err)';
    document.getElementById('result-circle').style.background = `conic-gradient(${color} ${pct*3.6}deg, #E5E5E5 0deg)`;
    document.getElementById('result-pct').textContent = pct + '%';
    document.getElementById('result-score').textContent = `${score}/${quiz.length}`;
    document.getElementById('result-title').textContent = pct >= 80 ? 'ğŸ‰ å¤ªæ£’äº†ï¼' : pct >= 60 ? 'ğŸ‘ ä¸éŒ¯ï¼' : 'ğŸ’ª åŠ æ²¹ï¼';
    document.getElementById('result-msg').textContent = pct >= 80 ? 'ä½ å·²ç¶“æŒæ¡å…’ç«¥ç¹¼ç™¼æ€§é«˜è¡€å£“è¨ºæ–·ï¼' : pct >= 60 ? 'å†è¤‡ç¿’å¯ä»¥æ›´é€²æ­¥ï¼' : 'å»ºè­°é‡æ–°é–±è®€èª²ç¨‹';

    // Save progress
    if (quizStartTime) {
        const timeSpent = Math.round((Date.now() - quizStartTime) / 1000);
        ProgressTracker.saveQuizResult(MODULE_ID, score, quiz.length, timeSpent);
        if (ProgressTracker.newBadges.length > 0) {
            showBadgeToast(ProgressTracker.newBadges);
        }
    }

    showPage('result');
}
</script>
</body>
</html>
