<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é å¾Œç ”ç©¶è©•è®€ | EBM æ•™å­¸å¹³å°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--pri:#4361EE;--pri2:#3A0CA3;--blue:#0077B6;--pur:#7209B7;--teal:#2EC4B6;--orange:#FF6B35;--pink:#F72585;--suc:#38A169;--warn:#D69E2E;--err:#E53E3E;--bg:#F0F4FF;--txt:#1A1A2E;--txt2:#6B7280}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg);color:var(--txt);line-height:1.7}
        .card{background:#fff;border-radius:16px;padding:20px;margin-bottom:16px;box-shadow:0 2px 12px rgba(67,97,238,0.08)}
        .btn{padding:14px 24px;border:none;border-radius:12px;font-size:15px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
        .btn-pri{background:linear-gradient(135deg,var(--pri),var(--pri2));color:#fff}
        table{width:100%;border-collapse:collapse;font-size:13px;margin:12px 0}
        th,td{padding:10px;text-align:center;border-bottom:1px solid #eee}
        th{background:#EEF2FF;font-weight:600;color:var(--pri)}
        .formula{background:linear-gradient(135deg,#EEF2FF,#E0E7FF);border:2px solid var(--pri);border-radius:12px;padding:16px;margin:12px 0;text-align:center;font-size:16px;color:#3730A3;font-weight:600}
        .tip{background:#FFFBEB;border-left:4px solid var(--warn);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .good{background:#F0FFF4;border-left:4px solid var(--suc);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .info{background:#EBF8FF;border-left:4px solid var(--blue);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .alertbox{background:#FFF5F5;border-left:4px solid var(--err);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
        .purple{background:#FAF5FF;border-left:4px solid var(--pur);border-radius:0 12px 12px 0;padding:14px;margin:12px 0}
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect}=React;

const MODULE_ID='prognosis-study';

// Badge definitions for notifications
const badgeDefs = {
    'first-quiz': { name: 'åˆè©¦å•¼è²', icon: 'ğŸ¯' },
    'perfect-score': { name: 'æ»¿åˆ†é”äºº', icon: 'ğŸ’¯' },
    'five-complete': { name: 'å°æœ‰æˆå°±', icon: 'â­' },
    'ten-complete': { name: 'å­¸æœ‰å°ˆç²¾', icon: 'ğŸŒŸ' },
    'master': { name: 'EBMå¤§å¸«', icon: 'ğŸ‘‘' },
    'speed-demon': { name: 'ç¥é€Ÿç­”é¡Œ', icon: 'âš¡' },
    'persistent': { name: 'å …æŒä¸æ‡ˆ', icon: 'ğŸ’ª' },
    'three-streak': { name: 'é€£å‹ä¸‰å ´', icon: 'ğŸ”¥' },
    'five-streak': { name: 'äº”é€£å‹', icon: 'ğŸ†' },
    'triple-perfect': { name: 'ä¸‰å† ç‹', icon: 'ğŸ‘‘' },
    'early-bird': { name: 'æ—©èµ·çš„é³¥', icon: 'ğŸ¦' },
    'night-owl': { name: 'å¤œè²“å­', icon: 'ğŸ¦‰' },
    'weekend-warrior': { name: 'å‡æ—¥æˆ°å£«', icon: 'ğŸ“…' },
    'comeback-kid': { name: 'é€†è½‰å‹', icon: 'ğŸš€' },
    'quick-learner': { name: 'ä¸€é»å°±é€š', icon: 'ğŸ’¡' },
    'improvement-king': { name: 'é€²æ­¥ç‹', icon: 'ğŸ“ˆ' },
    'marathon-runner': { name: 'é¦¬æ‹‰æ¾å­¸ç¿’è€…', icon: 'ğŸƒ' },
    'reviewer': { name: 'æº«æ•…çŸ¥æ–°', icon: 'ğŸ“–' },
    'almost-there': { name: 'å·®ä¸€é»é»', icon: 'ğŸ˜…' },
    'generous-guesser': { name: 'ä½›ç³»ç­”é¡Œ', icon: 'ğŸ™' },
    'learning-worm': { name: 'å­¸è¡“èš¯èš“', icon: 'ğŸª±' },
    'eternal-student': { name: 'æ°¸æ†çš„å­¸ç”Ÿ', icon: 'â™¾ï¸' },
    'speed-fail': { name: 'å…‰é€Ÿé™£äº¡', icon: 'ğŸ’«' },
    'slow-and-wrong': { name: 'æƒ³å¾ˆä¹…é‚„æ˜¯éŒ¯', icon: 'ğŸ¤”' },
    'zero-hero': { name: 'é›¶åˆ†è‹±é›„', icon: 'ğŸ’€' },
    'procrastinator': { name: 'æœ€å¾Œä¸€ç§’', icon: 'â°' },
    'deja-vu': { name: 'æ—¢è¦–æ„Ÿ', icon: 'ğŸ‘€' },
    'coffee-needed': { name: 'éœ€è¦å’–å•¡', icon: 'â˜•' },
    'wanderer': { name: 'æ¼«éŠè€…', icon: 'ğŸ§­' },
    'consistent-output': { name: 'ç©©å®šè¼¸å‡º', icon: 'ğŸ¯' },
    'heart-expert': { name: 'å¿ƒè‡Ÿé”äºº', icon: 'â¤ï¸' },
    'critical-master': { name: 'æ€¥é‡ç—‡å°ˆå®¶', icon: 'ğŸš¨' },
    'neuro-ninja': { name: 'ç¥ç¶“å¿è€…', icon: 'ğŸ§ ' },
    'pulm-pro': { name: 'èƒ¸è…”é«˜æ‰‹', icon: 'ğŸ«' },
    'ebm-foundation': { name: 'EBMåŸºçŸ³', icon: 'ğŸ›ï¸' },
    'jama-collector': { name: 'JAMAæ”¶è—å®¶', icon: 'ğŸ“š' },
    'achievement-hunter': { name: 'æˆå°±çµäºº', icon: 'ğŸ…' },
    'lucky-seven': { name: 'å¹¸é‹ä¸ƒ', icon: 'ğŸ€' },
    'completionist': { name: 'å…¨æˆå°±é”æˆ', icon: 'ğŸ–ï¸' }
};

const categoryModules = {
    cardio: ['jama-chest-pain-acs', 'jama-syncope', 'jama-hypertension'],
    critical: ['jama-bacteremia', 'jama-gi-bleed', 'jama-fluid-responsiveness', 'jama-difficult-intubation', 'jama-cirrhosis', 'jama-wound-infection'],
    neuro: ['jama-head-trauma', 'jama-delirium', 'jama-decision-capacity'],
    pulm: ['jama-pleural-effusion', 'jama-osa'],
    core: ['critical-appraisal', 'diagnostic-study', 'prognosis-study', 'rct-appraisal', 'systematic-review', 'literature-search']
};

const ProgressTracker={
    STORAGE_KEY:'ebm-progress',
    newBadges: [],
    getProgress:()=>{try{const d=localStorage.getItem(ProgressTracker.STORAGE_KEY);return d?JSON.parse(d):{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}catch{return{version:1,modules:{},badges:[],totalTimeSpent:0,streakData:{currentPassStreak:0,currentPerfectStreak:0},lastActivityDate:null}}},
    saveQuizResult:(moduleId,score,total,timeSpent)=>{
        ProgressTracker.newBadges = [];
        const progress=ProgressTracker.getProgress();
        const mod=progress.modules[moduleId]||{bestScore:0,totalAttempts:0,allAttempts:[],lessonsViewed:[],completed:false,firstCompleted:null};
        const attempt={date:new Date().toISOString(),score,timeSpent};
        mod.allAttempts.push(attempt);mod.totalAttempts++;
        if(score>mod.bestScore)mod.bestScore=score;
        const passingScore=Math.ceil(total*0.7);
        if(score>=passingScore&&!mod.completed){mod.completed=true;mod.firstCompleted=attempt.date}
        progress.modules[moduleId]=mod;progress.totalTimeSpent+=timeSpent;progress.lastUpdated=new Date().toISOString();
        ProgressTracker.checkBadges(progress,moduleId,score,total,timeSpent);
        localStorage.setItem(ProgressTracker.STORAGE_KEY,JSON.stringify(progress));return progress;
    },
    checkBadges:(progress,moduleId,score,total,timeSpent)=>{
        const badges=progress.badges||[];const ids=badges.map(b=>b.id);const now=new Date();const nowStr=now.toISOString();
        const hour=now.getHours();const day=now.getDay();
        const passed=score>=Math.ceil(total*0.7);const perfect=score===total;
        const addBadge=(id)=>{if(!ids.includes(id)){badges.push({id,earnedAt:nowStr});ids.push(id);ProgressTracker.newBadges.push(id);return true}return false};

        addBadge('first-quiz');
        if(perfect)addBadge('perfect-score');
        if(timeSpent<120&&passed)addBadge('speed-demon');
        const completed=Object.values(progress.modules).filter(m=>m.completed).length;
        if(completed>=5)addBadge('five-complete');
        if(completed>=10)addBadge('ten-complete');
        if(completed>=18)addBadge('master');
        const mod=progress.modules[moduleId];
        if(mod&&mod.totalAttempts>=3)addBadge('persistent');

        if(hour<6)addBadge('early-bird');
        if(hour>=0&&hour<5)addBadge('night-owl');
        if(day===0||day===6)addBadge('weekend-warrior');
        if(hour>=2&&hour<5&&!passed)addBadge('coffee-needed');

        const streakData=progress.streakData||{currentPassStreak:0,currentPerfectStreak:0};
        if(passed){streakData.currentPassStreak++;if(perfect)streakData.currentPerfectStreak++;else streakData.currentPerfectStreak=0}
        else{streakData.currentPassStreak=0;streakData.currentPerfectStreak=0}
        if(streakData.currentPassStreak>=3)addBadge('three-streak');
        if(streakData.currentPassStreak>=5)addBadge('five-streak');
        if(streakData.currentPerfectStreak>=3)addBadge('triple-perfect');
        progress.streakData=streakData;

        if(mod){
            if(mod.totalAttempts===1&&perfect)addBadge('quick-learner');
            if(mod.totalAttempts===1&&score===7)addBadge('lucky-seven');
            if(mod.allAttempts&&mod.allAttempts.length>1){
                const firstScore=mod.allAttempts[0].score;
                if(firstScore<7&&perfect)addBadge('comeback-kid');
                if(score-firstScore>=5)addBadge('improvement-king');
                const lastThree=mod.allAttempts.slice(-3);
                if(lastThree.length===3&&lastThree[0].score===lastThree[1].score&&lastThree[1].score===lastThree[2].score)addBadge('deja-vu');
                if(lastThree.length===3&&lastThree.every(a=>a.score===score))addBadge('consistent-output');
            }
            if(mod.totalAttempts>=10)addBadge('learning-worm');
            if(mod.completed&&mod.totalAttempts>1&&passed)addBadge('reviewer');
        }

        if(score===6)addBadge('almost-there');
        if(score===0)addBadge('zero-hero');
        if(score>=2&&score<=3)addBadge('generous-guesser');
        if(timeSpent<30&&!passed)addBadge('speed-fail');
        if(timeSpent>600&&!passed)addBadge('slow-and-wrong');

        const totalAttempts=Object.values(progress.modules).reduce((sum,m)=>sum+(m.totalAttempts||0),0);
        if(totalAttempts>=50&&completed<18)addBadge('eternal-student');
        const startedNotCompleted=Object.values(progress.modules).filter(m=>m.totalAttempts>0&&!m.completed).length;
        if(startedNotCompleted>=5&&completed===0)addBadge('wanderer');

        if(progress.lastActivityDate){
            const lastActivity=new Date(progress.lastActivityDate);
            const daysSince=(now-lastActivity)/(1000*60*60*24);
            if(daysSince>=7)addBadge('procrastinator');
        }
        progress.lastActivityDate=nowStr;

        const checkCat=(cat,badgeId)=>{const mods=categoryModules[cat]||[];if(mods.length>0&&mods.every(id=>progress.modules[id]?.completed))addBadge(badgeId)};
        checkCat('cardio','heart-expert');
        checkCat('critical','critical-master');
        checkCat('neuro','neuro-ninja');
        checkCat('pulm','pulm-pro');
        checkCat('core','ebm-foundation');
        const jamaComplete=Object.keys(progress.modules).filter(k=>k.startsWith('jama-')&&progress.modules[k]?.completed).length;
        if(jamaComplete>=12)addBadge('jama-collector');

        if(badges.length>=10)addBadge('achievement-hunter');
        if(badges.length>=39)addBadge('completionist');

        progress.badges=badges;
    }
};

const BadgeToast = ({ badges, onClose }) => {
    if (!badges || badges.length === 0) return null;
    return (
        <div style={{position:'fixed',top:20,right:20,zIndex:9999,display:'flex',flexDirection:'column',gap:10}}>
            {badges.map((badgeId, i) => {
                const badge = badgeDefs[badgeId];
                if (!badge) return null;
                return (
                    <div key={badgeId} style={{
                        background:'linear-gradient(135deg, #FFD700, #FFA500)',
                        padding:'16px 20px',borderRadius:16,boxShadow:'0 8px 32px rgba(0,0,0,0.2)',
                        display:'flex',alignItems:'center',gap:12,animation:'slideIn 0.5s ease-out',minWidth:240
                    }}>
                        <span style={{fontSize:36}}>{badge.icon}</span>
                        <div style={{flex:1}}>
                            <div style={{fontSize:12,fontWeight:600,color:'#5D4037'}}>æ–°æˆå°±è§£é–!</div>
                            <div style={{fontSize:16,fontWeight:700,color:'#3E2723'}}>{badge.name}</div>
                        </div>
                        <button onClick={()=>onClose(badgeId)} style={{background:'rgba(0,0,0,0.1)',border:'none',borderRadius:8,width:28,height:28,cursor:'pointer',fontSize:14}}>âœ•</button>
                    </div>
                );
            })}
            <style>{`@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}`}</style>
        </div>
    );
};

const lessons=[
    {id:1,title:'é å¾Œç ”ç©¶åŸºæœ¬æ¦‚å¿µ',sub:'Prognosis Study Basics',color:'#4361EE'},
    {id:2,title:'å­˜æ´»åˆ†æèˆ‡KMæ›²ç·š',sub:'Survival Analysis',color:'#7209B7'},
    {id:3,title:'Coxæ¯”ä¾‹é¢¨éšªæ¨¡å‹',sub:'Cox Model & HR',color:'#2EC4B6'},
    {id:4,title:'é æ¸¬æ¨¡å‹èˆ‡é©—è­‰',sub:'Prediction Models',color:'#FF6B35'},
    {id:5,title:'TRIPODèˆ‡è‡¨åºŠæ‡‰ç”¨',sub:'Clinical Application',color:'#F72585'}
];

const quiz=[
    {q:'é å¾Œç ”ç©¶çš„ä¸»è¦ç›®çš„ç‚ºä½•ï¼Ÿ',o:['è©•ä¼°æ²»ç™‚æ•ˆæœ','è¨ºæ–·ç–¾ç—…','é æ¸¬ç–¾ç—…çš„æœªä¾†èµ°å‘èˆ‡çµå±€','æ¯”è¼ƒä¸åŒè—¥ç‰©çš„å‰¯ä½œç”¨'],c:2,e:'é å¾Œç ”ç©¶æ—¨åœ¨é æ¸¬ç–¾ç—…çš„è‡ªç„¶ç—…ç¨‹ã€çµå±€ç™¼ç”Ÿçš„å¯èƒ½æ€§ï¼Œä»¥åŠè­˜åˆ¥å½±éŸ¿é å¾Œçš„å› å­ã€‚'},
    {q:'ä¸‹åˆ—ä½•ç¨®ç ”ç©¶è¨­è¨ˆæœ€é©åˆé€²è¡Œé å¾Œç ”ç©¶ï¼Ÿ',o:['æ©«æ–·æ€§ç ”ç©¶','ç—…ä¾‹å°ç…§ç ”ç©¶','ä¸–ä»£ç ”ç©¶ï¼ˆCohort Studyï¼‰','ç—…ä¾‹å ±å‘Š'],c:2,e:'ä¸–ä»£ç ”ç©¶å¾ç‰¹å®šæ™‚é–“é»é–‹å§‹è¿½è¹¤ç—…äººï¼Œè§€å¯Ÿçµå±€ç™¼ç”Ÿï¼Œæ˜¯é å¾Œç ”ç©¶çš„æœ€ä½³è¨­è¨ˆã€‚'},
    {q:'Kaplan-Meieræ›²ç·šçš„Yè»¸ä»£è¡¨ä»€éº¼ï¼Ÿ',o:['ç´¯ç©ç™¼ç”Ÿç‡','å­˜æ´»æ©Ÿç‡','é¢¨éšªæ¯”','æ­»äº¡äººæ•¸'],c:1,e:'KMæ›²ç·šçš„Yè»¸ä»£è¡¨å­˜æ´»æ©Ÿç‡ï¼Œå¾1.0é–‹å§‹éš¨æ™‚é–“ä¸‹é™ã€‚æ¯å€‹éšæ¢¯ä»£è¡¨äº‹ä»¶ç™¼ç”Ÿã€‚'},
    {q:'é—œæ–¼è¨­é™ï¼ˆCensoringï¼‰çš„æ•˜è¿°ï¼Œä½•è€…æ­£ç¢ºï¼Ÿ',o:['åªç™¼ç”Ÿåœ¨å‰ç»æ€§ç ”ç©¶','ä»£è¡¨ç—…äººå·²æ­»äº¡','ä»£è¡¨ç—…äººåœ¨ç ”ç©¶çµæŸå‰æœªç™¼ç”Ÿäº‹ä»¶æˆ–å¤±å»è¿½è¹¤','æœƒå°è‡´ç ”ç©¶ç„¡æ•ˆ'],c:2,e:'è¨­é™æ˜¯å­˜æ´»åˆ†æçš„é‡è¦æ¦‚å¿µï¼Œç•¶ç—…äººåœ¨ç ”ç©¶çµæŸæ™‚ä»å­˜æ´»æˆ–å¤±å»è¿½è¹¤æ™‚ï¼Œå…¶è³‡æ–™è¢«è¨­é™ã€‚'},
    {q:'Log-rank testçš„ä¸»è¦ç”¨é€”ç‚ºä½•ï¼Ÿ',o:['è¨ˆç®—å­˜æ´»ç‡','æ¯”è¼ƒå…©æ¢æˆ–å¤šæ¢å­˜æ´»æ›²ç·šæ˜¯å¦æœ‰å·®ç•°','ä¼°è¨ˆé¢¨éšªæ¯”','é©—è­‰æ¯”ä¾‹é¢¨éšªå‡è¨­'],c:1,e:'Log-rank testæ˜¯æ¯”è¼ƒå…©çµ„æˆ–å¤šçµ„å­˜æ´»æ›²ç·šæ˜¯å¦æœ‰çµ±è¨ˆé¡¯è‘—å·®ç•°çš„æ¨™æº–æ–¹æ³•ã€‚'},
    {q:'Coxæ¨¡å‹ä¸­HR=2.0ä»£è¡¨ä»€éº¼æ„ç¾©ï¼Ÿ',o:['å­˜æ´»ç‡å¢åŠ 2å€','æ­»äº¡é¢¨éšªæ˜¯å°ç…§çµ„çš„2å€','å­˜æ´»æ™‚é–“å»¶é•·2å€','ä¸­ä½å­˜æ´»æœŸç‚º2å¹´'],c:1,e:'HR=2.0è¡¨ç¤ºæš´éœ²çµ„çš„ç¬æ™‚é¢¨éšªæ˜¯å°ç…§çµ„çš„2å€ã€‚HRå¤§æ–¼1ä»£è¡¨é¢¨éšªå¢åŠ ã€‚'},
    {q:'Coxæ¨¡å‹çš„æ¯”ä¾‹é¢¨éšªå‡è¨­æ˜¯ä»€éº¼æ„æ€ï¼Ÿ',o:['æ‰€æœ‰ç—…äººé¢¨éšªç›¸åŒ','é¢¨éšªæ¯”éš¨æ™‚é–“ä¿æŒæ†å®š','é¢¨éšªå‘ˆæŒ‡æ•¸å¢é•·','åªé©ç”¨æ–¼æ­»äº¡çµå±€'],c:1,e:'æ¯”ä¾‹é¢¨éšªå‡è¨­è¦æ±‚HRåœ¨æ•´å€‹è¿½è¹¤æœŸé–“ä¿æŒæ†å®šï¼Œä¸éš¨æ™‚é–“è®ŠåŒ–ã€‚'},
    {q:'é æ¸¬æ¨¡å‹çš„æ ¡æº–åº¦ï¼ˆCalibrationï¼‰æ˜¯æŒ‡ä»€éº¼ï¼Ÿ',o:['æ¨¡å‹å€åˆ†é«˜ä½é¢¨éšªçš„èƒ½åŠ›','é æ¸¬æ©Ÿç‡èˆ‡å¯¦éš›ç™¼ç”Ÿç‡çš„å»åˆç¨‹åº¦','æ¨¡å‹åœ¨æ–°æ—ç¾¤çš„è¡¨ç¾','æ¨¡å‹çš„çµ±è¨ˆé¡¯è‘—æ€§'],c:1,e:'æ ¡æº–åº¦è©•ä¼°é æ¸¬æ©Ÿç‡èˆ‡å¯¦éš›è§€å¯Ÿåˆ°çš„äº‹ä»¶ç™¼ç”Ÿç‡æ˜¯å¦ä¸€è‡´ã€‚'},
    {q:'C-statistic=0.75ä»£è¡¨ä»€éº¼ï¼Ÿ',o:['æ¨¡å‹ç„¡é æ¸¬èƒ½åŠ›','æ¨¡å‹æœ‰ä¸­ç­‰å€è¾¨èƒ½åŠ›','æ¨¡å‹æœ‰å®Œç¾é æ¸¬èƒ½åŠ›','æ¨¡å‹éåº¦é…é©'],c:1,e:'C-statisticç­‰åŒæ–¼AUCï¼Œ0.75ä»£è¡¨ä¸­ç­‰è‡³è‰¯å¥½çš„å€è¾¨èƒ½åŠ›ã€‚0.5ç„¡é æ¸¬åŠ›ï¼Œ1.0å®Œç¾é æ¸¬ã€‚'},
    {q:'é—œæ–¼é æ¸¬æ¨¡å‹çš„å¤–éƒ¨é©—è­‰ï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ',o:['ä½¿ç”¨å»ºç«‹æ¨¡å‹çš„åŒä¸€è³‡æ–™é›†','åœ¨ä¸åŒæ™‚é–“æˆ–åœ°é»çš„æ–°è³‡æ–™é›†æ¸¬è©¦æ¨¡å‹','åªéœ€è¦å…§éƒ¨é©—è­‰å³å¯','å¤–éƒ¨é©—è­‰é€šå¸¸æœƒæé«˜æ¨¡å‹è¡¨ç¾'],c:1,e:'å¤–éƒ¨é©—è­‰æ˜¯åœ¨ç¨ç«‹çš„è³‡æ–™é›†æ¸¬è©¦æ¨¡å‹è¡¨ç¾ï¼Œæ˜¯è©•ä¼°æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„é—œéµæ­¥é©Ÿã€‚'}
];

function App(){
    const[page,setPage]=useState('home');
    const[lessonId,setLessonId]=useState(1);
    const[qIdx,setQIdx]=useState(0);
    const[score,setScore]=useState(0);
    const[sel,setSel]=useState(null);
    const[show,setShow]=useState(false);
    const[done,setDone]=useState(false);
    const[quizStartTime,setQuizStartTime]=useState(null);
    const[newBadges,setNewBadges]=useState([]);

    useEffect(function(){if(page==='quiz'&&!done&&!quizStartTime)setQuizStartTime(Date.now())},[page,done]);
    useEffect(function(){if(done&&quizStartTime){var t=Math.round((Date.now()-quizStartTime)/1000);ProgressTracker.saveQuizResult(MODULE_ID,score,quiz.length,t);if(ProgressTracker.newBadges.length>0){setNewBadges([...ProgressTracker.newBadges])}}},[done]);
    useEffect(function(){if(newBadges.length>0){var timer=setTimeout(function(){setNewBadges(function(prev){return prev.slice(1)})},4000);return function(){clearTimeout(timer)}}},[newBadges]);

    var closeBadge=function(badgeId){setNewBadges(function(prev){return prev.filter(function(id){return id!==badgeId})})};

    function Header(props){
        return(
            <header style={{background:'#fff',borderBottom:'1px solid #C7D2FE',padding:'12px 16px',position:'sticky',top:0,zIndex:10}}>
                <div style={{maxWidth:480,margin:'0 auto',display:'flex',alignItems:'center',gap:12}}>
                    <button onClick={function(){if(page==='home'){window.location.href='index.html'}else{setPage('home')}}} style={{background:'#EEF2FF',border:'none',borderRadius:10,width:40,height:40,cursor:'pointer',color:'var(--pri)',display:'flex',alignItems:'center',justifyContent:'center'}}>
                        <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
                    </button>
                    <span style={{fontWeight:700,color:'#3730A3'}}>{props.title}</span>
                </div>
            </header>
        );
    }

    function Home(){
        return(
            <div>
                <Header title="é å¾Œç ”ç©¶è©•è®€"/>
                <div style={{background:'linear-gradient(135deg,#4361EE,#3A0CA3)',padding:'32px 20px',color:'#fff'}}>
                    <div style={{maxWidth:480,margin:'0 auto'}}>
                        <div style={{background:'rgba(255,255,255,0.2)',display:'inline-block',padding:'6px 14px',borderRadius:50,fontSize:12,fontWeight:600,marginBottom:16}}>Prognosis Study Appraisal</div>
                        <h1 style={{fontSize:26,fontWeight:700,marginBottom:12}}>é å¾Œç ”ç©¶è©•è®€</h1>
                        <p style={{opacity:0.95,fontSize:14}}>å­¸ç¿’è©•ä¼°é å¾Œå› å­èˆ‡é¢¨éšªé æ¸¬æ¨¡å‹çš„æ–¹æ³•</p>
                    </div>
                </div>
                <div style={{padding:'0 16px',marginTop:-20}}>
                    <div style={{maxWidth:480,margin:'0 auto'}}>
                        <div className="card">
                            <h3 style={{fontSize:16,fontWeight:700,color:'var(--pri)',marginBottom:12}}>å­¸ç¿’ç›®æ¨™</h3>
                            {['ç†è§£é å¾Œç ”ç©¶çš„è¨­è¨ˆèˆ‡ç›®çš„','è§£è®€Kaplan-Meierå­˜æ´»æ›²ç·š','ç†è§£Coxæ¨¡å‹èˆ‡é¢¨éšªæ¯”HR','è©•ä¼°é æ¸¬æ¨¡å‹çš„å€è¾¨èˆ‡æ ¡æº–','æ‡‰ç”¨TRIPODæŒ‡å¼•è©•è®€æ–‡ç»'].map(function(t,i){
                                return(
                                    <div key={i} style={{display:'flex',gap:10,marginBottom:8,fontSize:14}}>
                                        <span style={{background:'var(--suc)',color:'#fff',borderRadius:6,width:22,height:22,display:'flex',alignItems:'center',justifyContent:'center',fontSize:12,flexShrink:0}}>{i+1}</span>
                                        <span style={{color:'var(--txt2)'}}>{t}</span>
                                    </div>
                                );
                            })}
                        </div>
                        <h3 style={{fontSize:18,fontWeight:700,marginBottom:16}}>èª²ç¨‹å…§å®¹</h3>
                        {lessons.map(function(l){
                            return(
                                <div key={l.id} className="card" onClick={function(){setLessonId(l.id);setPage('lesson')}} style={{cursor:'pointer'}}>
                                    <div style={{display:'flex',alignItems:'center',gap:16}}>
                                        <div style={{width:48,height:48,borderRadius:12,background:'linear-gradient(135deg,'+l.color+','+l.color+'88)',display:'flex',alignItems:'center',justifyContent:'center',color:'#fff',fontWeight:700}}>{l.id}</div>
                                        <div style={{flex:1}}>
                                            <div style={{fontSize:11,color:l.color,fontWeight:600}}>Lesson {l.id}</div>
                                            <div style={{fontSize:16,fontWeight:700}}>{l.title}</div>
                                            <div style={{fontSize:13,color:'var(--txt2)'}}>{l.sub}</div>
                                        </div>
                                        <svg viewBox="0 0 24 24" fill={l.color} width="20" height="20"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8-8-8z"/></svg>
                                    </div>
                                </div>
                            );
                        })}
                        <button className="btn btn-pri" onClick={function(){setQIdx(0);setScore(0);setSel(null);setShow(false);setDone(false);setPage('quiz')}} style={{width:'100%',justifyContent:'center',marginTop:20,marginBottom:32}}>
                            é–‹å§‹æ¸¬é©— (10é¡Œ)
                        </button>
                    </div>
                </div>
                <footer style={{background:'#EEF2FF',padding:'24px 16px',textAlign:'center'}}>
                    <p style={{fontSize:13,color:'var(--txt2)'}}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨</p>
                    <p style={{fontSize:12,color:'var(--txt2)'}}>è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                </footer>
            </div>
        );
    }

    function L1(){
        return(
            <div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pri)',marginBottom:12}}>ä»€éº¼æ˜¯é å¾Œç ”ç©¶ï¼Ÿ</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:16}}>é å¾Œç ”ç©¶æ¢è¨ç–¾ç—…çš„<strong>è‡ªç„¶ç—…ç¨‹</strong>èˆ‡<strong>çµå±€</strong>ï¼Œå›ç­”ã€Œæ¥ä¸‹ä¾†æœƒç™¼ç”Ÿä»€éº¼ï¼Ÿã€çš„å•é¡Œã€‚</p>
                    <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}}>
                        <div style={{background:'#EEF2FF',padding:14,borderRadius:12,textAlign:'center'}}>
                            <div style={{fontSize:28,marginBottom:8}}>ğŸ“Š</div>
                            <div style={{fontWeight:600,color:'var(--pri)',marginBottom:4}}>é å¾Œå› å­ç ”ç©¶</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>å“ªäº›å› ç´ å½±éŸ¿çµå±€ï¼Ÿ</div>
                        </div>
                        <div style={{background:'#FAF5FF',padding:14,borderRadius:12,textAlign:'center'}}>
                            <div style={{fontSize:28,marginBottom:8}}>ğŸ¯</div>
                            <div style={{fontWeight:600,color:'var(--pur)',marginBottom:4}}>é æ¸¬æ¨¡å‹ç ”ç©¶</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>å¦‚ä½•é æ¸¬å€‹äººé¢¨éšªï¼Ÿ</div>
                        </div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--blue)',marginBottom:12}}>é å¾Œç ”ç©¶çš„é—œéµè¦ç´ </h3>
                    <div style={{fontSize:14,color:'var(--txt2)',lineHeight:2}}>
                        <div>ğŸš€ <strong>èµ·å§‹é»</strong>ï¼šæ˜ç¢ºå®šç¾©è¿½è¹¤é–‹å§‹æ™‚é–“é»</div>
                        <div>â±ï¸ <strong>è¿½è¹¤æ™‚é–“</strong>ï¼šè¶³å¤ é•·ä»¥è§€å¯Ÿçµå±€äº‹ä»¶</div>
                        <div>ğŸ¯ <strong>çµå±€å®šç¾©</strong>ï¼šå®¢è§€ä¸”å¯é æ¸¬é‡çš„è‡¨åºŠçµå±€</div>
                        <div>ğŸ‘ï¸ <strong>å®Œæ•´è¿½è¹¤</strong>ï¼šç›¡é‡æ¸›å°‘å¤±å»è¿½è¹¤æ¯”ä¾‹</div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--teal)',marginBottom:12}}>é©åˆçš„ç ”ç©¶è¨­è¨ˆ</h3>
                    <table>
                        <thead><tr><th>è¨­è¨ˆ</th><th>èªªæ˜</th><th>é©ç”¨æ€§</th></tr></thead>
                        <tbody>
                            <tr><td style={{fontWeight:600,color:'var(--suc)'}}>å‰ç»æ€§ä¸–ä»£</td><td>å¾è¨ºæ–·é–‹å§‹å‘å‰è¿½è¹¤</td><td style={{color:'var(--suc)'}}>æœ€ä½³</td></tr>
                            <tr><td style={{fontWeight:600,color:'var(--blue)'}}>å›æº¯æ€§ä¸–ä»£</td><td>åˆ©ç”¨éå»ç´€éŒ„è¿½è¹¤</td><td style={{color:'var(--blue)'}}>è‰¯å¥½</td></tr>
                            <tr><td style={{fontWeight:600,color:'var(--warn)'}}>å·¢å¼ç—…ä¾‹å°ç…§</td><td>é©ç”¨ç½•è¦‹çµå±€</td><td style={{color:'var(--warn)'}}>å¯æ¥å—</td></tr>
                        </tbody>
                    </table>
                </div>
                <div className="alertbox">
                    <strong style={{color:'var(--err)'}}>é å¾Œç ”ç©¶å¸¸è¦‹åå·®</strong><br/>
                    <span style={{fontSize:14,color:'var(--txt2)'}}>â€¢ èµ·å§‹é»åå·®ï¼šç´å…¥æ™‚é–“ä¸ä¸€è‡´<br/>â€¢ å¤±å»è¿½è¹¤åå·®ï¼šæµå¤±è€…èˆ‡ç•™ä¸‹è€…ä¸åŒ<br/>â€¢ æ¸¬é‡åå·®ï¼šçµå±€åˆ¤å®šä¸å®¢è§€</span>
                </div>
            </div>
        );
    }

    function L2(){
        return(
            <div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pur)',marginBottom:12}}>å­˜æ´»åˆ†æç°¡ä»‹</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>å­˜æ´»åˆ†æè™•ç†<strong>äº‹ä»¶ç™¼ç”Ÿæ™‚é–“</strong>è³‡æ–™ï¼Œå¯åˆ†ææ­»äº¡ã€å¾©ç™¼ã€ç–¾ç—…é€²å±•ç­‰å„ç¨®çµå±€ã€‚</p>
                    <div style={{background:'#FAF5FF',padding:16,borderRadius:12}}>
                        <div style={{fontWeight:600,color:'var(--pur)',marginBottom:8}}>ç‚ºä»€éº¼éœ€è¦å­˜æ´»åˆ†æï¼Ÿ</div>
                        <div style={{fontSize:13,color:'var(--txt2)'}}>â€¢ è¿½è¹¤æ™‚é–“é•·çŸ­ä¸ä¸€<br/>â€¢ éƒ¨åˆ†ç—…äººæœªç™¼ç”Ÿäº‹ä»¶ï¼ˆè¨­é™è³‡æ–™ï¼‰<br/>â€¢ éœ€è€ƒæ…®ã€Œä½•æ™‚ã€ç™¼ç”Ÿï¼Œè€Œéåªæœ‰ã€Œæ˜¯å¦ã€ç™¼ç”Ÿ</div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--blue)',marginBottom:12}}>è¨­é™ï¼ˆCensoringï¼‰</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>ç•¶æˆ‘å€‘ç„¡æ³•è§€å¯Ÿåˆ°äº‹ä»¶ç™¼ç”Ÿæ™‚ï¼Œè³‡æ–™è¢«ã€Œè¨­é™ã€ï¼š</p>
                    <div style={{fontSize:14,color:'var(--txt2)'}}>âœ… ç ”ç©¶çµæŸæ™‚ä»å­˜æ´»<br/>â“ å¤±å»è¿½è¹¤<br/>ğŸšª å› å…¶ä»–åŸå› é€€å‡º</div>
                    <div className="tip" style={{marginTop:12}}>
                        <strong style={{color:'var(--warn)'}}>é‡è¦å‡è¨­</strong><br/>
                        <span style={{fontSize:14,color:'var(--txt2)'}}>è¨­é™ç‚ºã€Œéè³‡è¨Šæ€§ã€ï¼šè¨­é™åŸå› èˆ‡çµå±€ç™¼ç”Ÿç„¡é—œ</span>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--teal)',marginBottom:12}}>Kaplan-Meieræ›²ç·š</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>æœ€å¸¸ç”¨çš„å­˜æ´»æ›²ç·šå‘ˆç¾æ–¹æ³•</p>
                    <div style={{background:'#F8F9FA',padding:16,borderRadius:12,textAlign:'center'}}>
                        <svg viewBox="0 0 300 180" style={{width:'100%',maxWidth:300}}>
                            <line x1="40" y1="150" x2="280" y2="150" stroke="#333" strokeWidth="2"/>
                            <line x1="40" y1="20" x2="40" y2="150" stroke="#333" strokeWidth="2"/>
                            <path d="M40 25 H70 V40 H100 V60 H130 V85 H160 V105 H190 V120 H220 V135 H280" fill="none" stroke="#E53E3E" strokeWidth="2.5"/>
                            <path d="M40 25 H80 V35 H120 V48 H160 V62 H200 V78 H240 V90 H280" fill="none" stroke="#4361EE" strokeWidth="2.5"/>
                            <text x="40" y="168" fontSize="10" fill="#666">0</text>
                            <text x="160" y="168" fontSize="10" fill="#666">2å¹´</text>
                            <text x="270" y="168" fontSize="10" fill="#666">4å¹´</text>
                            <text x="35" y="28" fontSize="10" fill="#666" textAnchor="end">1.0</text>
                            <text x="35" y="90" fontSize="10" fill="#666" textAnchor="end">0.5</text>
                        </svg>
                        <div style={{display:'flex',justifyContent:'center',gap:20,marginTop:8,fontSize:12}}>
                            <span style={{color:'#4361EE'}}>â” ä½é¢¨éšªçµ„</span>
                            <span style={{color:'#E53E3E'}}>â” é«˜é¢¨éšªçµ„</span>
                        </div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--orange)',marginBottom:12}}>KMæ›²ç·šè§£è®€è¦é»</h3>
                    <div style={{fontSize:14,color:'var(--txt2)',lineHeight:2}}>
                        ğŸ“‰ <strong>éšæ¢¯ä¸‹é™</strong>ï¼šæ¯å€‹éšæ¢¯ä»£è¡¨äº‹ä»¶ç™¼ç”Ÿ<br/>
                        â±ï¸ <strong>ä¸­ä½å­˜æ´»æœŸ</strong>ï¼šæ›²ç·šé€šéY=0.5æ™‚çš„æ™‚é–“<br/>
                        â†”ï¸ <strong>æ›²ç·šåˆ†é›¢</strong>ï¼šå…©çµ„å·®ç•°è¶Šå¤§ï¼Œåˆ†é›¢è¶Šæ˜é¡¯
                    </div>
                </div>
                <div className="info">
                    <strong style={{color:'var(--blue)'}}>Log-rank Test</strong><br/>
                    <span style={{fontSize:14,color:'var(--txt2)'}}>æ¯”è¼ƒå…©æ¢æˆ–å¤šæ¢å­˜æ´»æ›²ç·šæ˜¯å¦æœ‰çµ±è¨ˆé¡¯è‘—å·®ç•°<br/>â€¢ H0ï¼šå„çµ„å­˜æ´»æ›²ç·šç›¸åŒ<br/>â€¢ på°æ–¼0.05ï¼šå­˜æ´»æ›²ç·šæœ‰é¡¯è‘—å·®ç•°</span>
                </div>
            </div>
        );
    }

    function L3(){
        return(
            <div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--teal)',marginBottom:12}}>Coxæ¯”ä¾‹é¢¨éšªæ¨¡å‹</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>å­˜æ´»åˆ†æä¸­æœ€å¸¸ç”¨çš„å¤šè®Šé‡åˆ†ææ–¹æ³•ï¼Œå¯åŒæ™‚è©•ä¼°å¤šå€‹é å¾Œå› å­ã€‚</p>
                    <div className="formula">h(t) = hâ‚€(t) Ã— exp(Î²â‚Xâ‚ + Î²â‚‚Xâ‚‚ + ...)</div>
                    <div style={{fontSize:13,color:'var(--txt2)',marginTop:12}}>
                        <strong>h(t)</strong>ï¼šæ™‚é–“tçš„ç¬æ™‚é¢¨éšª<br/>
                        <strong>hâ‚€(t)</strong>ï¼šåŸºæº–é¢¨éšªå‡½æ•¸<br/>
                        <strong>Î²</strong>ï¼šè¿´æ­¸ä¿‚æ•¸<br/>
                        <strong>X</strong>ï¼šé å¾Œå› å­
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pur)',marginBottom:12}}>é¢¨éšªæ¯” Hazard Ratio (HR)</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>HRæ˜¯Coxæ¨¡å‹æœ€é‡è¦çš„ç”¢å‡ºï¼Œä»£è¡¨ç›¸å°é¢¨éšª</p>
                    <div className="formula" style={{background:'linear-gradient(135deg,#FAF5FF,#F3E5F5)',borderColor:'var(--pur)'}}>HR = exp(Î²) = æš´éœ²çµ„é¢¨éšª / å°ç…§çµ„é¢¨éšª</div>
                    <table style={{marginTop:16}}>
                        <thead><tr><th>HRå€¼</th><th>æ„ç¾©</th><th>è§£è®€</th></tr></thead>
                        <tbody>
                            <tr><td style={{fontWeight:700,color:'var(--err)'}}>HR = 2.0</td><td>é¢¨éšªå¢åŠ 2å€</td><td>æ­»äº¡é¢¨éšªæ˜¯å°ç…§çš„2å€</td></tr>
                            <tr><td style={{fontWeight:700,color:'var(--warn)'}}>HR = 1.5</td><td>é¢¨éšªå¢åŠ 50%</td><td>å¾©ç™¼é¢¨éšªå¢åŠ 50%</td></tr>
                            <tr><td style={{fontWeight:700,color:'var(--txt2)'}}>HR = 1.0</td><td>ç„¡å·®ç•°</td><td>å› å­ç„¡é å¾Œåƒ¹å€¼</td></tr>
                            <tr><td style={{fontWeight:700,color:'var(--suc)'}}>HR = 0.5</td><td>é¢¨éšªé™ä½50%</td><td>é€²å±•é¢¨éšªæ¸›åŠ</td></tr>
                        </tbody>
                    </table>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--orange)',marginBottom:12}}>æ¯”ä¾‹é¢¨éšªå‡è¨­</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>Coxæ¨¡å‹æ ¸å¿ƒå‡è¨­ï¼š<strong>HRåœ¨æ•´å€‹è¿½è¹¤æœŸé–“ä¿æŒæ†å®š</strong></p>
                    <div style={{background:'#FFF9F0',padding:16,borderRadius:12}}>
                        <div style={{fontWeight:600,color:'var(--orange)',marginBottom:8}}>å¦‚ä½•æª¢é©—ï¼Ÿ</div>
                        <div style={{fontSize:13,color:'var(--txt2)'}}>â€¢ åœ–å½¢æ³•ï¼šlog(-log(S(t))) vs log(t)æ‡‰å‘ˆå¹³è¡Œ<br/>â€¢ Schoenfeldæ®˜å·®æª¢é©—<br/>â€¢ åŠ å…¥æ™‚é–“äº¤äº’é …</div>
                    </div>
                </div>
                <div className="alertbox">
                    <strong style={{color:'var(--err)'}}>é•åå‡è¨­æ™‚æ€éº¼è¾¦ï¼Ÿ</strong><br/>
                    <span style={{fontSize:14,color:'var(--txt2)'}}>â€¢ åˆ†æ®µåˆ†æï¼ˆä¸åŒæ™‚æœŸåˆ†é–‹ï¼‰<br/>â€¢ åŠ å…¥æ™‚é–“ç›¸ä¾å…±è®Šæ•¸<br/>â€¢ ä½¿ç”¨å…¶ä»–æ¨¡å‹ï¼ˆå¦‚AFTæ¨¡å‹ï¼‰</span>
                </div>
            </div>
        );
    }

    function L4(){
        return(
            <div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--orange)',marginBottom:12}}>é æ¸¬æ¨¡å‹ç°¡ä»‹</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:16}}>é æ¸¬æ¨¡å‹çµåˆå¤šå€‹é å¾Œå› å­ï¼Œç‚º<strong>å€‹åˆ¥ç—…äºº</strong>è¨ˆç®—ç™¼ç”Ÿç‰¹å®šçµå±€çš„æ©Ÿç‡ã€‚</p>
                    <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:12}}>
                        <div style={{background:'#FFF9F0',padding:14,borderRadius:12}}>
                            <div style={{fontWeight:600,color:'var(--orange)',marginBottom:8}}>è‡¨åºŠæ‡‰ç”¨</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>â€¢ å€‹äººåŒ–é¢¨éšªè©•ä¼°<br/>â€¢ å…±äº«æ±ºç­–<br/>â€¢ æ²»ç™‚åˆ†å±¤</div>
                        </div>
                        <div style={{background:'#EEF2FF',padding:14,borderRadius:12}}>
                            <div style={{fontWeight:600,color:'var(--pri)',marginBottom:8}}>å¸¸è¦‹ç¯„ä¾‹</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>â€¢ Framingham Score<br/>â€¢ CHADSâ‚‚-VASc<br/>â€¢ APACHE II</div>
                        </div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pur)',marginBottom:12}}>å€è¾¨èƒ½åŠ›ï¼ˆDiscriminationï¼‰</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>æ¨¡å‹å€åˆ†ã€Œæœƒç™¼ç”Ÿäº‹ä»¶ã€èˆ‡ã€Œä¸æœƒç™¼ç”Ÿäº‹ä»¶ã€è€…çš„èƒ½åŠ›</p>
                    <div className="formula" style={{background:'linear-gradient(135deg,#FAF5FF,#F3E5F5)',borderColor:'var(--pur)'}}>C-statistic â‰ˆ AUC</div>
                    <table style={{marginTop:12}}>
                        <thead><tr><th>C-statistic</th><th>å€è¾¨èƒ½åŠ›</th><th>è‡¨åºŠæ„ç¾©</th></tr></thead>
                        <tbody>
                            <tr><td style={{color:'var(--suc)',fontWeight:700}}>0.9-1.0</td><td>å„ªç§€</td><td>é«˜åº¦æº–ç¢º</td></tr>
                            <tr><td style={{color:'var(--blue)',fontWeight:700}}>0.8-0.9</td><td>è‰¯å¥½</td><td>è‡¨åºŠå¯¦ç”¨</td></tr>
                            <tr><td style={{color:'var(--warn)',fontWeight:700}}>0.7-0.8</td><td>ä¸­ç­‰</td><td>å¯æ¥å—</td></tr>
                            <tr><td style={{color:'var(--err)',fontWeight:700}}>0.5-0.6</td><td>ç„¡æ•ˆ</td><td>ç­‰åŒçŒœæ¸¬</td></tr>
                        </tbody>
                    </table>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--teal)',marginBottom:12}}>æ ¡æº–åº¦ï¼ˆCalibrationï¼‰</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}>é æ¸¬æ©Ÿç‡èˆ‡å¯¦éš›è§€å¯Ÿç™¼ç”Ÿç‡çš„<strong>å»åˆç¨‹åº¦</strong></p>
                    <div className="good">
                        <strong style={{color:'var(--suc)'}}>æ ¡æº–è‰¯å¥½çš„æ„ç¾©</strong><br/>
                        <span style={{fontSize:14,color:'var(--txt2)'}}>é æ¸¬30%é¢¨éšªçš„ç¾¤çµ„ï¼Œå¯¦éš›ç™¼ç”Ÿç‡æ‡‰æ¥è¿‘30%</span>
                    </div>
                    <div className="tip">
                        <strong style={{color:'var(--warn)'}}>Hosmer-Lemeshow Test</strong><br/>
                        <span style={{fontSize:14,color:'var(--txt2)'}}>â€¢ på¤§æ–¼0.05ï¼šæ ¡æº–è‰¯å¥½<br/>â€¢ på°æ–¼0.05ï¼šæ ¡æº–ä¸ä½³ï¼Œéœ€é‡æ–°æ ¡æ­£</span>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pri)',marginBottom:12}}>æ¨¡å‹é©—è­‰</h3>
                    <div style={{display:'grid',gap:12}}>
                        <div style={{background:'#EEF2FF',padding:14,borderRadius:12}}>
                            <div style={{fontWeight:600,color:'var(--pri)',marginBottom:4}}>å…§éƒ¨é©—è­‰ Internal</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>ä½¿ç”¨åŒä¸€è³‡æ–™é›†ï¼ˆBootstrapã€Cross-validationï¼‰</div>
                        </div>
                        <div style={{background:'#F0FFF4',padding:14,borderRadius:12}}>
                            <div style={{fontWeight:600,color:'var(--suc)',marginBottom:4}}>å¤–éƒ¨é©—è­‰ External</div>
                            <div style={{fontSize:12,color:'var(--txt2)'}}>ä½¿ç”¨ç¨ç«‹è³‡æ–™é›†ï¼ˆä¸åŒæ™‚é–“/åœ°é»ï¼‰- æ›´é‡è¦ï¼</div>
                        </div>
                    </div>
                </div>
            </div>
        );
    }

    function L5(){
        return(
            <div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--pink)',marginBottom:12}}>TRIPODæŒ‡å¼•</h3>
                    <p style={{fontSize:14,color:'var(--txt2)',marginBottom:12}}><strong>TRIPOD</strong>æ˜¯é æ¸¬æ¨¡å‹ç ”ç©¶çš„å ±å‘Šæ¨™æº–ï¼ˆTransparent Reporting of prediction modelï¼‰</p>
                    <div style={{background:'#FFF0F5',padding:16,borderRadius:12}}>
                        <div style={{fontWeight:600,color:'var(--pink)',marginBottom:12}}>ç ”ç©¶é¡å‹</div>
                        <div style={{fontSize:13,color:'var(--txt2)',lineHeight:2}}>
                            <span style={{background:'#E53E3E',color:'#fff',padding:'2px 8px',borderRadius:4,fontSize:11,marginRight:8}}>Type 1</span>æ¨¡å‹ç™¼å±•ï¼ˆç„¡/å…§éƒ¨é©—è­‰ï¼‰<br/>
                            <span style={{background:'#38A169',color:'#fff',padding:'2px 8px',borderRadius:4,fontSize:11,marginRight:8}}>Type 2</span>æ¨¡å‹ç™¼å±•+å¤–éƒ¨é©—è­‰<br/>
                            <span style={{background:'#3182CE',color:'#fff',padding:'2px 8px',borderRadius:4,fontSize:11,marginRight:8}}>Type 3</span>å¤–éƒ¨é©—è­‰æ—¢æœ‰æ¨¡å‹
                        </div>
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--blue)',marginBottom:12}}>é å¾Œç ”ç©¶è©•è®€æª¢æ ¸è¡¨</h3>
                    <div style={{fontSize:14,color:'var(--txt2)',lineHeight:2}}>
                        â˜‘ï¸ ç ”ç©¶æ—ç¾¤æ˜¯å¦æ˜ç¢ºå®šç¾©ï¼Ÿ<br/>
                        â˜‘ï¸ èµ·å§‹é»æ˜¯å¦ä¸€è‡´ä¸”æ˜ç¢ºï¼Ÿ<br/>
                        â˜‘ï¸ è¿½è¹¤æ™‚é–“æ˜¯å¦è¶³å¤ é•·ï¼Ÿ<br/>
                        â˜‘ï¸ çµå±€æ˜¯å¦å®¢è§€ä¸”å®šç¾©æ˜ç¢ºï¼Ÿ<br/>
                        â˜‘ï¸ å¤±å»è¿½è¹¤æ¯”ä¾‹æ˜¯å¦å¯æ¥å—ï¼Ÿ<br/>
                        â˜‘ï¸ æ˜¯å¦èª¿æ•´é‡è¦å¹²æ“¾å› å­ï¼Ÿ<br/>
                        â˜‘ï¸ æ˜¯å¦å ±å‘ŠHRåŠ95% CIï¼Ÿ<br/>
                        â˜‘ï¸ é æ¸¬æ¨¡å‹æ˜¯å¦ç¶“éé©—è­‰ï¼Ÿ
                    </div>
                </div>
                <div className="card">
                    <h3 style={{fontSize:18,fontWeight:700,color:'var(--teal)',marginBottom:12}}>è‡¨åºŠæ‡‰ç”¨æ¡ˆä¾‹ï¼šCHADSâ‚‚-VASc</h3>
                    <p style={{fontSize:13,color:'var(--txt2)',marginBottom:12}}>é æ¸¬å¿ƒæˆ¿é¡«å‹•ç—…äººä¸­é¢¨é¢¨éšªï¼Œæ±ºå®šæŠ—å‡è¡€æ²»ç™‚</p>
                    <table>
                        <thead><tr><th>åˆ†æ•¸</th><th>å¹´ä¸­é¢¨é¢¨éšª</th><th>å»ºè­°</th></tr></thead>
                        <tbody>
                            <tr><td>0</td><td style={{color:'var(--suc)'}}>0.2%</td><td>å¯ä¸ç”¨æŠ—å‡è¡€</td></tr>
                            <tr><td>1</td><td style={{color:'var(--warn)'}}>0.6%</td><td>è€ƒæ…®æŠ—å‡è¡€</td></tr>
                            <tr><td>2+</td><td style={{color:'var(--err)'}}>2.2%+</td><td>å»ºè­°æŠ—å‡è¡€</td></tr>
                        </tbody>
                    </table>
                </div>
                <div className="good">
                    <strong style={{color:'var(--suc)'}}>è‡¨åºŠæ‡‰ç”¨è¦é»</strong><br/>
                    <span style={{fontSize:14,color:'var(--txt2)'}}>1. ç¢ºèªæ¨¡å‹åœ¨é¡ä¼¼æ—ç¾¤é©—è­‰é<br/>2. äº†è§£æ¨¡å‹çš„å€è¾¨èˆ‡æ ¡æº–è¡¨ç¾<br/>3. é¢¨éšªé æ¸¬æ‡‰çµåˆè‡¨åºŠåˆ¤æ–·<br/>4. èˆ‡ç—…äººå…±äº«æ±ºç­–</span>
                </div>
                <div className="purple">
                    <strong style={{color:'var(--pur)'}}>é å¾Œç ”ç©¶çš„è‡¨åºŠåƒ¹å€¼</strong><br/>
                    <span style={{fontSize:14,color:'var(--txt2)'}}>â€¢ ç—…äººè¡›æ•™ï¼šè®“ç—…äººäº†è§£å¯èƒ½çš„æœªä¾†èµ°å‘<br/>â€¢ æ²»ç™‚æ±ºç­–ï¼šé«˜é¢¨éšªè€…å¯èƒ½éœ€æ›´ç©æ¥µæ²»ç™‚<br/>â€¢ è¿½è¹¤è¨ˆç•«ï¼šæ ¹æ“šé¢¨éšªèª¿æ•´è¿½è¹¤é »ç‡</span>
                </div>
            </div>
        );
    }

    function Lesson(){
        var l=lessons.find(function(x){return x.id===lessonId});
        return(
            <div>
                <Header title={l.title}/>
                <div style={{background:'linear-gradient(135deg,'+l.color+','+l.color+'88)',padding:'20px',color:'#fff'}}>
                    <div style={{maxWidth:480,margin:'0 auto'}}>
                        <div style={{fontSize:12,opacity:0.9}}>Lesson {l.id} - {l.sub}</div>
                        <h1 style={{fontSize:24,fontWeight:700}}>{l.title}</h1>
                    </div>
                </div>
                <div style={{padding:'20px 16px'}}>
                    <div style={{maxWidth:480,margin:'0 auto'}}>
                        {lessonId===1 && <L1/>}
                        {lessonId===2 && <L2/>}
                        {lessonId===3 && <L3/>}
                        {lessonId===4 && <L4/>}
                        {lessonId===5 && <L5/>}
                        <div style={{display:'flex',gap:12,marginTop:24}}>
                            {lessonId>1 && <button className="btn" style={{flex:1,background:'#fff',border:'2px solid var(--pri)',color:'var(--pri)'}} onClick={function(){setLessonId(lessonId-1)}}>ä¸Šä¸€èª²</button>}
                            {lessonId<5 ? <button className="btn btn-pri" style={{flex:1}} onClick={function(){setLessonId(lessonId+1)}}>ä¸‹ä¸€èª²</button>
                            : <button className="btn btn-pri" style={{flex:1}} onClick={function(){setQIdx(0);setScore(0);setSel(null);setShow(false);setDone(false);setPage('quiz')}}>é–‹å§‹æ¸¬é©—</button>}
                        </div>
                    </div>
                </div>
            </div>
        );
    }

    function Quiz(){
        function pick(i){if(show)return;setSel(i);setShow(true);if(i===quiz[qIdx].c)setScore(score+1)}
        function next(){if(qIdx<quiz.length-1){setQIdx(qIdx+1);setSel(null);setShow(false)}else{setDone(true)}}

        if(done){
            var pct=Math.round((score/quiz.length)*100);
            var col=pct>=80?'var(--suc)':pct>=60?'var(--warn)':'var(--err)';
            return(
                <div>
                    <Header title="æ¸¬é©—çµæœ"/>
                    <div style={{padding:'40px 16px',textAlign:'center'}}>
                        <div style={{width:140,height:140,borderRadius:'50%',background:'conic-gradient('+col+' '+(pct*3.6)+'deg,#E5E5E5 0deg)',display:'flex',alignItems:'center',justifyContent:'center',margin:'0 auto 24px'}}>
                            <div style={{width:120,height:120,borderRadius:'50%',background:'#fff',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center'}}>
                                <div style={{fontSize:36,fontWeight:700}}>{pct}%</div>
                                <div style={{fontSize:14,color:'var(--txt2)'}}>{score}/{quiz.length}</div>
                            </div>
                        </div>
                        <h2 style={{fontSize:24,fontWeight:700,marginBottom:8}}>{pct>=80?'å¤ªæ£’äº†ï¼':pct>=60?'ä¸éŒ¯ï¼':'åŠ æ²¹ï¼'}</h2>
                        <p style={{color:'var(--txt2)',marginBottom:32}}>{pct>=80?'ä½ å°é å¾Œç ”ç©¶æœ‰å¾ˆå¥½çš„æŒæ¡ï¼':pct>=60?'å†è¤‡ç¿’å¯ä»¥æ›´é€²æ­¥ï¼':'å»ºè­°é‡æ–°é–±è®€èª²ç¨‹'}</p>
                        <div style={{display:'flex',gap:12,justifyContent:'center',flexWrap:'wrap'}}>
                            <button className="btn btn-pri" onClick={function(){setQIdx(0);setScore(0);setSel(null);setShow(false);setDone(false)}}>é‡æ–°æ¸¬é©—</button>
                            <button className="btn" style={{background:'#fff',border:'2px solid var(--pri)',color:'var(--pri)'}} onClick={function(){setPage('home')}}>è¿”å›èª²ç¨‹</button>
                        </div>
                    </div>
                    <footer style={{background:'#EEF2FF',padding:'24px 16px',textAlign:'center',marginTop:40}}>
                        <p style={{fontSize:12,color:'var(--txt2)'}}>æ–°ç«¹å°å¤§åˆ†é™¢æ•™å­¸éƒ¨ | è¬æ…•æš MD, PhD, FESC | é»ƒæ²›éŠ“ MD | é»ƒåœ‹è‰¯</p>
                    </footer>
                </div>
            );
        }

        var q=quiz[qIdx];
        return(
            <div>
                <Header title="è‡ªæˆ‘æ¸¬é©—"/>
                <div style={{padding:'20px 16px'}}>
                    <div style={{maxWidth:480,margin:'0 auto'}}>
                        <div style={{display:'flex',justifyContent:'space-between',marginBottom:8,fontSize:14}}>
                            <span style={{color:'var(--txt2)'}}>é€²åº¦</span>
                            <span style={{fontWeight:600,color:'var(--pri)'}}>{qIdx+1}/{quiz.length}</span>
                        </div>
                        <div style={{height:8,background:'#E5E5E5',borderRadius:4,marginBottom:20}}>
                            <div style={{height:'100%',width:((qIdx+1)/quiz.length*100)+'%',background:'linear-gradient(90deg,var(--pri),var(--pri2))',borderRadius:4}}/>
                        </div>
                        <div className="card">
                            <h3 style={{fontSize:16,fontWeight:600,lineHeight:1.6,marginBottom:20}}>{q.q}</h3>
                            {q.o.map(function(opt,i){
                                var bg='#fff',bd='#E5E5E5';
                                if(show){
                                    if(i===q.c){bg='#F0FFF4';bd='var(--suc)'}
                                    else if(i===sel){bg='#FFF5F5';bd='var(--err)'}
                                }else if(i===sel){bg='#EEF2FF';bd='var(--pri)'}
                                return(
                                    <button key={i} onClick={function(){pick(i)}} disabled={show} style={{width:'100%',padding:'12px 14px',marginBottom:10,background:bg,border:'2px solid '+bd,borderRadius:12,textAlign:'left',fontSize:14,cursor:show?'default':'pointer',display:'flex',alignItems:'center',gap:12}}>
                                        <span style={{width:26,height:26,borderRadius:8,background:show&&i===q.c?'var(--suc)':show&&i===sel?'var(--err)':'#EEF2FF',color:show&&(i===q.c||i===sel)?'#fff':'var(--pri)',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:700,fontSize:13,flexShrink:0}}>
                                            {show&&i===q.c?'O':show&&i===sel&&i!==q.c?'X':String.fromCharCode(65+i)}
                                        </span>
                                        <span style={{lineHeight:1.5}}>{opt}</span>
                                    </button>
                                );
                            })}
                        </div>
                        {show && (
                            <div className={sel===q.c?'good':'tip'}>
                                <strong style={{color:sel===q.c?'var(--suc)':'var(--warn)'}}>{sel===q.c?'æ­£ç¢ºï¼':'ç­”éŒ¯äº†'}</strong>
                                <p style={{fontSize:14,color:'var(--txt2)',marginTop:8,lineHeight:1.7}}>{q.e}</p>
                            </div>
                        )}
                        {show && <button className="btn btn-pri" style={{width:'100%',justifyContent:'center',marginTop:16}} onClick={next}>{qIdx<quiz.length-1?'ä¸‹ä¸€é¡Œ':'æŸ¥çœ‹çµæœ'}</button>}
                    </div>
                </div>
            </div>
        );
    }

    return(
        <div style={{maxWidth:'100%',minHeight:'100vh',background:'var(--bg)'}}>
            {page==='home' && <Home/>}
            {page==='lesson' && <Lesson/>}
            {page==='quiz' && <Quiz/>}
        </div>
    );
}

ReactDOM.render(React.createElement(App),document.getElementById('root'));
</script>
</body>
</html>
